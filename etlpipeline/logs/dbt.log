2023-06-24 14:59:46.062240 (MainThread): Running with dbt=0.16.0
2023-06-24 14:59:46.108741 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 14:59:46.109741 (MainThread): Tracking: tracking
2023-06-24 14:59:46.110240 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021257A444A8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021257A67A58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021257A3BC88>]}
2023-06-24 14:59:46.121741 (MainThread): Partial parsing not enabled
2023-06-24 14:59:46.126240 (MainThread): Parsing macros\core.sql
2023-06-24 14:59:46.129741 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 14:59:46.161241 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 14:59:46.168240 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 14:59:46.169240 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 14:59:46.170240 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 14:59:46.172242 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 14:59:46.173741 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 14:59:46.175240 (MainThread): Parsing macros\etc\query.sql
2023-06-24 14:59:46.176241 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 14:59:46.182241 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 14:59:46.191740 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 14:59:46.193241 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 14:59:46.198240 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 14:59:46.214240 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 14:59:46.238741 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 14:59:46.240241 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 14:59:46.252740 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 14:59:46.258241 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 14:59:46.262241 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 14:59:46.266741 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 14:59:46.268740 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 14:59:46.269241 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 14:59:46.270240 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 14:59:46.272240 (MainThread): Parsing macros\adapters.sql
2023-06-24 14:59:46.285241 (MainThread): Parsing macros\catalog.sql
2023-06-24 14:59:46.286741 (MainThread): Parsing macros\relations.sql
2023-06-24 14:59:46.288240 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 14:59:46.300741 (MainThread): Partial parsing not enabled
2023-06-24 14:59:46.319241 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 14:59:46.319241 (MainThread): Opening a new connection, currently in state init
2023-06-24 14:59:46.329741 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 14:59:46.330240 (MainThread): Opening a new connection, currently in state init
2023-06-24 14:59:46.333241 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 14:59:46.333241 (MainThread): Opening a new connection, currently in state init
2023-06-24 14:59:46.354241 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 14:59:46.354241 (MainThread): Opening a new connection, currently in state init
2023-06-24 14:59:46.360240 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 14:59:46.360240 (MainThread): Opening a new connection, currently in state init
2023-06-24 14:59:46.366241 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 14:59:46.366241 (MainThread): Opening a new connection, currently in state init
2023-06-24 14:59:46.370740 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 14:59:46.370740 (MainThread): Opening a new connection, currently in state init
2023-06-24 14:59:46.400740 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125A8F97B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125A8EB898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125A8EC940>]}
2023-06-24 14:59:46.400740 (MainThread): Flushing usage events
2023-06-24 14:59:46.633235 (MainThread): Connection 'test.my_new_project.not_null_my_second_dbt_model_id' was properly closed.
2023-06-24 14:59:46.633235 (MainThread): Encountered an error:
2023-06-24 14:59:46.633235 (MainThread): Compilation Error in model transformation (models\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'extracted_data' which was not found or is disabled
2023-06-24 14:59:46.637735 (MainThread): Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 338, in load_all
    manifest = loader.create_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 323, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 302, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 553, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 534, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\utils.py", line 338, in invalid_ref_fail_unless_test
    target_model_package)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 488, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model transformation (models\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'extracted_data' which was not found or is disabled

2023-06-24 15:00:49.120491 (MainThread): Running with dbt=0.16.0
2023-06-24 15:00:49.157990 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:00:49.158490 (MainThread): Tracking: tracking
2023-06-24 15:00:49.158990 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001631EB0F630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001631EAE49B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001631EAE4EF0>]}
2023-06-24 15:00:49.170490 (MainThread): Partial parsing not enabled
2023-06-24 15:00:49.172490 (MainThread): Parsing macros\core.sql
2023-06-24 15:00:49.175990 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:00:49.207490 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:00:49.213990 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:00:49.214990 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:00:49.215990 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:00:49.217490 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:00:49.218990 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:00:49.220490 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:00:49.220990 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:00:49.226991 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:00:49.236490 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:00:49.237990 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:00:49.242491 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:00:49.257991 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:00:49.282990 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:00:49.283990 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:00:49.296490 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:00:49.301490 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:00:49.305490 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:00:49.309990 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:00:49.311490 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:00:49.312490 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:00:49.312990 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:00:49.314490 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:00:49.327490 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:00:49.328990 (MainThread): Parsing macros\relations.sql
2023-06-24 15:00:49.329990 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:00:49.342990 (MainThread): Partial parsing not enabled
2023-06-24 15:00:49.361490 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:00:49.361490 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:00:49.371990 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:00:49.371990 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:00:49.375490 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:00:49.375490 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:00:49.396490 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:00:49.396490 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:00:49.402990 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:00:49.402990 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:00:49.408490 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:00:49.408490 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:00:49.413490 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:00:49.413490 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:00:49.442990 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001631ED44978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001631ED60DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001631ED4AA20>]}
2023-06-24 15:00:49.442990 (MainThread): Flushing usage events
2023-06-24 15:00:49.651732 (MainThread): Connection 'test.my_new_project.not_null_my_second_dbt_model_id' was properly closed.
2023-06-24 15:00:49.651732 (MainThread): Encountered an error:
2023-06-24 15:00:49.652232 (MainThread): Compilation Error in model transformation (models\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'extracted_data' which was not found or is disabled
2023-06-24 15:00:49.653232 (MainThread): Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 338, in load_all
    manifest = loader.create_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 323, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 302, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 553, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 534, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\utils.py", line 338, in invalid_ref_fail_unless_test
    target_model_package)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 488, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model transformation (models\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'extracted_data' which was not found or is disabled

2023-06-24 15:04:44.247183 (MainThread): Running with dbt=0.16.0
2023-06-24 15:04:44.285183 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:04:44.285683 (MainThread): Tracking: tracking
2023-06-24 15:04:44.286183 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC49EAD68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC49179E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC48F4DA0>]}
2023-06-24 15:04:44.297183 (MainThread): Partial parsing not enabled
2023-06-24 15:04:44.299683 (MainThread): Parsing macros\core.sql
2023-06-24 15:04:44.302683 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:04:44.334683 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:04:44.341683 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:04:44.342183 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:04:44.343183 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:04:44.344683 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:04:44.346183 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:04:44.347683 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:04:44.348683 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:04:44.354183 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:04:44.363683 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:04:44.365183 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:04:44.369683 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:04:44.385183 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:04:44.410183 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:04:44.411184 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:04:44.423683 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:04:44.428684 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:04:44.432183 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:04:44.437183 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:04:44.438683 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:04:44.439183 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:04:44.440183 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:04:44.441683 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:04:44.454183 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:04:44.456183 (MainThread): Parsing macros\relations.sql
2023-06-24 15:04:44.457183 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:04:44.470183 (MainThread): Partial parsing not enabled
2023-06-24 15:04:44.488683 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:04:44.488683 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:04:44.499683 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:04:44.499683 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:04:44.502683 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:04:44.503183 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:04:44.523683 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:04:44.524183 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:04:44.530183 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:04:44.530183 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:04:44.535683 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:04:44.535683 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:04:44.540183 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:04:44.540183 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:04:44.569683 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC7795898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC779B0B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC77A8160>]}
2023-06-24 15:04:44.570183 (MainThread): Flushing usage events
2023-06-24 15:04:44.792806 (MainThread): Connection 'test.my_new_project.not_null_my_second_dbt_model_id' was properly closed.
2023-06-24 15:04:44.792806 (MainThread): Encountered an error:
2023-06-24 15:04:44.792806 (MainThread): Compilation Error in model transformation (models\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'extracted_data' which was not found or is disabled
2023-06-24 15:04:44.793806 (MainThread): Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 338, in load_all
    manifest = loader.create_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 323, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 302, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 553, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 534, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\utils.py", line 338, in invalid_ref_fail_unless_test
    target_model_package)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 488, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model transformation (models\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'extracted_data' which was not found or is disabled

2023-06-24 15:06:43.784881 (MainThread): Running with dbt=0.16.0
2023-06-24 15:06:43.822381 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:06:43.822881 (MainThread): Tracking: tracking
2023-06-24 15:06:43.823381 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5AA9AEB8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5A957A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5A934CC0>]}
2023-06-24 15:06:43.834381 (MainThread): Partial parsing not enabled
2023-06-24 15:06:43.837011 (MainThread): Parsing macros\core.sql
2023-06-24 15:06:43.840381 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:06:43.871381 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:06:43.878381 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:06:43.878881 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:06:43.879881 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:06:43.881381 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:06:43.882881 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:06:43.884381 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:06:43.885381 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:06:43.890881 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:06:43.900382 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:06:43.901881 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:06:43.906381 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:06:43.922381 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:06:43.946881 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:06:43.947881 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:06:43.960381 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:06:43.965881 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:06:43.969881 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:06:43.974381 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:06:43.975881 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:06:43.976882 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:06:43.977881 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:06:43.978881 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:06:43.991881 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:06:43.993882 (MainThread): Parsing macros\relations.sql
2023-06-24 15:06:43.994881 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:06:44.007882 (MainThread): Partial parsing not enabled
2023-06-24 15:06:44.026881 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:06:44.026881 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:06:44.036881 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:06:44.036881 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:06:44.039881 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:06:44.039881 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:06:44.043381 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:06:44.043881 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:06:44.065381 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:06:44.065381 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:06:44.071381 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:06:44.071381 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:06:44.077381 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:06:44.077381 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:06:44.081881 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:06:44.081881 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:06:44.153881 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:06:44.268881 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:06:44.268881 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:06:44.268881 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:06:44.268881 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:06:44.268881 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:06:44.269381 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:06:44.269381 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:06:44.274381 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.277881 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.279881 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.284882 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.288382 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.289382 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.292382 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.295881 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.296882 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.300381 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.304381 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.307381 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.312381 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.315381 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.321881 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.330881 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.334365 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.340368 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.344368 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.346868 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.362322 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.368756 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:06:44.368756 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:06:44.373255 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.422287 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.426288 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.432226 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.459225 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.467725 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.470725 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.491225 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.496225 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.517725 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.521725 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.544725 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.571226 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:06:44.572727 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:06:44.575226 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:06:44.575727 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:06:44.578227 (MainThread): 
2023-06-24 15:06:44.578227 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:06:44.578227 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:06:44.582226 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_mytable".
2023-06-24 15:06:44.582226 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:06:44.637257 (ThreadPoolExecutor-0_0): Using postgres connection "list_mytable".
2023-06-24 15:06:44.637257 (ThreadPoolExecutor-0_0): On list_mytable: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_mytable"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:06:44.672439 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'connection to server at "127.0.0.2", port 5432 failed: FATAL:  database "mytable" does not exist
'
2023-06-24 15:06:44.672439 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_mytable"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:06:44.672439 (ThreadPoolExecutor-0_0): Rolling back transaction.
2023-06-24 15:06:44.672439 (ThreadPoolExecutor-0_0): On list_mytable: No close available on handle
2023-06-24 15:06:44.672940 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2023-06-24 15:06:44.672940 (ThreadPoolExecutor-0_0): Rolling back transaction.
2023-06-24 15:06:44.672940 (MainThread): Connection 'master' was properly closed.
2023-06-24 15:06:44.673440 (MainThread): Connection 'list_mytable' was properly closed.
2023-06-24 15:06:44.673440 (MainThread): ERROR: Database Error
  connection to server at "127.0.0.2", port 5432 failed: FATAL:  database "mytable" does not exist
  
2023-06-24 15:06:44.673440 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5E5FC208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5E5D95F8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5E586828>]}
2023-06-24 15:06:44.673440 (MainThread): Flushing usage events
2023-06-24 15:07:11.816759 (MainThread): Running with dbt=0.16.0
2023-06-24 15:07:11.854259 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:07:11.854759 (MainThread): Tracking: tracking
2023-06-24 15:07:11.855260 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010E72B9E748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010E72B97978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010E72B74DA0>]}
2023-06-24 15:07:11.866759 (MainThread): Partial parsing not enabled
2023-06-24 15:07:11.869259 (MainThread): Parsing macros\core.sql
2023-06-24 15:07:11.872259 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:07:11.903759 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:07:11.910259 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:07:11.911259 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:07:11.912259 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:07:11.913759 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:07:11.915259 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:07:11.916759 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:07:11.917259 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:07:11.923760 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:07:11.933259 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:07:11.934759 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:07:11.939259 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:07:11.954759 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:07:11.979259 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:07:11.980759 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:07:11.993259 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:07:11.998259 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:07:12.002259 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:07:12.006759 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:07:12.008259 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:07:12.009259 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:07:12.009759 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:07:12.011260 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:07:12.024259 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:07:12.025759 (MainThread): Parsing macros\relations.sql
2023-06-24 15:07:12.026759 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:07:12.039760 (MainThread): Partial parsing not enabled
2023-06-24 15:07:12.058759 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:07:12.058759 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:12.068759 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:07:12.068759 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:12.071759 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:07:12.071759 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:12.075259 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:07:12.075759 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:12.096759 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:07:12.096759 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:12.102759 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:07:12.102759 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:12.108760 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:07:12.108760 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:12.113259 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:07:12.113259 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:12.184259 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:07:12.263260 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:12.263260 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:12.263260 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:12.263759 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:12.263759 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:12.263759 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:12.263759 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:12.265259 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.265759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.266259 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.268260 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.269259 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.269759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.270259 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.270759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.271759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.272259 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.273259 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.273760 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.274759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.275759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.278259 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.281759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.282759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.284259 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.284759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.285759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.293259 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.296759 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:12.296759 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:12.298259 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.329759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.330759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.332760 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.349759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.353759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.354759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.367259 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.369759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.385260 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.386260 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.399760 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.416759 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:12.417759 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:07:12.420259 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:07:12.420759 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:07:12.423259 (MainThread): 
2023-06-24 15:07:12.423259 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:07:12.423259 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:12.427259 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_mytable".
2023-06-24 15:07:12.427259 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:07:12.481759 (ThreadPoolExecutor-0_0): Using postgres connection "list_mytable".
2023-06-24 15:07:12.481759 (ThreadPoolExecutor-0_0): On list_mytable: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_mytable"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:07:12.510259 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'connection to server at "127.0.0.2", port 5432 failed: FATAL:  database "mytable" does not exist
'
2023-06-24 15:07:12.510759 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_mytable"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:07:12.510759 (ThreadPoolExecutor-0_0): Rolling back transaction.
2023-06-24 15:07:12.510759 (ThreadPoolExecutor-0_0): On list_mytable: No close available on handle
2023-06-24 15:07:12.510759 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2023-06-24 15:07:12.510759 (ThreadPoolExecutor-0_0): Rolling back transaction.
2023-06-24 15:07:12.511260 (MainThread): Connection 'master' was properly closed.
2023-06-24 15:07:12.511260 (MainThread): Connection 'list_mytable' was properly closed.
2023-06-24 15:07:12.511260 (MainThread): ERROR: Database Error
  connection to server at "127.0.0.2", port 5432 failed: FATAL:  database "mytable" does not exist
  
2023-06-24 15:07:12.511759 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010E7683B400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010E7681A6D8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010E767F99E8>]}
2023-06-24 15:07:12.511759 (MainThread): Flushing usage events
2023-06-24 15:07:49.088071 (MainThread): Running with dbt=0.16.0
2023-06-24 15:07:49.125571 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:07:49.126072 (MainThread): Tracking: tracking
2023-06-24 15:07:49.126572 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023377C3E6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023377C37A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023377C14470>]}
2023-06-24 15:07:49.138071 (MainThread): Partial parsing not enabled
2023-06-24 15:07:49.140071 (MainThread): Parsing macros\core.sql
2023-06-24 15:07:49.143572 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:07:49.174572 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:07:49.182072 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:07:49.182572 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:07:49.183571 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:07:49.185071 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:07:49.186571 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:07:49.188071 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:07:49.189071 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:07:49.194572 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:07:49.204072 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:07:49.205572 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:07:49.210072 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:07:49.226072 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:07:49.250571 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:07:49.252071 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:07:49.264571 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:07:49.269571 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:07:49.273071 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:07:49.278071 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:07:49.279572 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:07:49.280072 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:07:49.281071 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:07:49.282571 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:07:49.295572 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:07:49.297071 (MainThread): Parsing macros\relations.sql
2023-06-24 15:07:49.298571 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:07:49.311071 (MainThread): Partial parsing not enabled
2023-06-24 15:07:49.330071 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:07:49.330071 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:49.340071 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:07:49.340071 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:49.343571 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:07:49.343571 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:49.347071 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:07:49.347071 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:49.368571 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:07:49.368571 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:49.374572 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:07:49.374572 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:49.380072 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:07:49.380572 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:49.385072 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:07:49.385072 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:49.455572 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:07:49.534572 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:49.535072 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:49.535072 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:49.535072 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:49.535072 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:49.535072 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:49.535072 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:49.536572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.537071 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.537572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.539571 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.540572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.541071 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.541572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.542572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.543072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.543572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.544572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.545072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.546072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.547072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.549572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.553072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.554072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.555572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.556572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.557071 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.564572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.568071 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:49.568071 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:07:49.569572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.602072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.603072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.605072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.622072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.626572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.627072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.639572 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.642072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.658072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.659072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.672072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.689072 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:07:49.690072 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:07:49.693071 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:07:49.693572 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:07:49.695572 (MainThread): 
2023-06-24 15:07:49.696072 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:07:49.696072 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:07:49.699572 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_mytable".
2023-06-24 15:07:49.699572 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:07:49.755572 (ThreadPoolExecutor-0_0): Using postgres connection "list_mytable".
2023-06-24 15:07:49.755572 (ThreadPoolExecutor-0_0): On list_mytable: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_mytable"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:07:49.783572 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'connection to server at "127.0.0.2", port 5432 failed: FATAL:  database "mytable" does not exist
'
2023-06-24 15:07:49.783572 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_mytable"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:07:49.783572 (ThreadPoolExecutor-0_0): Rolling back transaction.
2023-06-24 15:07:49.783572 (ThreadPoolExecutor-0_0): On list_mytable: No close available on handle
2023-06-24 15:07:49.784072 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2023-06-24 15:07:49.784072 (ThreadPoolExecutor-0_0): Rolling back transaction.
2023-06-24 15:07:49.784072 (MainThread): Connection 'master' was properly closed.
2023-06-24 15:07:49.784572 (MainThread): Connection 'list_mytable' was properly closed.
2023-06-24 15:07:49.784572 (MainThread): ERROR: Database Error
  connection to server at "127.0.0.2", port 5432 failed: FATAL:  database "mytable" does not exist
  
2023-06-24 15:07:49.784572 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002337B8DC3C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002337B8A9128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002337B8A91D0>]}
2023-06-24 15:07:49.784572 (MainThread): Flushing usage events
2023-06-24 15:10:27.407987 (MainThread): Running with dbt=0.16.0
2023-06-24 15:10:27.445017 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:10:27.445525 (MainThread): Tracking: tracking
2023-06-24 15:10:27.446018 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57E254048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57E0F89E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57E0D4F28>]}
2023-06-24 15:10:27.457487 (MainThread): Partial parsing not enabled
2023-06-24 15:10:27.459988 (MainThread): Parsing macros\core.sql
2023-06-24 15:10:27.462987 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:10:27.494487 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:10:27.501488 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:10:27.502488 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:10:27.503487 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:10:27.504988 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:10:27.506488 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:10:27.507987 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:10:27.508488 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:10:27.514487 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:10:27.523988 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:10:27.525487 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:10:27.529987 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:10:27.545988 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:10:27.570487 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:10:27.571987 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:10:27.584488 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:10:27.589987 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:10:27.593487 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:10:27.598487 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:10:27.599987 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:10:27.600488 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:10:27.601487 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:10:27.602988 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:10:27.615987 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:10:27.617488 (MainThread): Parsing macros\relations.sql
2023-06-24 15:10:27.618987 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:10:27.631487 (MainThread): Partial parsing not enabled
2023-06-24 15:10:27.650487 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:10:27.650487 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:10:27.660488 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:10:27.660488 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:10:27.663487 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:10:27.663487 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:10:27.667487 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:10:27.667487 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:10:27.688488 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:10:27.688488 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:10:27.694489 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:10:27.694987 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:10:27.700487 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:10:27.700487 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:10:27.705487 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:10:27.705487 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:10:27.776487 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:10:27.855487 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:10:27.855487 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:10:27.855487 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:10:27.855487 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:10:27.855487 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:10:27.855487 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:10:27.855987 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:10:27.856988 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.857988 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.858701 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.860490 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.861989 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.862489 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.863489 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.863989 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.864489 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.865488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.866488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.866988 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.867988 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.868988 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.871488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.874988 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.875988 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.877488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.878488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.878988 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.886488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.889489 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:10:27.889987 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:10:27.890987 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.922488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.923488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.925488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.942489 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.946488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.947487 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.960488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.962988 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.978488 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.979487 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:27.992988 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:28.009487 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:10:28.010488 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:10:28.013488 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:10:28.013488 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:10:28.015987 (MainThread): 
2023-06-24 15:10:28.016488 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:10:28.016488 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:10:28.019987 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:10:28.019987 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:10:28.075488 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:10:28.075488 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:10:28.106988 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:10:28.125988 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:10:28.125988 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:10:28.126988 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:10:28.126988 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:10:28.159488 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:10:28.159488 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:10:28.159990 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:10:28.163988 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:10:28.164987 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:10:28.183988 (MainThread): Using postgres connection "master".
2023-06-24 15:10:28.183988 (MainThread): On master: BEGIN
2023-06-24 15:10:28.212487 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:10:28.212487 (MainThread): Using postgres connection "master".
2023-06-24 15:10:28.212487 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:10:28.216987 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:10:28.217488 (MainThread): On master: ROLLBACK
2023-06-24 15:10:28.217488 (MainThread): Using postgres connection "master".
2023-06-24 15:10:28.217988 (MainThread): On master: BEGIN
2023-06-24 15:10:28.217988 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:10:28.217988 (MainThread): On master: COMMIT
2023-06-24 15:10:28.217988 (MainThread): Using postgres connection "master".
2023-06-24 15:10:28.218488 (MainThread): On master: COMMIT
2023-06-24 15:10:28.218488 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:10:28.218488 (MainThread): 11:10:28 | Concurrency: 1 threads (target='dev')
2023-06-24 15:10:28.218488 (MainThread): 11:10:28 | 
2023-06-24 15:10:28.223989 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:10:28.224490 (Thread-1): 11:10:28 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:10:28.224490 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:10:28.224490 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:10:28.224490 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:10:28.233991 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:10:28.234991 (Thread-1): finished collecting timing info
2023-06-24 15:10:28.254990 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:10:28.255490 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:10:28.283991 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:10:28.285990 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:10:28.285990 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:10:28.285990 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:10:28.286990 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:10:28.287990 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:10:28.287990 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:10:28.288491 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:10:28.288491 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:10:28.288491 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.

WITH filtered_data AS (
  SELECT *
  FROM "postgres"."myschema"."extracted_data"
  WHERE contract_type = 'Magic Eden'
    AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)

SELECT *
FROM filtered_data;
  );

2023-06-24 15:10:28.288991 (Thread-1): Postgres error: syntax error at or near ";"
LINE 16: FROM filtered_data;
                           ^

2023-06-24 15:10:28.288991 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:10:28.288991 (Thread-1): finished collecting timing info
2023-06-24 15:10:28.289491 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  syntax error at or near ";"
  LINE 16: FROM filtered_data;
                             ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 16: FROM filtered_data;
                           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  syntax error at or near ";"
  LINE 16: FROM filtered_data;
                             ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:10:28.293991 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15a5af56-0e8c-44f9-ba10-e07b8e852342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F501DC4C50>]}
2023-06-24 15:10:28.293991 (Thread-1): 11:10:28 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.07s]
2023-06-24 15:10:28.293991 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:10:28.338399 (MainThread): Using postgres connection "master".
2023-06-24 15:10:28.338933 (MainThread): On master: BEGIN
2023-06-24 15:10:28.338933 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:10:28.338933 (MainThread): On master: COMMIT
2023-06-24 15:10:28.338933 (MainThread): Using postgres connection "master".
2023-06-24 15:10:28.338933 (MainThread): On master: COMMIT
2023-06-24 15:10:28.339435 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:10:28.339435 (MainThread): 11:10:28 | 
2023-06-24 15:10:28.339435 (MainThread): 11:10:28 | Finished running 1 view model in 0.32s.
2023-06-24 15:10:28.339435 (MainThread): Connection 'master' was left open.
2023-06-24 15:10:28.339932 (MainThread): On master: Close
2023-06-24 15:10:28.339932 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:10:28.339932 (MainThread): On list_postgres: Close
2023-06-24 15:10:28.339932 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:10:28.339932 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:10:28.340436 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:10:28.340436 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:10:28.342405 (MainThread): 
2023-06-24 15:10:28.342405 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:10:28.342405 (MainThread): 
2023-06-24 15:10:28.342903 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:10:28.342903 (MainThread):   syntax error at or near ";"
2023-06-24 15:10:28.342903 (MainThread):   LINE 16: FROM filtered_data;
2023-06-24 15:10:28.342903 (MainThread):                              ^
2023-06-24 15:10:28.342903 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:10:28.342903 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:10:28.342903 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F501E707B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F501D7B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F501DF4438>]}
2023-06-24 15:10:28.343403 (MainThread): Flushing usage events
2023-06-24 15:11:06.247163 (MainThread): Running with dbt=0.16.0
2023-06-24 15:11:06.285164 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:11:06.285665 (MainThread): Tracking: tracking
2023-06-24 15:11:06.286164 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACDCD6FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACDB64F28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACDB64CF8>]}
2023-06-24 15:11:06.297664 (MainThread): Partial parsing not enabled
2023-06-24 15:11:06.299664 (MainThread): Parsing macros\core.sql
2023-06-24 15:11:06.303164 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:11:06.334163 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:11:06.341163 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:11:06.342164 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:11:06.342664 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:11:06.344664 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:11:06.346163 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:11:06.347163 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:11:06.348164 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:11:06.354164 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:11:06.363664 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:11:06.365163 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:11:06.369663 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:11:06.385164 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:11:06.410164 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:11:06.411664 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:11:06.424163 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:11:06.429164 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:11:06.432664 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:11:06.437164 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:11:06.439164 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:11:06.439663 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:11:06.440665 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:11:06.441663 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:11:06.454664 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:11:06.456664 (MainThread): Parsing macros\relations.sql
2023-06-24 15:11:06.457664 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:11:06.470164 (MainThread): Partial parsing not enabled
2023-06-24 15:11:06.489164 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:11:06.489164 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:11:06.499164 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:11:06.499164 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:11:06.502164 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:11:06.502164 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:11:06.505664 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:11:06.506164 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:11:06.527664 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:11:06.527664 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:11:06.533665 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:11:06.533665 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:11:06.539664 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:11:06.539664 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:11:06.544164 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:11:06.544164 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:11:06.614663 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:11:06.693664 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:11:06.694164 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:11:06.694164 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:11:06.694164 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:11:06.694164 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:11:06.694164 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:11:06.694164 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:11:06.695665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.696164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.697164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.698664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.699664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.700164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.700664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.701664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.702165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.702664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.703664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.704167 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.705164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.706164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.709164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.712164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.713664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.714664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.715664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.716164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.723664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.727164 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:11:06.727164 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:11:06.728664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.760164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.761165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.763164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.780164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.784664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.785164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.797664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.800164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.815664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.816664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.829664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.846664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:11:06.847663 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:11:06.850664 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:11:06.850664 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:11:06.853164 (MainThread): 
2023-06-24 15:11:06.853663 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:11:06.853663 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:11:06.857164 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:11:06.857164 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:11:06.913163 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:11:06.913163 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:11:06.943164 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:11:06.961664 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:11:06.961664 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:11:06.962664 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:11:06.962664 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:11:06.991164 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:11:06.991664 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:11:06.991664 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:11:06.994164 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:11:06.995164 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:11:07.014165 (MainThread): Using postgres connection "master".
2023-06-24 15:11:07.014165 (MainThread): On master: BEGIN
2023-06-24 15:11:07.042163 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:11:07.042163 (MainThread): Using postgres connection "master".
2023-06-24 15:11:07.042664 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:11:07.046163 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:11:07.046664 (MainThread): On master: ROLLBACK
2023-06-24 15:11:07.046664 (MainThread): Using postgres connection "master".
2023-06-24 15:11:07.046664 (MainThread): On master: BEGIN
2023-06-24 15:11:07.047164 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:11:07.047164 (MainThread): On master: COMMIT
2023-06-24 15:11:07.047164 (MainThread): Using postgres connection "master".
2023-06-24 15:11:07.047164 (MainThread): On master: COMMIT
2023-06-24 15:11:07.047664 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:11:07.047664 (MainThread): 11:11:07 | Concurrency: 1 threads (target='dev')
2023-06-24 15:11:07.047664 (MainThread): 11:11:07 | 
2023-06-24 15:11:07.049165 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:11:07.049165 (Thread-1): 11:11:07 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:11:07.049664 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:11:07.049664 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:11:07.049664 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:11:07.058664 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:11:07.059164 (Thread-1): finished collecting timing info
2023-06-24 15:11:07.079165 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:11:07.079165 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:11:07.107166 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:11:07.108665 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:11:07.108665 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:11:07.108665 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:11:07.109664 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:11:07.110164 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:11:07.110164 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:11:07.110665 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:11:07.110665 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:11:07.110665 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.

WITH filtered_data AS (
  SELECT *
  FROM "postgres"."myschema"."extracted_data"
  WHERE contract_type = 'Magic Eden'
    AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)

SELECT *
FROM filtered_data
  );

2023-06-24 15:11:07.111164 (Thread-1): Postgres error: relation "myschema.extracted_data" does not exist
LINE 10:   FROM "postgres"."myschema"."extracted_data"
                ^

2023-06-24 15:11:07.111164 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:11:07.111164 (Thread-1): finished collecting timing info
2023-06-24 15:11:07.111664 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 10:   FROM "postgres"."myschema"."extracted_data"
                  ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.extracted_data" does not exist
LINE 10:   FROM "postgres"."myschema"."extracted_data"
                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 10:   FROM "postgres"."myschema"."extracted_data"
                  ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:11:07.113164 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9db2e4-7f59-4962-8328-87b281fccea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD184C4A8>]}
2023-06-24 15:11:07.113164 (Thread-1): 11:11:07 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:11:07.113164 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:11:07.153045 (MainThread): Using postgres connection "master".
2023-06-24 15:11:07.153045 (MainThread): On master: BEGIN
2023-06-24 15:11:07.153045 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:11:07.153045 (MainThread): On master: COMMIT
2023-06-24 15:11:07.153045 (MainThread): Using postgres connection "master".
2023-06-24 15:11:07.153544 (MainThread): On master: COMMIT
2023-06-24 15:11:07.153544 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:11:07.153544 (MainThread): 11:11:07 | 
2023-06-24 15:11:07.153544 (MainThread): 11:11:07 | Finished running 1 view model in 0.30s.
2023-06-24 15:11:07.154044 (MainThread): Connection 'master' was left open.
2023-06-24 15:11:07.154044 (MainThread): On master: Close
2023-06-24 15:11:07.154044 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:11:07.154044 (MainThread): On list_postgres: Close
2023-06-24 15:11:07.154044 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:11:07.154044 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:11:07.154544 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:11:07.154544 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:11:07.156544 (MainThread): 
2023-06-24 15:11:07.156544 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:11:07.156544 (MainThread): 
2023-06-24 15:11:07.156544 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:11:07.157045 (MainThread):   relation "myschema.extracted_data" does not exist
2023-06-24 15:11:07.157045 (MainThread):   LINE 10:   FROM "postgres"."myschema"."extracted_data"
2023-06-24 15:11:07.157045 (MainThread):                   ^
2023-06-24 15:11:07.157045 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:11:07.157045 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:11:07.157045 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD18FA208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD180A898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD18FFCC0>]}
2023-06-24 15:11:07.157045 (MainThread): Flushing usage events
2023-06-24 15:12:26.074170 (MainThread): Running with dbt=0.16.0
2023-06-24 15:12:26.111670 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:12:26.112170 (MainThread): Tracking: tracking
2023-06-24 15:12:26.112670 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1383F4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC13814D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC13814F60>]}
2023-06-24 15:12:26.124170 (MainThread): Partial parsing not enabled
2023-06-24 15:12:26.126170 (MainThread): Parsing macros\core.sql
2023-06-24 15:12:26.129670 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:12:26.160670 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:12:26.167670 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:12:26.168670 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:12:26.169671 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:12:26.171170 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:12:26.172670 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:12:26.174170 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:12:26.174671 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:12:26.180670 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:12:26.190170 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:12:26.191670 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:12:26.196170 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:12:26.211670 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:12:26.236670 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:12:26.237670 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:12:26.250170 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:12:26.255170 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:12:26.259170 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:12:26.263670 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:12:26.265170 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:12:26.266170 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:12:26.267170 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:12:26.268170 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:12:26.281170 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:12:26.282670 (MainThread): Parsing macros\relations.sql
2023-06-24 15:12:26.284170 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:12:26.296670 (MainThread): Partial parsing not enabled
2023-06-24 15:12:26.315670 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:12:26.315670 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:12:26.325670 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:12:26.325670 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:12:26.328670 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:12:26.328670 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:12:26.332670 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:12:26.332670 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:12:26.335171 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC165BA2E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC166B33C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC166B3668>]}
2023-06-24 15:12:26.335670 (MainThread): Flushing usage events
2023-06-24 15:12:26.504170 (MainThread): Connection 'model.my_new_project.transformation' was properly closed.
2023-06-24 15:12:26.504170 (MainThread): Encountered an error:
2023-06-24 15:12:26.504170 (MainThread): __call__() got an unexpected keyword argument 'schema'
2023-06-24 15:12:26.507170 (MainThread): Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 336, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 208, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 182, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 138, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 380, in parse_file
    self.parse_node(file_block)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 353, in parse_node
    self.render_update(node, config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 329, in render_update
    self.render_with_context(node, config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 265, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 415, in get_rendered
    return render_template(template, ctx, node)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 409, in render_template
    return template.render(ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 7, in top-level template code
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
TypeError: __call__() got an unexpected keyword argument 'schema'

2023-06-24 15:13:04.014399 (MainThread): Running with dbt=0.16.0
2023-06-24 15:13:04.052900 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:13:04.053400 (MainThread): Tracking: tracking
2023-06-24 15:13:04.053400 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256C22F6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256C204550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256C204DD8>]}
2023-06-24 15:13:04.064899 (MainThread): Partial parsing not enabled
2023-06-24 15:13:04.067400 (MainThread): Parsing macros\core.sql
2023-06-24 15:13:04.070900 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:13:04.101899 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:13:04.108901 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:13:04.109900 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:13:04.110901 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:13:04.112399 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:13:04.113899 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:13:04.115400 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:13:04.115899 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:13:04.121899 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:13:04.131399 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:13:04.132899 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:13:04.137399 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:13:04.152899 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:13:04.177900 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:13:04.178899 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:13:04.191399 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:13:04.196400 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:13:04.200400 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:13:04.204900 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:13:04.206400 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:13:04.207399 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:13:04.207899 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:13:04.209399 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:13:04.222400 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:13:04.223900 (MainThread): Parsing macros\relations.sql
2023-06-24 15:13:04.225399 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:13:04.237899 (MainThread): Partial parsing not enabled
2023-06-24 15:13:04.256900 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:13:04.256900 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:04.266900 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:13:04.266900 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:04.269899 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:13:04.269899 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:04.273400 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:04.273899 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:04.294401 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:13:04.294401 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:04.300400 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:13:04.300400 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:04.305899 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:13:04.306400 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:04.310899 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:13:04.310899 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:04.381899 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:13:04.464400 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:04.464400 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:04.464901 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:04.464901 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:04.464901 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:04.464901 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:04.464901 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:04.466400 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.466899 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.467900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.469399 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.470400 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.471399 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.471900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.472399 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.473400 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.473900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.474900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.475400 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.476400 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.477399 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.480401 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.483900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.484900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.486400 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.486899 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.487901 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.495901 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.499400 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:04.499899 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:04.501399 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.533900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.534400 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.536900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.554900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.559400 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.559900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.572900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.575399 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.591399 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.592900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.606900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.625900 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:04.626900 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:13:04.629900 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:13:04.629900 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:13:04.632400 (MainThread): 
2023-06-24 15:13:04.632900 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:13:04.632900 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:04.636400 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:13:04.636400 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:13:04.692402 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:13:04.692402 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:13:04.723087 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:13:04.741780 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:13:04.741780 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:13:04.742784 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:13:04.742784 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:13:04.771765 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:13:04.771765 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:13:04.771765 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:13:04.774764 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:13:04.775793 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:13:04.795175 (MainThread): Using postgres connection "master".
2023-06-24 15:13:04.795175 (MainThread): On master: BEGIN
2023-06-24 15:13:04.827144 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:13:04.827144 (MainThread): Using postgres connection "master".
2023-06-24 15:13:04.827144 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:13:04.830644 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:13:04.831644 (MainThread): On master: ROLLBACK
2023-06-24 15:13:04.831644 (MainThread): Using postgres connection "master".
2023-06-24 15:13:04.831644 (MainThread): On master: BEGIN
2023-06-24 15:13:04.832144 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:13:04.832144 (MainThread): On master: COMMIT
2023-06-24 15:13:04.832144 (MainThread): Using postgres connection "master".
2023-06-24 15:13:04.832144 (MainThread): On master: COMMIT
2023-06-24 15:13:04.832144 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:13:04.832645 (MainThread): 11:13:04 | Concurrency: 1 threads (target='dev')
2023-06-24 15:13:04.832645 (MainThread): 11:13:04 | 
2023-06-24 15:13:04.834144 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:13:04.834144 (Thread-1): 11:13:04 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:13:04.834644 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:04.834644 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:13:04.834644 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:13:04.842644 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:13:04.843144 (Thread-1): finished collecting timing info
2023-06-24 15:13:04.863144 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:04.863144 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:13:04.891644 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:13:04.893144 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:04.893144 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:13:04.893144 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:13:04.894144 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:13:04.894644 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:04.895144 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:13:04.895144 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:13:04.895144 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:04.895144 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.

-- models/transformation.sql
WITH filtered_data AS (
    SELECT *
    FROM myschema.postgres -- Replace 'myschema' with your actual schema name
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data;
  );

2023-06-24 15:13:04.895645 (Thread-1): Postgres error: syntax error at or near ";"
LINE 16: FROM filtered_data;
                           ^

2023-06-24 15:13:04.895645 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:13:04.895645 (Thread-1): finished collecting timing info
2023-06-24 15:13:04.896144 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  syntax error at or near ";"
  LINE 16: FROM filtered_data;
                             ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 16: FROM filtered_data;
                           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  syntax error at or near ";"
  LINE 16: FROM filtered_data;
                             ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:13:04.897644 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e795071-d791-4934-91a1-427f01d8299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225701A9D68>]}
2023-06-24 15:13:04.898145 (Thread-1): 11:13:04 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:13:04.898145 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:13:04.945167 (MainThread): Using postgres connection "master".
2023-06-24 15:13:04.945661 (MainThread): On master: BEGIN
2023-06-24 15:13:04.946671 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:13:04.947169 (MainThread): On master: COMMIT
2023-06-24 15:13:04.947668 (MainThread): Using postgres connection "master".
2023-06-24 15:13:04.947668 (MainThread): On master: COMMIT
2023-06-24 15:13:04.948668 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:13:04.949667 (MainThread): 11:13:04 | 
2023-06-24 15:13:04.950169 (MainThread): 11:13:04 | Finished running 1 view model in 0.32s.
2023-06-24 15:13:04.950669 (MainThread): Connection 'master' was left open.
2023-06-24 15:13:04.951168 (MainThread): On master: Close
2023-06-24 15:13:04.951667 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:13:04.952173 (MainThread): On list_postgres: Close
2023-06-24 15:13:04.952672 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:13:04.953172 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:13:04.953638 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:13:04.954162 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:13:04.956109 (MainThread): 
2023-06-24 15:13:04.956109 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:13:04.956610 (MainThread): 
2023-06-24 15:13:04.956610 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:13:04.956610 (MainThread):   syntax error at or near ";"
2023-06-24 15:13:04.956610 (MainThread):   LINE 16: FROM filtered_data;
2023-06-24 15:13:04.956610 (MainThread):                              ^
2023-06-24 15:13:04.956610 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:13:04.956610 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:13:04.957110 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256FFB21D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256FEAC860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256FF1D4E0>]}
2023-06-24 15:13:04.957110 (MainThread): Flushing usage events
2023-06-24 15:13:22.644545 (MainThread): Running with dbt=0.16.0
2023-06-24 15:13:22.681545 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:13:22.682045 (MainThread): Tracking: tracking
2023-06-24 15:13:22.682045 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28347F588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2834549E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F283454DD8>]}
2023-06-24 15:13:22.693546 (MainThread): Partial parsing not enabled
2023-06-24 15:13:22.696045 (MainThread): Parsing macros\core.sql
2023-06-24 15:13:22.699045 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:13:22.730546 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:13:22.737546 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:13:22.738546 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:13:22.739045 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:13:22.740545 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:13:22.742546 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:13:22.743545 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:13:22.744545 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:13:22.750045 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:13:22.760045 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:13:22.761546 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:13:22.766046 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:13:22.781545 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:13:22.806547 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:13:22.807545 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:13:22.820045 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:13:22.825045 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:13:22.829045 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:13:22.833546 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:13:22.835045 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:13:22.836046 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:13:22.837045 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:13:22.838045 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:13:22.851045 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:13:22.852545 (MainThread): Parsing macros\relations.sql
2023-06-24 15:13:22.853545 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:13:22.866545 (MainThread): Partial parsing not enabled
2023-06-24 15:13:22.885045 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:13:22.885045 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:22.894545 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:13:22.894545 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:22.898045 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:13:22.898045 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:22.901545 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:22.901545 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:22.922045 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:13:22.922045 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:22.928045 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:13:22.928045 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:22.933546 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:13:22.933546 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:22.938545 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:13:22.938545 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:23.008545 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:13:23.087545 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:23.087545 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:23.087545 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:23.088045 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:23.088045 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:23.088045 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:23.088045 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:23.089545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.090045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.090546 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.092545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.093545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.094045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.094545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.095545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.096045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.096545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.097545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.098045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.099045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.100045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.103045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.106545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.107045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.108545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.109545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.110045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.117546 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.121045 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:23.121045 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:13:23.122545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.154045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.154546 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.156545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.174045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.178045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.178545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.191545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.193545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.209045 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.210545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.224046 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.241545 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:13:23.242045 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:13:23.245045 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:13:23.245546 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:13:23.248045 (MainThread): 
2023-06-24 15:13:23.248045 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:13:23.248045 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:13:23.251546 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:13:23.251546 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:13:23.308075 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:13:23.308075 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:13:23.338832 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:13:23.357578 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:13:23.357578 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:13:23.358578 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:13:23.358578 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:13:23.391048 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:13:23.391048 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:13:23.391048 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:13:23.393548 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:13:23.394548 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:13:23.414048 (MainThread): Using postgres connection "master".
2023-06-24 15:13:23.414048 (MainThread): On master: BEGIN
2023-06-24 15:13:23.441548 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:13:23.441548 (MainThread): Using postgres connection "master".
2023-06-24 15:13:23.441548 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:13:23.445048 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:13:23.446048 (MainThread): On master: ROLLBACK
2023-06-24 15:13:23.446048 (MainThread): Using postgres connection "master".
2023-06-24 15:13:23.446048 (MainThread): On master: BEGIN
2023-06-24 15:13:23.446549 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:13:23.446549 (MainThread): On master: COMMIT
2023-06-24 15:13:23.446549 (MainThread): Using postgres connection "master".
2023-06-24 15:13:23.446549 (MainThread): On master: COMMIT
2023-06-24 15:13:23.446549 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:13:23.447048 (MainThread): 11:13:23 | Concurrency: 1 threads (target='dev')
2023-06-24 15:13:23.447048 (MainThread): 11:13:23 | 
2023-06-24 15:13:23.448548 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:13:23.448548 (Thread-1): 11:13:23 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:13:23.448548 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:23.449048 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:13:23.449048 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:13:23.457048 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:13:23.457548 (Thread-1): finished collecting timing info
2023-06-24 15:13:23.477549 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:23.477549 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:13:23.505579 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:13:23.507078 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:23.507582 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:13:23.507582 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:13:23.508593 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:13:23.509049 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:23.509049 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:13:23.509549 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:13:23.509549 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:13:23.509549 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.

-- models/transformation.sql
WITH filtered_data AS (
    SELECT *
    FROM myschema.postgres -- Replace 'myschema' with your actual schema name
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:13:23.509549 (Thread-1): Postgres error: relation "myschema.postgres" does not exist
LINE 11:     FROM myschema.postgres -- Replace 'myschema' with your a...
                  ^

2023-06-24 15:13:23.510049 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:13:23.510049 (Thread-1): finished collecting timing info
2023-06-24 15:13:23.510548 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 11:     FROM myschema.postgres -- Replace 'myschema' with your a...
                    ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.postgres" does not exist
LINE 11:     FROM myschema.postgres -- Replace 'myschema' with your a...
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 11:     FROM myschema.postgres -- Replace 'myschema' with your a...
                    ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:13:23.512048 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63581df2-d059-4bbc-a51e-8f45af70e47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F287179B38>]}
2023-06-24 15:13:23.512048 (Thread-1): 11:13:23 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:13:23.512048 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:13:23.555049 (MainThread): Using postgres connection "master".
2023-06-24 15:13:23.555049 (MainThread): On master: BEGIN
2023-06-24 15:13:23.555049 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:13:23.555049 (MainThread): On master: COMMIT
2023-06-24 15:13:23.555049 (MainThread): Using postgres connection "master".
2023-06-24 15:13:23.555049 (MainThread): On master: COMMIT
2023-06-24 15:13:23.555548 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:13:23.555548 (MainThread): 11:13:23 | 
2023-06-24 15:13:23.555548 (MainThread): 11:13:23 | Finished running 1 view model in 0.31s.
2023-06-24 15:13:23.555548 (MainThread): Connection 'master' was left open.
2023-06-24 15:13:23.556048 (MainThread): On master: Close
2023-06-24 15:13:23.556048 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:13:23.556048 (MainThread): On list_postgres: Close
2023-06-24 15:13:23.556048 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:13:23.556048 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:13:23.556048 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:13:23.556549 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:13:23.558549 (MainThread): 
2023-06-24 15:13:23.558549 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:13:23.558549 (MainThread): 
2023-06-24 15:13:23.558549 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:13:23.558549 (MainThread):   relation "myschema.postgres" does not exist
2023-06-24 15:13:23.559049 (MainThread):   LINE 11:     FROM myschema.postgres -- Replace 'myschema' with your a...
2023-06-24 15:13:23.559049 (MainThread):                     ^
2023-06-24 15:13:23.559049 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:13:23.559049 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:13:23.559049 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2871E86A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2870FC8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28716CD68>]}
2023-06-24 15:13:23.559049 (MainThread): Flushing usage events
2023-06-24 15:20:16.792844 (MainThread): Running with dbt=0.16.0
2023-06-24 15:20:16.830344 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:20:16.830844 (MainThread): Tracking: tracking
2023-06-24 15:20:16.831345 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1008AF5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1008840F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A100884DD8>]}
2023-06-24 15:20:16.842844 (MainThread): Partial parsing not enabled
2023-06-24 15:20:16.844844 (MainThread): Parsing macros\core.sql
2023-06-24 15:20:16.848344 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:20:16.879845 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:20:16.886844 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:20:16.887844 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:20:16.888344 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:20:16.890344 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:20:16.891844 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:20:16.892844 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:20:16.893844 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:20:16.899845 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:20:16.909344 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:20:16.910844 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:20:16.915344 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:20:16.930844 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:20:16.955844 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:20:16.957344 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:20:16.969845 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:20:16.974844 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:20:16.978344 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:20:16.983344 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:20:16.984844 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:20:16.985344 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:20:16.986344 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:20:16.987844 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:20:17.000844 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:20:17.002344 (MainThread): Parsing macros\relations.sql
2023-06-24 15:20:17.003845 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:20:17.016344 (MainThread): Partial parsing not enabled
2023-06-24 15:20:17.035344 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:20:17.035344 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:20:17.044845 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:20:17.044845 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:20:17.048344 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:20:17.048344 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:20:17.051844 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:20:17.051844 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:20:17.072344 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:20:17.072344 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:20:17.078344 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:20:17.078844 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:20:17.084344 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:20:17.084344 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:20:17.088844 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:20:17.088844 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:20:17.161344 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:20:17.244344 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:20:17.244344 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:20:17.244344 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:20:17.244344 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:20:17.244344 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:20:17.244344 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:20:17.244844 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:20:17.246345 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.246844 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.247344 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.249344 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.250344 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.250844 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.251844 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.252344 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.252844 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.253844 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.254844 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.255345 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.256379 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.257374 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.260375 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.263877 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.264875 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.266376 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.267375 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.267874 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.276375 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.279877 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:20:17.279877 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:20:17.281383 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.314845 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.315345 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.317845 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.335845 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.340344 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.340844 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.354345 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.356844 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.373346 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.374344 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.388845 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.406844 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:20:17.407845 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:20:17.410844 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:20:17.411346 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:20:17.413844 (MainThread): 
2023-06-24 15:20:17.413844 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:20:17.413844 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:20:17.417344 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:20:17.417844 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:20:17.472344 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:20:17.472844 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:20:17.502844 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:20:17.521344 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:20:17.521344 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:20:17.522344 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:20:17.522344 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:20:17.550844 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:20:17.550844 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:20:17.551344 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:20:17.553844 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:20:17.554845 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:20:17.573845 (MainThread): Using postgres connection "master".
2023-06-24 15:20:17.574344 (MainThread): On master: BEGIN
2023-06-24 15:20:17.601844 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:20:17.602344 (MainThread): Using postgres connection "master".
2023-06-24 15:20:17.602344 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:20:17.605845 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:20:17.606344 (MainThread): On master: ROLLBACK
2023-06-24 15:20:17.606844 (MainThread): Using postgres connection "master".
2023-06-24 15:20:17.606844 (MainThread): On master: BEGIN
2023-06-24 15:20:17.606844 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:20:17.607344 (MainThread): On master: COMMIT
2023-06-24 15:20:17.607344 (MainThread): Using postgres connection "master".
2023-06-24 15:20:17.607344 (MainThread): On master: COMMIT
2023-06-24 15:20:17.607344 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:20:17.607344 (MainThread): 11:20:17 | Concurrency: 1 threads (target='dev')
2023-06-24 15:20:17.607844 (MainThread): 11:20:17 | 
2023-06-24 15:20:17.609344 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:20:17.609344 (Thread-1): 11:20:17 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:20:17.609344 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:20:17.609845 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:20:17.609845 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:20:17.617844 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:20:17.618345 (Thread-1): finished collecting timing info
2023-06-24 15:20:17.637844 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:20:17.638344 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:20:17.671844 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:20:17.673344 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:20:17.673344 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:20:17.673344 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:20:17.674344 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:20:17.674844 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:20:17.674844 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:20:17.675345 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:20:17.675345 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:20:17.675345 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.
WITH filtered_data AS (
    SELECT *
    FROM myschema.postgres
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:20:17.675844 (Thread-1): Postgres error: relation "myschema.postgres" does not exist
LINE 9:     FROM myschema.postgres
                 ^

2023-06-24 15:20:17.675844 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:20:17.675844 (Thread-1): finished collecting timing info
2023-06-24 15:20:17.676344 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 9:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.postgres" does not exist
LINE 9:     FROM myschema.postgres
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 9:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:20:17.677844 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd7e47c2-9e24-487d-bbe1-a23d5db6d47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A104529DA0>]}
2023-06-24 15:20:17.677844 (Thread-1): 11:20:17 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.07s]
2023-06-24 15:20:17.677844 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:20:17.711345 (MainThread): Using postgres connection "master".
2023-06-24 15:20:17.711345 (MainThread): On master: BEGIN
2023-06-24 15:20:17.711345 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:20:17.711345 (MainThread): On master: COMMIT
2023-06-24 15:20:17.711844 (MainThread): Using postgres connection "master".
2023-06-24 15:20:17.711844 (MainThread): On master: COMMIT
2023-06-24 15:20:17.711844 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:20:17.711844 (MainThread): 11:20:17 | 
2023-06-24 15:20:17.711844 (MainThread): 11:20:17 | Finished running 1 view model in 0.30s.
2023-06-24 15:20:17.712344 (MainThread): Connection 'master' was left open.
2023-06-24 15:20:17.712344 (MainThread): On master: Close
2023-06-24 15:20:17.712344 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:20:17.712344 (MainThread): On list_postgres: Close
2023-06-24 15:20:17.712344 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:20:17.712344 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:20:17.712845 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:20:17.712845 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:20:17.715845 (MainThread): 
2023-06-24 15:20:17.715845 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:20:17.716345 (MainThread): 
2023-06-24 15:20:17.716345 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:20:17.716345 (MainThread):   relation "myschema.postgres" does not exist
2023-06-24 15:20:17.716345 (MainThread):   LINE 9:     FROM myschema.postgres
2023-06-24 15:20:17.716345 (MainThread):                    ^
2023-06-24 15:20:17.716345 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:20:17.716345 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:20:17.716844 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1047A3978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1044AB860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1045269B0>]}
2023-06-24 15:20:17.716844 (MainThread): Flushing usage events
2023-06-24 15:21:32.016550 (MainThread): Running with dbt=0.16.0
2023-06-24 15:21:32.054050 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:21:32.054550 (MainThread): Tracking: tracking
2023-06-24 15:21:32.055051 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253481FF588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253481F79B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253481D4A20>]}
2023-06-24 15:21:32.066550 (MainThread): Partial parsing not enabled
2023-06-24 15:21:32.068550 (MainThread): Parsing macros\core.sql
2023-06-24 15:21:32.072050 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:21:32.103550 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:21:32.110550 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:21:32.111049 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:21:32.112050 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:21:32.113550 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:21:32.115050 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:21:32.116549 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:21:32.117550 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:21:32.123050 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:21:32.132549 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:21:32.134049 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:21:32.138550 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:21:32.154550 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:21:32.179050 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:21:32.180550 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:21:32.192550 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:21:32.198050 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:21:32.201550 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:21:32.206049 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:21:32.208049 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:21:32.208549 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:21:32.209549 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:21:32.210549 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:21:32.223550 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:21:32.225549 (MainThread): Parsing macros\relations.sql
2023-06-24 15:21:32.226550 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:21:32.239549 (MainThread): Partial parsing not enabled
2023-06-24 15:21:32.258050 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:21:32.258550 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:32.268050 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:21:32.268550 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:32.271550 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:21:32.271550 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:32.275550 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:32.275550 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:32.296050 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:21:32.296050 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:32.302050 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:21:32.302550 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:32.308050 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:21:32.308050 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:32.312550 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:21:32.313050 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:32.384050 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:21:32.463549 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:32.463549 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:32.463549 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:32.463549 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:32.464049 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:32.464049 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:32.464049 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:32.465550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.466051 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.466550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.468550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.469551 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.470050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.470550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.471550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.472050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.472550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.473550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.474050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.475050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.476050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.479050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.482550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.483551 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.485050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.485550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.486551 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.494050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.497049 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:32.497550 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:32.498550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.531050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.532051 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.534051 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.551550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.555550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.556050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.569050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.571550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.587551 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.588550 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.602050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.619050 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:32.620049 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:21:32.622550 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:21:32.623050 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:21:32.625550 (MainThread): 
2023-06-24 15:21:32.625550 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:21:32.626051 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:32.629550 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:21:32.629550 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:21:32.684549 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:21:32.685051 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:21:32.715050 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:21:32.733550 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:21:32.734050 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:21:32.734550 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:21:32.735050 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:21:32.763082 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:21:32.763082 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:21:32.763082 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:21:32.766086 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:21:32.767115 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:21:32.786086 (MainThread): Using postgres connection "master".
2023-06-24 15:21:32.786086 (MainThread): On master: BEGIN
2023-06-24 15:21:32.818086 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:21:32.818086 (MainThread): Using postgres connection "master".
2023-06-24 15:21:32.818086 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:21:32.821586 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:21:32.822585 (MainThread): On master: ROLLBACK
2023-06-24 15:21:32.822585 (MainThread): Using postgres connection "master".
2023-06-24 15:21:32.822585 (MainThread): On master: BEGIN
2023-06-24 15:21:32.823086 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:21:32.823086 (MainThread): On master: COMMIT
2023-06-24 15:21:32.823086 (MainThread): Using postgres connection "master".
2023-06-24 15:21:32.823086 (MainThread): On master: COMMIT
2023-06-24 15:21:32.823086 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:21:32.823586 (MainThread): 11:21:32 | Concurrency: 1 threads (target='dev')
2023-06-24 15:21:32.823586 (MainThread): 11:21:32 | 
2023-06-24 15:21:32.825086 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:21:32.825086 (Thread-1): 11:21:32 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:21:32.825586 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:32.825586 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:21:32.825586 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:21:32.833585 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:21:32.834586 (Thread-1): finished collecting timing info
2023-06-24 15:21:32.854085 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:32.854085 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:21:32.883586 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:21:32.885085 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:32.885085 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:21:32.885586 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:21:32.886085 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:21:32.886585 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:32.887086 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:21:32.887292 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:21:32.887292 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:32.887292 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.
WITH filtered_data AS (
    SELECT *
    FROM myschema.postgres
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:21:32.887292 (Thread-1): Postgres error: relation "myschema.postgres" does not exist
LINE 9:     FROM myschema.postgres
                 ^

2023-06-24 15:21:32.887797 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:21:32.887797 (Thread-1): finished collecting timing info
2023-06-24 15:21:32.888297 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 9:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.postgres" does not exist
LINE 9:     FROM myschema.postgres
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 9:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:21:32.889797 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00f56f61-1f3f-4b9f-99c1-430668faae65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002534C15CC18>]}
2023-06-24 15:21:32.889797 (Thread-1): 11:21:32 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:21:32.889797 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:21:32.935373 (MainThread): Using postgres connection "master".
2023-06-24 15:21:32.935373 (MainThread): On master: BEGIN
2023-06-24 15:21:32.935373 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:21:32.935373 (MainThread): On master: COMMIT
2023-06-24 15:21:32.935373 (MainThread): Using postgres connection "master".
2023-06-24 15:21:32.935873 (MainThread): On master: COMMIT
2023-06-24 15:21:32.935873 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:21:32.935873 (MainThread): 11:21:32 | 
2023-06-24 15:21:32.935873 (MainThread): 11:21:32 | Finished running 1 view model in 0.31s.
2023-06-24 15:21:32.936403 (MainThread): Connection 'master' was left open.
2023-06-24 15:21:32.936403 (MainThread): On master: Close
2023-06-24 15:21:32.936403 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:21:32.936403 (MainThread): On list_postgres: Close
2023-06-24 15:21:32.936403 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:21:32.936403 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:21:32.936916 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:21:32.936916 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:21:32.938873 (MainThread): 
2023-06-24 15:21:32.939372 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:21:32.939372 (MainThread): 
2023-06-24 15:21:32.939372 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:21:32.939372 (MainThread):   relation "myschema.postgres" does not exist
2023-06-24 15:21:32.939372 (MainThread):   LINE 9:     FROM myschema.postgres
2023-06-24 15:21:32.939372 (MainThread):                    ^
2023-06-24 15:21:32.939372 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:21:32.939372 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:21:32.939872 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002534BEBF2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002534BE7E7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002534BEEE780>]}
2023-06-24 15:21:32.939872 (MainThread): Flushing usage events
2023-06-24 15:21:52.502667 (MainThread): Running with dbt=0.16.0
2023-06-24 15:21:52.541165 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:21:52.541665 (MainThread): Tracking: tracking
2023-06-24 15:21:52.542165 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8326B45C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8326840F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A832684F60>]}
2023-06-24 15:21:52.553665 (MainThread): Partial parsing not enabled
2023-06-24 15:21:52.555665 (MainThread): Parsing macros\core.sql
2023-06-24 15:21:52.559165 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:21:52.590665 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:21:52.597665 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:21:52.598165 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:21:52.599165 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:21:52.600665 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:21:52.602165 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:21:52.603665 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:21:52.604665 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:21:52.610165 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:21:52.620165 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:21:52.621665 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:21:52.626165 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:21:52.641665 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:21:52.666665 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:21:52.668165 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:21:52.680165 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:21:52.685665 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:21:52.689165 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:21:52.694165 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:21:52.695665 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:21:52.696165 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:21:52.697165 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:21:52.698165 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:21:52.711165 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:21:52.713165 (MainThread): Parsing macros\relations.sql
2023-06-24 15:21:52.714165 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:21:52.726665 (MainThread): Partial parsing not enabled
2023-06-24 15:21:52.745665 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:21:52.745665 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:52.755665 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:21:52.755665 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:52.758665 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:21:52.758665 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:52.762666 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:52.762666 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:52.783165 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:21:52.783165 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:52.789165 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:21:52.789165 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:52.795165 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:21:52.795165 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:52.799665 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:21:52.799665 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:52.870665 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:21:52.949665 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:52.949665 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:52.949665 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:52.949665 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:52.949665 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:52.949665 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:52.950165 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:52.951166 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.952167 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.952665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.954165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.955166 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.956165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.956665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.957165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.957665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.958665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.959665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.960165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.961166 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.962165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.965165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.968665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.969165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.970666 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.971665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.972165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.979665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:52.983166 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:52.983166 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:21:52.984666 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.017196 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.017698 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.019701 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.037165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.041165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.042165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.054665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.057165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.072665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.074165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.087165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.104165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:21:53.105165 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:21:53.107665 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:21:53.108165 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:21:53.110665 (MainThread): 
2023-06-24 15:21:53.110665 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:21:53.110665 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:21:53.114165 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:21:53.114665 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:21:53.169665 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:21:53.169665 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:21:53.200185 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:21:53.218656 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:21:53.218656 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:21:53.219721 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:21:53.219721 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:21:53.252325 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:21:53.252325 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:21:53.252825 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:21:53.255324 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:21:53.256324 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:21:53.275324 (MainThread): Using postgres connection "master".
2023-06-24 15:21:53.275324 (MainThread): On master: BEGIN
2023-06-24 15:21:53.302824 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:21:53.303325 (MainThread): Using postgres connection "master".
2023-06-24 15:21:53.303325 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:21:53.306853 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:21:53.307325 (MainThread): On master: ROLLBACK
2023-06-24 15:21:53.307325 (MainThread): Using postgres connection "master".
2023-06-24 15:21:53.307824 (MainThread): On master: BEGIN
2023-06-24 15:21:53.307824 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:21:53.307824 (MainThread): On master: COMMIT
2023-06-24 15:21:53.307824 (MainThread): Using postgres connection "master".
2023-06-24 15:21:53.307824 (MainThread): On master: COMMIT
2023-06-24 15:21:53.308325 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:21:53.308325 (MainThread): 11:21:53 | Concurrency: 1 threads (target='dev')
2023-06-24 15:21:53.308325 (MainThread): 11:21:53 | 
2023-06-24 15:21:53.310325 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:21:53.310325 (Thread-1): 11:21:53 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:21:53.310325 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:53.310325 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:21:53.310325 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:21:53.318825 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:21:53.319325 (Thread-1): finished collecting timing info
2023-06-24 15:21:53.339325 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:53.339325 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:21:53.367826 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:21:53.369325 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:53.369325 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:21:53.369325 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:21:53.370325 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:21:53.370825 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:53.370825 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:21:53.371325 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:21:53.371325 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:21:53.371325 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.
WITH filtered_data AS (
    SELECT *
    FROM postgres
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:21:53.371826 (Thread-1): Postgres error: relation "postgres" does not exist
LINE 9:     FROM postgres
                 ^

2023-06-24 15:21:53.371826 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:21:53.371826 (Thread-1): finished collecting timing info
2023-06-24 15:21:53.372325 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "postgres" does not exist
  LINE 9:     FROM postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres" does not exist
LINE 9:     FROM postgres
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "postgres" does not exist
  LINE 9:     FROM postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:21:53.373825 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c000013-9213-4114-87b4-8bf4b6cc5a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A836601DA0>]}
2023-06-24 15:21:53.373825 (Thread-1): 11:21:53 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:21:53.374325 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:21:53.417308 (MainThread): Using postgres connection "master".
2023-06-24 15:21:53.417809 (MainThread): On master: BEGIN
2023-06-24 15:21:53.418309 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:21:53.418808 (MainThread): On master: COMMIT
2023-06-24 15:21:53.419307 (MainThread): Using postgres connection "master".
2023-06-24 15:21:53.419807 (MainThread): On master: COMMIT
2023-06-24 15:21:53.420813 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:21:53.421808 (MainThread): 11:21:53 | 
2023-06-24 15:21:53.422308 (MainThread): 11:21:53 | Finished running 1 view model in 0.31s.
2023-06-24 15:21:53.422808 (MainThread): Connection 'master' was left open.
2023-06-24 15:21:53.422808 (MainThread): On master: Close
2023-06-24 15:21:53.423801 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:21:53.423801 (MainThread): On list_postgres: Close
2023-06-24 15:21:53.424813 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:21:53.424813 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:21:53.425769 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:21:53.425769 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:21:53.428749 (MainThread): 
2023-06-24 15:21:53.428749 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:21:53.428749 (MainThread): 
2023-06-24 15:21:53.428749 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:21:53.428749 (MainThread):   relation "postgres" does not exist
2023-06-24 15:21:53.428749 (MainThread):   LINE 9:     FROM postgres
2023-06-24 15:21:53.429249 (MainThread):                    ^
2023-06-24 15:21:53.429249 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:21:53.429249 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:21:53.429249 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8362D5DD8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8366209E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A836620940>]}
2023-06-24 15:21:53.429249 (MainThread): Flushing usage events
2023-06-24 15:23:24.693538 (MainThread): Running with dbt=0.16.0
2023-06-24 15:23:24.731039 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:23:24.731539 (MainThread): Tracking: tracking
2023-06-24 15:23:24.732038 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C81DD620B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C81DC07A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C81DBE4CC0>]}
2023-06-24 15:23:24.743539 (MainThread): Partial parsing not enabled
2023-06-24 15:23:24.745538 (MainThread): Parsing macros\core.sql
2023-06-24 15:23:24.749039 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:23:24.780038 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:23:24.787038 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:23:24.788039 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:23:24.789038 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:23:24.790539 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:23:24.792038 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:23:24.793539 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:23:24.794040 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:23:24.800038 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:23:24.809539 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:23:24.811038 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:23:24.816039 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:23:24.831538 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:23:24.856540 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:23:24.858040 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:23:24.871038 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:23:24.876039 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:23:24.879538 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:23:24.884539 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:23:24.886039 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:23:24.886538 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:23:24.887538 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:23:24.889038 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:23:24.902042 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:23:24.903538 (MainThread): Parsing macros\relations.sql
2023-06-24 15:23:24.904538 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:23:24.917538 (MainThread): Partial parsing not enabled
2023-06-24 15:23:24.936538 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:23:24.936538 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:23:24.946538 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:23:24.946538 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:23:24.950038 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:23:24.950038 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:23:24.953538 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:23:24.953538 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:23:24.975039 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:23:24.975039 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:23:24.982039 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:23:24.982039 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:23:24.988039 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:23:24.988039 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:23:24.993068 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:23:24.993068 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:23:25.066539 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:23:25.148568 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:23:25.148568 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:23:25.148568 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:23:25.148568 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:23:25.148568 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:23:25.149088 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:23:25.149088 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:23:25.150538 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.151039 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.151539 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.153539 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.154539 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.155039 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.155538 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.156539 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.157039 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.157539 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.158538 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.159039 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.160039 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.161038 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.164039 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.167538 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.168538 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.169538 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.170539 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.171038 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.178538 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.182039 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:23:25.182039 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:23:25.183538 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.220039 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.221039 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.223039 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.240539 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.245039 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.245538 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.258540 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.261039 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.279539 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.280538 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.294079 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.311038 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:23:25.312039 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:23:25.315038 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:23:25.315038 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:23:25.317538 (MainThread): 
2023-06-24 15:23:25.318038 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:23:25.318038 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:23:25.321539 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:23:25.321539 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:23:25.377539 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:23:25.377539 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:23:25.407538 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:23:25.426038 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:23:25.426038 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:23:25.427039 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:23:25.427039 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:23:25.456039 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:23:25.456039 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:23:25.456039 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:23:25.459039 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:23:25.459538 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:23:25.478539 (MainThread): Using postgres connection "master".
2023-06-24 15:23:25.478539 (MainThread): On master: BEGIN
2023-06-24 15:23:25.506538 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:23:25.506538 (MainThread): Using postgres connection "master".
2023-06-24 15:23:25.506538 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:23:25.510038 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:23:25.510539 (MainThread): On master: ROLLBACK
2023-06-24 15:23:25.511038 (MainThread): Using postgres connection "master".
2023-06-24 15:23:25.511038 (MainThread): On master: BEGIN
2023-06-24 15:23:25.511038 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:23:25.511538 (MainThread): On master: COMMIT
2023-06-24 15:23:25.511538 (MainThread): Using postgres connection "master".
2023-06-24 15:23:25.511538 (MainThread): On master: COMMIT
2023-06-24 15:23:25.511538 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:23:25.511538 (MainThread): 11:23:25 | Concurrency: 1 threads (target='dev')
2023-06-24 15:23:25.512038 (MainThread): 11:23:25 | 
2023-06-24 15:23:25.513039 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:23:25.513539 (Thread-1): 11:23:25 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:23:25.513539 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:23:25.513539 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:23:25.513539 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:23:25.521540 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:23:25.522541 (Thread-1): finished collecting timing info
2023-06-24 15:23:25.542538 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:23:25.542538 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:23:25.571123 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:23:25.572622 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:23:25.572622 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:23:25.573122 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:23:25.574122 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:23:25.574624 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:23:25.574624 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:23:25.574624 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:23:25.575122 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:23:25.575122 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.
WITH filtered_data AS (
    SELECT *
    FROM postgres
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:23:25.575122 (Thread-1): Postgres error: relation "postgres" does not exist
LINE 9:     FROM postgres
                 ^

2023-06-24 15:23:25.575622 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:23:25.575622 (Thread-1): finished collecting timing info
2023-06-24 15:23:25.576122 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "postgres" does not exist
  LINE 9:     FROM postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres" does not exist
LINE 9:     FROM postgres
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "postgres" does not exist
  LINE 9:     FROM postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:23:25.577622 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dea3b8-77bb-47c1-9a71-f8b946cd5ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C821909DA0>]}
2023-06-24 15:23:25.577622 (Thread-1): 11:23:25 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:23:25.577622 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:23:25.613561 (MainThread): Using postgres connection "master".
2023-06-24 15:23:25.613561 (MainThread): On master: BEGIN
2023-06-24 15:23:25.614060 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:23:25.614060 (MainThread): On master: COMMIT
2023-06-24 15:23:25.614060 (MainThread): Using postgres connection "master".
2023-06-24 15:23:25.614060 (MainThread): On master: COMMIT
2023-06-24 15:23:25.614060 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:23:25.614561 (MainThread): 11:23:25 | 
2023-06-24 15:23:25.614561 (MainThread): 11:23:25 | Finished running 1 view model in 0.30s.
2023-06-24 15:23:25.614561 (MainThread): Connection 'master' was left open.
2023-06-24 15:23:25.614561 (MainThread): On master: Close
2023-06-24 15:23:25.614561 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:23:25.614561 (MainThread): On list_postgres: Close
2023-06-24 15:23:25.614561 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:23:25.615091 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:23:25.615091 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:23:25.615091 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:23:25.617060 (MainThread): 
2023-06-24 15:23:25.617060 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:23:25.617560 (MainThread): 
2023-06-24 15:23:25.617560 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:23:25.617560 (MainThread):   relation "postgres" does not exist
2023-06-24 15:23:25.617560 (MainThread):   LINE 9:     FROM postgres
2023-06-24 15:23:25.617560 (MainThread):                    ^
2023-06-24 15:23:25.617560 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:23:25.617560 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:23:25.618059 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82188D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C821904978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C821904630>]}
2023-06-24 15:23:25.618059 (MainThread): Flushing usage events
2023-06-24 15:30:33.701665 (MainThread): Running with dbt=0.16.0
2023-06-24 15:30:33.738664 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:30:33.739164 (MainThread): Tracking: tracking
2023-06-24 15:30:33.739664 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257ECB01048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257EC9A7A58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257EC984E48>]}
2023-06-24 15:30:33.750664 (MainThread): Partial parsing not enabled
2023-06-24 15:30:33.753164 (MainThread): Parsing macros\core.sql
2023-06-24 15:30:33.756664 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:30:33.787664 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:30:33.794665 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:30:33.795164 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:30:33.796164 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:30:33.797664 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:30:33.799164 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:30:33.800664 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:30:33.801664 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:30:33.807164 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:30:33.816664 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:30:33.818164 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:30:33.822664 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:30:33.838664 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:30:33.863164 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:30:33.864664 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:30:33.876664 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:30:33.881664 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:30:33.885664 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:30:33.890164 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:30:33.891664 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:30:33.892664 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:30:33.893664 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:30:33.894664 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:30:33.907664 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:30:33.909164 (MainThread): Parsing macros\relations.sql
2023-06-24 15:30:33.910664 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:30:33.923164 (MainThread): Partial parsing not enabled
2023-06-24 15:30:33.941664 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:30:33.941664 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:30:33.951664 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:30:33.951664 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:30:33.954664 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:30:33.954664 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:30:33.958664 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:30:33.958664 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:30:33.979164 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:30:33.979164 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:30:33.985164 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:30:33.985164 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:30:33.991164 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:30:33.991164 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:30:33.995664 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:30:33.995664 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:30:34.066664 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:30:34.145164 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:30:34.145164 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:30:34.145164 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:30:34.145664 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:30:34.145664 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:30:34.145664 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:30:34.145664 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:30:34.147164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.147665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.148164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.150164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.151165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.151664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.152164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.153164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.153664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.154164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.155164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.155664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.156664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.157664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.160664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.164164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.164664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.166165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.167165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.167664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.175164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.178664 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:30:34.178664 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:30:34.180164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.211665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.212165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.214164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.231164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.235664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.236165 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.249665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.252164 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.267664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.268664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.281665 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.298664 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:30:34.299664 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:30:34.302164 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:30:34.302664 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:30:34.305164 (MainThread): 
2023-06-24 15:30:34.305164 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:30:34.305164 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:30:34.308664 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:30:34.309164 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:30:34.363664 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:30:34.363664 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:30:34.394116 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:30:34.412821 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:30:34.412821 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:30:34.413854 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:30:34.413854 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:30:34.442415 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:30:34.442415 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:30:34.442415 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:30:34.445415 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:30:34.445946 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:30:34.465415 (MainThread): Using postgres connection "master".
2023-06-24 15:30:34.465415 (MainThread): On master: BEGIN
2023-06-24 15:30:34.493415 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:30:34.493915 (MainThread): Using postgres connection "master".
2023-06-24 15:30:34.493915 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:30:34.497415 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:30:34.497915 (MainThread): On master: ROLLBACK
2023-06-24 15:30:34.497915 (MainThread): Using postgres connection "master".
2023-06-24 15:30:34.498415 (MainThread): On master: BEGIN
2023-06-24 15:30:34.498415 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:30:34.498415 (MainThread): On master: COMMIT
2023-06-24 15:30:34.498415 (MainThread): Using postgres connection "master".
2023-06-24 15:30:34.498915 (MainThread): On master: COMMIT
2023-06-24 15:30:34.498915 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:30:34.498915 (MainThread): 11:30:34 | Concurrency: 1 threads (target='dev')
2023-06-24 15:30:34.498915 (MainThread): 11:30:34 | 
2023-06-24 15:30:34.500415 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:30:34.500915 (Thread-1): 11:30:34 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:30:34.500915 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:30:34.500915 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:30:34.500915 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:30:34.509414 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:30:34.509915 (Thread-1): finished collecting timing info
2023-06-24 15:30:34.529414 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:30:34.529414 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:30:34.560415 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:30:34.561914 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:30:34.561914 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:30:34.562414 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:30:34.563414 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:30:34.563915 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:30:34.563915 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:30:34.563915 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:30:34.563915 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:30:34.563915 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.
WITH filtered_data AS (
    SELECT *
    FROM postgres
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:30:34.564415 (Thread-1): Postgres error: relation "postgres" does not exist
LINE 9:     FROM postgres
                 ^

2023-06-24 15:30:34.564415 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:30:34.564915 (Thread-1): finished collecting timing info
2023-06-24 15:30:34.564915 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "postgres" does not exist
  LINE 9:     FROM postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "postgres" does not exist
LINE 9:     FROM postgres
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "postgres" does not exist
  LINE 9:     FROM postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:30:34.566414 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25a80622-1355-4449-91de-88f2cf3bd9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F0901D68>]}
2023-06-24 15:30:34.566914 (Thread-1): 11:30:34 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.07s]
2023-06-24 15:30:34.566914 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:30:34.614781 (MainThread): Using postgres connection "master".
2023-06-24 15:30:34.615317 (MainThread): On master: BEGIN
2023-06-24 15:30:34.615317 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:30:34.615317 (MainThread): On master: COMMIT
2023-06-24 15:30:34.615317 (MainThread): Using postgres connection "master".
2023-06-24 15:30:34.615317 (MainThread): On master: COMMIT
2023-06-24 15:30:34.615814 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:30:34.615814 (MainThread): 11:30:34 | 
2023-06-24 15:30:34.615814 (MainThread): 11:30:34 | Finished running 1 view model in 0.31s.
2023-06-24 15:30:34.615814 (MainThread): Connection 'master' was left open.
2023-06-24 15:30:34.616314 (MainThread): On master: Close
2023-06-24 15:30:34.616314 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:30:34.616314 (MainThread): On list_postgres: Close
2023-06-24 15:30:34.616314 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:30:34.616314 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:30:34.616314 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:30:34.616814 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:30:34.618695 (MainThread): 
2023-06-24 15:30:34.619199 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:30:34.619199 (MainThread): 
2023-06-24 15:30:34.619199 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:30:34.619199 (MainThread):   relation "postgres" does not exist
2023-06-24 15:30:34.619199 (MainThread):   LINE 9:     FROM postgres
2023-06-24 15:30:34.619199 (MainThread):                    ^
2023-06-24 15:30:34.619199 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:30:34.619199 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:30:34.619699 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F09259E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F062A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F069C9E8>]}
2023-06-24 15:30:34.619699 (MainThread): Flushing usage events
2023-06-24 15:31:01.030531 (MainThread): Running with dbt=0.16.0
2023-06-24 15:31:01.068531 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:31:01.069031 (MainThread): Tracking: tracking
2023-06-24 15:31:01.069531 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0EB2E748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0EB27978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0EAEB358>]}
2023-06-24 15:31:01.080531 (MainThread): Partial parsing not enabled
2023-06-24 15:31:01.083031 (MainThread): Parsing macros\core.sql
2023-06-24 15:31:01.086032 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:31:01.117531 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:31:01.124531 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:31:01.125031 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:31:01.126031 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:31:01.127531 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:31:01.129031 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:31:01.130531 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:31:01.131531 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:31:01.137031 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:31:01.147030 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:31:01.148531 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:31:01.153031 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:31:01.168531 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:31:01.193031 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:31:01.194532 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:31:01.207031 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:31:01.212031 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:31:01.216031 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:31:01.220531 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:31:01.222031 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:31:01.223031 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:31:01.223531 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:31:01.225031 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:31:01.238531 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:31:01.240031 (MainThread): Parsing macros\relations.sql
2023-06-24 15:31:01.241531 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:31:01.254031 (MainThread): Partial parsing not enabled
2023-06-24 15:31:01.272532 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:31:01.273031 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:01.282531 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:31:01.282531 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:01.286031 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:31:01.286031 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:01.289531 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:01.289531 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:01.310031 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:31:01.310531 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:01.316531 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:31:01.316531 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:01.322031 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:31:01.322031 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:01.327031 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:31:01.327031 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:01.397531 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:31:01.476032 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:01.476032 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:01.476032 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:01.476032 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:01.476032 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:01.476032 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:01.476032 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:01.477531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.478031 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.479031 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.480531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.481531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.482031 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.482531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.483531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.484031 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.484531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.485532 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.486031 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.487031 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.488030 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.491031 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.494531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.495031 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.496531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.497531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.498031 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.505531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.508531 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:01.509031 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:01.510031 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.543031 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.543532 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.545531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.562531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.566532 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.567531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.580531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.582531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.598032 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.599531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.612531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.629531 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:01.630530 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:31:01.633531 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:31:01.633531 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:31:01.636031 (MainThread): 
2023-06-24 15:31:01.636031 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:31:01.636531 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:01.640031 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:31:01.640031 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:31:01.695533 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:31:01.695533 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:31:01.725563 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:31:01.744031 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:31:01.744531 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:31:01.745032 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:31:01.745531 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:31:01.773032 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:31:01.773032 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:31:01.773032 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:31:01.776063 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:31:01.777032 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:31:01.796031 (MainThread): Using postgres connection "master".
2023-06-24 15:31:01.796031 (MainThread): On master: BEGIN
2023-06-24 15:31:01.824531 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:31:01.824531 (MainThread): Using postgres connection "master".
2023-06-24 15:31:01.824531 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:31:01.828031 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:31:01.828531 (MainThread): On master: ROLLBACK
2023-06-24 15:31:01.829031 (MainThread): Using postgres connection "master".
2023-06-24 15:31:01.829031 (MainThread): On master: BEGIN
2023-06-24 15:31:01.829031 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:31:01.829031 (MainThread): On master: COMMIT
2023-06-24 15:31:01.829031 (MainThread): Using postgres connection "master".
2023-06-24 15:31:01.829531 (MainThread): On master: COMMIT
2023-06-24 15:31:01.829531 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:31:01.829531 (MainThread): 11:31:01 | Concurrency: 1 threads (target='dev')
2023-06-24 15:31:01.829531 (MainThread): 11:31:01 | 
2023-06-24 15:31:01.831031 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:31:01.831531 (Thread-1): 11:31:01 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:31:01.831531 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:01.831531 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:31:01.831531 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:31:01.840032 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:31:01.840531 (Thread-1): finished collecting timing info
2023-06-24 15:31:01.860531 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:01.861032 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:31:01.890010 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:31:01.892040 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:01.892040 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:31:01.892040 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:31:01.893041 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:31:01.893541 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:01.893541 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:31:01.894011 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:31:01.894011 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:01.894011 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.
WITH filtered_data AS (
    SELECT *
    FROM myschema.postgres
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:31:01.894510 (Thread-1): Postgres error: relation "myschema.postgres" does not exist
LINE 9:     FROM myschema.postgres
                 ^

2023-06-24 15:31:01.894510 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:31:01.894510 (Thread-1): finished collecting timing info
2023-06-24 15:31:01.895010 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 9:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.postgres" does not exist
LINE 9:     FROM myschema.postgres
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 9:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:31:01.896510 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece255ee-d6eb-4b2d-8fdd-da850df05914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0FBF4780>]}
2023-06-24 15:31:01.896510 (Thread-1): 11:31:01 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:31:01.897010 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:31:01.937474 (MainThread): Using postgres connection "master".
2023-06-24 15:31:01.937973 (MainThread): On master: BEGIN
2023-06-24 15:31:01.937973 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:31:01.937973 (MainThread): On master: COMMIT
2023-06-24 15:31:01.937973 (MainThread): Using postgres connection "master".
2023-06-24 15:31:01.937973 (MainThread): On master: COMMIT
2023-06-24 15:31:01.938474 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:31:01.938474 (MainThread): 11:31:01 | 
2023-06-24 15:31:01.938474 (MainThread): 11:31:01 | Finished running 1 view model in 0.30s.
2023-06-24 15:31:01.938474 (MainThread): Connection 'master' was left open.
2023-06-24 15:31:01.938973 (MainThread): On master: Close
2023-06-24 15:31:01.938973 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:31:01.938973 (MainThread): On list_postgres: Close
2023-06-24 15:31:01.938973 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:31:01.938973 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:31:01.938973 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:31:01.939476 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:31:01.941443 (MainThread): 
2023-06-24 15:31:01.941443 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:31:01.941443 (MainThread): 
2023-06-24 15:31:01.941443 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:31:01.941443 (MainThread):   relation "myschema.postgres" does not exist
2023-06-24 15:31:01.941944 (MainThread):   LINE 9:     FROM myschema.postgres
2023-06-24 15:31:01.941944 (MainThread):                    ^
2023-06-24 15:31:01.941944 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:31:01.941944 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:31:01.941944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0FE728D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0FB7D8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0FBED7F0>]}
2023-06-24 15:31:01.941944 (MainThread): Flushing usage events
2023-06-24 15:31:48.473866 (MainThread): Running with dbt=0.16.0
2023-06-24 15:31:48.511366 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:31:48.511866 (MainThread): Tracking: tracking
2023-06-24 15:31:48.511866 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA71F6EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA70A7B38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA7084C88>]}
2023-06-24 15:31:48.523366 (MainThread): Partial parsing not enabled
2023-06-24 15:31:48.525866 (MainThread): Parsing macros\core.sql
2023-06-24 15:31:48.529366 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:31:48.560366 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:31:48.567366 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:31:48.568366 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:31:48.568866 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:31:48.570366 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:31:48.572366 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:31:48.573366 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:31:48.574366 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:31:48.579866 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:31:48.589367 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:31:48.590866 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:31:48.595867 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:31:48.611366 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:31:48.635866 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:31:48.637366 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:31:48.649366 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:31:48.654867 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:31:48.658366 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:31:48.662866 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:31:48.664366 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:31:48.665366 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:31:48.666367 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:31:48.667366 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:31:48.680366 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:31:48.681866 (MainThread): Parsing macros\relations.sql
2023-06-24 15:31:48.682866 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:31:48.695866 (MainThread): Partial parsing not enabled
2023-06-24 15:31:48.714866 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:31:48.714866 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:48.724866 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:31:48.724866 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:48.727866 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:31:48.727866 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:48.731866 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:48.731866 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:48.752366 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:31:48.752366 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:48.758366 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:31:48.758366 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:48.763866 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:31:48.764366 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:48.768866 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:31:48.768866 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:48.840366 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:31:48.919866 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:48.920366 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:48.920366 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:48.920366 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:48.920366 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:48.920366 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:48.920366 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:48.921867 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.922366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.923366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.924866 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.925866 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.926366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.927366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.927866 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.928366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.928866 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.929867 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.930866 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.931866 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.932866 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.935867 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.939367 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.939866 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.941367 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.942367 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.942867 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.950366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.953866 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:48.953866 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:31:48.955366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.992367 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.993366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:48.995366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:49.013367 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:49.017866 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:49.018366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:49.031366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:49.033867 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:49.049367 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:49.050366 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:49.063866 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:49.080866 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:31:49.081366 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:31:49.084366 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:31:49.084866 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:31:49.087366 (MainThread): 
2023-06-24 15:31:49.087366 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:31:49.087366 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:31:49.090866 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:31:49.091367 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:31:49.146368 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:31:49.146368 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:31:49.176886 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:31:49.195855 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:31:49.195855 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:31:49.196855 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:31:49.196855 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:31:49.225525 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:31:49.225525 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:31:49.225525 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:31:49.228561 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:31:49.230029 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:31:49.249528 (MainThread): Using postgres connection "master".
2023-06-24 15:31:49.249528 (MainThread): On master: BEGIN
2023-06-24 15:31:49.280529 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:31:49.281030 (MainThread): Using postgres connection "master".
2023-06-24 15:31:49.281030 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:31:49.284529 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:31:49.285029 (MainThread): On master: ROLLBACK
2023-06-24 15:31:49.285029 (MainThread): Using postgres connection "master".
2023-06-24 15:31:49.285029 (MainThread): On master: BEGIN
2023-06-24 15:31:49.285529 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:31:49.285529 (MainThread): On master: COMMIT
2023-06-24 15:31:49.285529 (MainThread): Using postgres connection "master".
2023-06-24 15:31:49.285529 (MainThread): On master: COMMIT
2023-06-24 15:31:49.285529 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:31:49.286029 (MainThread): 11:31:49 | Concurrency: 1 threads (target='dev')
2023-06-24 15:31:49.286029 (MainThread): 11:31:49 | 
2023-06-24 15:31:49.287528 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:31:49.287528 (Thread-1): 11:31:49 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:31:49.287528 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:49.288029 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:31:49.288029 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:31:49.296028 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:31:49.296528 (Thread-1): finished collecting timing info
2023-06-24 15:31:49.316528 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:49.316528 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:31:49.344528 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:31:49.346028 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:49.346028 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:31:49.346529 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:31:49.347028 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:31:49.348029 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:49.348029 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:31:49.348029 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:31:49.348029 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:31:49.348029 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.
WITH filtered_data AS (
    SELECT *
    FROM myschema.postgres
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:31:49.348530 (Thread-1): Postgres error: relation "myschema.postgres" does not exist
LINE 9:     FROM myschema.postgres
                 ^

2023-06-24 15:31:49.348530 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:31:49.348530 (Thread-1): finished collecting timing info
2023-06-24 15:31:49.349029 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 9:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.postgres" does not exist
LINE 9:     FROM myschema.postgres
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 9:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:31:49.350528 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c26a55-0f74-4046-9240-9d04b069ff7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFAADA5898>]}
2023-06-24 15:31:49.351029 (Thread-1): 11:31:49 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:31:49.351029 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:31:49.398529 (MainThread): Using postgres connection "master".
2023-06-24 15:31:49.398529 (MainThread): On master: BEGIN
2023-06-24 15:31:49.398529 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:31:49.398529 (MainThread): On master: COMMIT
2023-06-24 15:31:49.398529 (MainThread): Using postgres connection "master".
2023-06-24 15:31:49.398529 (MainThread): On master: COMMIT
2023-06-24 15:31:49.399028 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:31:49.399028 (MainThread): 11:31:49 | 
2023-06-24 15:31:49.399028 (MainThread): 11:31:49 | Finished running 1 view model in 0.31s.
2023-06-24 15:31:49.399028 (MainThread): Connection 'master' was left open.
2023-06-24 15:31:49.399528 (MainThread): On master: Close
2023-06-24 15:31:49.399528 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:31:49.399528 (MainThread): On list_postgres: Close
2023-06-24 15:31:49.399528 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:31:49.399528 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:31:49.399528 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:31:49.400029 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:31:49.402030 (MainThread): 
2023-06-24 15:31:49.402030 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:31:49.402030 (MainThread): 
2023-06-24 15:31:49.402030 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:31:49.402529 (MainThread):   relation "myschema.postgres" does not exist
2023-06-24 15:31:49.402529 (MainThread):   LINE 9:     FROM myschema.postgres
2023-06-24 15:31:49.402529 (MainThread):                    ^
2023-06-24 15:31:49.402529 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:31:49.402529 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:31:49.402529 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFAAE2F208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFAAD2E898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFAAD99940>]}
2023-06-24 15:31:49.403029 (MainThread): Flushing usage events
2023-06-24 15:33:04.325184 (MainThread): Running with dbt=0.16.0
2023-06-24 15:33:04.363183 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:33:04.363683 (MainThread): Tracking: tracking
2023-06-24 15:33:04.364183 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AFE309F98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AFE1A4DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AFE1A4438>]}
2023-06-24 15:33:04.375684 (MainThread): Partial parsing not enabled
2023-06-24 15:33:04.378184 (MainThread): Parsing macros\core.sql
2023-06-24 15:33:04.381183 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:33:04.412684 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:33:04.419683 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:33:04.420684 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:33:04.421683 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:33:04.423183 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:33:04.424683 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:33:04.426183 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:33:04.426683 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:33:04.432683 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:33:04.442183 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:33:04.443684 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:33:04.448183 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:33:04.464184 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:33:04.488683 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:33:04.490183 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:33:04.502683 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:33:04.507683 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:33:04.511683 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:33:04.516184 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:33:04.517684 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:33:04.518683 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:33:04.519684 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:33:04.520684 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:33:04.533684 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:33:04.535683 (MainThread): Parsing macros\relations.sql
2023-06-24 15:33:04.536684 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:33:04.549685 (MainThread): Partial parsing not enabled
2023-06-24 15:33:04.569183 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:33:04.569183 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:04.579183 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:33:04.579183 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:04.582684 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:33:04.582684 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:04.586184 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:04.586683 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:04.607683 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:33:04.607683 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:04.613685 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:33:04.613685 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:04.619684 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:33:04.619684 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:04.624183 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:33:04.624183 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:04.696183 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:33:04.776184 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:04.776184 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:04.776184 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:04.776684 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:04.776684 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:04.776684 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:04.776684 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:04.778184 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.778684 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.779183 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.781184 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.782184 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.782683 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.783184 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.784185 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.784684 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.785184 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.786184 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.787184 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.787683 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.789183 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.791683 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.795684 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.796183 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.797683 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.798684 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.799184 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.806683 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.810183 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:04.810183 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:04.811684 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.844684 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.845684 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.847684 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.864684 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.869183 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.870184 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.882685 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.885183 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.901184 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.902184 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.915685 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.932683 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:04.933683 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:33:04.936684 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:33:04.937183 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:33:04.939683 (MainThread): 
2023-06-24 15:33:04.939683 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:33:04.939683 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:04.943184 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:33:04.943683 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:33:04.999683 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:33:04.999683 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:33:05.028683 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:33:05.047184 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:33:05.047184 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:33:05.048183 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:33:05.048683 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:33:05.076184 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:33:05.076184 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:33:05.076184 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:33:05.079183 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:33:05.080184 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:33:05.099184 (MainThread): Using postgres connection "master".
2023-06-24 15:33:05.099184 (MainThread): On master: BEGIN
2023-06-24 15:33:05.131183 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:33:05.131683 (MainThread): Using postgres connection "master".
2023-06-24 15:33:05.131683 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:33:05.135183 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:33:05.135683 (MainThread): On master: ROLLBACK
2023-06-24 15:33:05.135683 (MainThread): Using postgres connection "master".
2023-06-24 15:33:05.136184 (MainThread): On master: BEGIN
2023-06-24 15:33:05.136184 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:33:05.136184 (MainThread): On master: COMMIT
2023-06-24 15:33:05.136184 (MainThread): Using postgres connection "master".
2023-06-24 15:33:05.136683 (MainThread): On master: COMMIT
2023-06-24 15:33:05.136683 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:33:05.136683 (MainThread): 11:33:05 | Concurrency: 1 threads (target='dev')
2023-06-24 15:33:05.136683 (MainThread): 11:33:05 | 
2023-06-24 15:33:05.138185 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:33:05.138185 (Thread-1): 11:33:05 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:33:05.138684 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:05.138684 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:33:05.138684 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:33:05.147185 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:33:05.147684 (Thread-1): finished collecting timing info
2023-06-24 15:33:05.168184 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:05.168184 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:33:05.197009 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:33:05.198538 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:05.198538 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:33:05.198538 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:33:05.199539 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:33:05.200046 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:05.200510 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:33:05.200510 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:33:05.200510 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:05.200510 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql
-- Rule 1: Only extract data from Magic Eden contracts.
-- Rule 2: Filter out any records that are older than two years.
WITH filtered_data AS (
    SELECT *
    FROM myschema.postgres
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:33:05.201009 (Thread-1): Postgres error: relation "myschema.postgres" does not exist
LINE 9:     FROM myschema.postgres
                 ^

2023-06-24 15:33:05.201009 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:33:05.201510 (Thread-1): finished collecting timing info
2023-06-24 15:33:05.201510 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 9:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.postgres" does not exist
LINE 9:     FROM myschema.postgres
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 9:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:33:05.203038 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0487926f-8618-49ac-8a50-a2208de615ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A82150BE0>]}
2023-06-24 15:33:05.203548 (Thread-1): 11:33:05 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:33:05.203548 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:33:05.248921 (MainThread): Using postgres connection "master".
2023-06-24 15:33:05.248921 (MainThread): On master: BEGIN
2023-06-24 15:33:05.248921 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:33:05.248921 (MainThread): On master: COMMIT
2023-06-24 15:33:05.249450 (MainThread): Using postgres connection "master".
2023-06-24 15:33:05.249450 (MainThread): On master: COMMIT
2023-06-24 15:33:05.249450 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:33:05.249450 (MainThread): 11:33:05 | 
2023-06-24 15:33:05.249450 (MainThread): 11:33:05 | Finished running 1 view model in 0.31s.
2023-06-24 15:33:05.249955 (MainThread): Connection 'master' was left open.
2023-06-24 15:33:05.249955 (MainThread): On master: Close
2023-06-24 15:33:05.249955 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:33:05.249955 (MainThread): On list_postgres: Close
2023-06-24 15:33:05.249955 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:33:05.249955 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:33:05.250450 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:33:05.250450 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:33:05.252420 (MainThread): 
2023-06-24 15:33:05.252420 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:33:05.252420 (MainThread): 
2023-06-24 15:33:05.252921 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:33:05.252921 (MainThread):   relation "myschema.postgres" does not exist
2023-06-24 15:33:05.252921 (MainThread):   LINE 9:     FROM myschema.postgres
2023-06-24 15:33:05.252921 (MainThread):                    ^
2023-06-24 15:33:05.252921 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:33:05.252921 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:33:05.252921 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A81EA4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A81E7C860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A81E26CF8>]}
2023-06-24 15:33:05.253420 (MainThread): Flushing usage events
2023-06-24 15:33:50.676575 (MainThread): Running with dbt=0.16.0
2023-06-24 15:33:50.714576 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:33:50.715076 (MainThread): Tracking: tracking
2023-06-24 15:33:50.715576 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E778F588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E7787A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E77649E8>]}
2023-06-24 15:33:50.727076 (MainThread): Partial parsing not enabled
2023-06-24 15:33:50.729576 (MainThread): Parsing macros\core.sql
2023-06-24 15:33:50.733076 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:33:50.764576 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:33:50.772076 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:33:50.772576 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:33:50.773576 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:33:50.775076 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:33:50.776576 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:33:50.778076 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:33:50.779076 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:33:50.784576 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:33:50.794605 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:33:50.796105 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:33:50.800604 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:33:50.816575 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:33:50.841075 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:33:50.842575 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:33:50.855075 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:33:50.860575 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:33:50.864075 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:33:50.869075 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:33:50.870575 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:33:50.871075 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:33:50.872075 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:33:50.873575 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:33:50.886575 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:33:50.888075 (MainThread): Parsing macros\relations.sql
2023-06-24 15:33:50.889075 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:33:50.902576 (MainThread): Partial parsing not enabled
2023-06-24 15:33:50.922075 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:33:50.922075 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:50.932075 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:33:50.932575 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:50.935576 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:33:50.935576 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:50.939575 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:50.939575 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:50.961575 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:33:50.961575 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:50.967575 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:33:50.967575 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:50.973575 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:33:50.973575 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:50.978575 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:33:50.978575 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:51.050075 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:33:51.130075 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:51.130575 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:51.130575 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:51.130575 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:51.130575 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:51.130575 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:51.130575 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:51.132076 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.132575 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.133575 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.135076 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.136075 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.136576 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.137575 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.138075 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.138575 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.139575 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.140076 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.141076 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.142075 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.143075 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.145575 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.149075 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.150075 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.151576 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.152576 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.153075 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.160575 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.164075 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:51.164075 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:33:51.165575 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.197576 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.198576 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.200576 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.218076 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.222075 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.222575 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.235576 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.238075 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.254076 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.255077 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.268575 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.286077 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:33:51.287076 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:33:51.290075 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:33:51.290575 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:33:51.293075 (MainThread): 
2023-06-24 15:33:51.293075 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:33:51.293075 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:33:51.296575 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:33:51.297076 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:33:51.352575 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:33:51.352575 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:33:51.382576 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:33:51.401075 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:33:51.401075 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:33:51.402076 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:33:51.402076 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:33:51.429576 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:33:51.429576 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:33:51.429576 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:33:51.432576 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:33:51.433577 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:33:51.452576 (MainThread): Using postgres connection "master".
2023-06-24 15:33:51.453076 (MainThread): On master: BEGIN
2023-06-24 15:33:51.480576 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:33:51.481076 (MainThread): Using postgres connection "master".
2023-06-24 15:33:51.481076 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:33:51.484576 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:33:51.485076 (MainThread): On master: ROLLBACK
2023-06-24 15:33:51.485076 (MainThread): Using postgres connection "master".
2023-06-24 15:33:51.485576 (MainThread): On master: BEGIN
2023-06-24 15:33:51.485576 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:33:51.485576 (MainThread): On master: COMMIT
2023-06-24 15:33:51.485576 (MainThread): Using postgres connection "master".
2023-06-24 15:33:51.486077 (MainThread): On master: COMMIT
2023-06-24 15:33:51.486077 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:33:51.486077 (MainThread): 11:33:51 | Concurrency: 1 threads (target='dev')
2023-06-24 15:33:51.486077 (MainThread): 11:33:51 | 
2023-06-24 15:33:51.487576 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:33:51.487576 (Thread-1): 11:33:51 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:33:51.488076 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:51.488076 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:33:51.488076 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:33:51.497075 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:33:51.497576 (Thread-1): finished collecting timing info
2023-06-24 15:33:51.518076 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:51.518076 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:33:51.546076 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:33:51.547575 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:51.547575 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:33:51.548075 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:33:51.549075 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:33:51.549576 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:51.549576 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:33:51.549576 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:33:51.549576 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:33:51.549576 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql

WITH filtered_data AS (
    SELECT *
    FROM ""postgres"."myschema"."extracted_data""
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data;
  );

2023-06-24 15:33:51.550076 (Thread-1): Postgres error: zero-length delimited identifier at or near """"
LINE 8:     FROM ""postgres"."myschema"."extracted_data""
                 ^

2023-06-24 15:33:51.550076 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:33:51.550577 (Thread-1): finished collecting timing info
2023-06-24 15:33:51.550577 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  zero-length delimited identifier at or near """"
  LINE 8:     FROM ""postgres"."myschema"."extracted_data""
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: zero-length delimited identifier at or near """"
LINE 8:     FROM ""postgres"."myschema"."extracted_data""
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  zero-length delimited identifier at or near """"
  LINE 8:     FROM ""postgres"."myschema"."extracted_data""
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:33:51.552075 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35983a96-d7c1-4fd5-ad3b-87f5c4c57086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EB4845F8>]}
2023-06-24 15:33:51.552575 (Thread-1): 11:33:51 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:33:51.552575 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:33:51.595576 (MainThread): Using postgres connection "master".
2023-06-24 15:33:51.595576 (MainThread): On master: BEGIN
2023-06-24 15:33:51.596076 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:33:51.596076 (MainThread): On master: COMMIT
2023-06-24 15:33:51.596076 (MainThread): Using postgres connection "master".
2023-06-24 15:33:51.596076 (MainThread): On master: COMMIT
2023-06-24 15:33:51.596076 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:33:51.596576 (MainThread): 11:33:51 | 
2023-06-24 15:33:51.596576 (MainThread): 11:33:51 | Finished running 1 view model in 0.30s.
2023-06-24 15:33:51.596576 (MainThread): Connection 'master' was left open.
2023-06-24 15:33:51.596576 (MainThread): On master: Close
2023-06-24 15:33:51.596576 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:33:51.597076 (MainThread): On list_postgres: Close
2023-06-24 15:33:51.597076 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:33:51.597076 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:33:51.597076 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:33:51.597076 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:33:51.599575 (MainThread): 
2023-06-24 15:33:51.599575 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:33:51.599575 (MainThread): 
2023-06-24 15:33:51.599575 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:33:51.599575 (MainThread):   zero-length delimited identifier at or near """"
2023-06-24 15:33:51.599575 (MainThread):   LINE 8:     FROM ""postgres"."myschema"."extracted_data""
2023-06-24 15:33:51.599575 (MainThread):                    ^
2023-06-24 15:33:51.600076 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:33:51.600076 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:33:51.600076 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EB5006D8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EB500710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EB500780>]}
2023-06-24 15:33:51.600076 (MainThread): Flushing usage events
2023-06-24 15:36:34.394646 (MainThread): Running with dbt=0.16.0
2023-06-24 15:36:34.432649 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:36:34.433148 (MainThread): Tracking: tracking
2023-06-24 15:36:34.433649 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C822C9E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C82164F28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C82164CF8>]}
2023-06-24 15:36:34.445146 (MainThread): Partial parsing not enabled
2023-06-24 15:36:34.447147 (MainThread): Parsing macros\core.sql
2023-06-24 15:36:34.450646 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:36:34.482146 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:36:34.489146 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:36:34.489646 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:36:34.490646 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:36:34.492146 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:36:34.493646 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:36:34.495147 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:36:34.496146 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:36:34.501646 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:36:34.511147 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:36:34.512647 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:36:34.517146 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:36:34.532646 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:36:34.557146 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:36:34.558646 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:36:34.571147 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:36:34.576146 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:36:34.580146 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:36:34.584646 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:36:34.586146 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:36:34.587147 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:36:34.587647 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:36:34.589146 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:36:34.602146 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:36:34.603647 (MainThread): Parsing macros\relations.sql
2023-06-24 15:36:34.605146 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:36:34.618146 (MainThread): Partial parsing not enabled
2023-06-24 15:36:34.636646 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:36:34.636646 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:36:34.646646 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:36:34.647147 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:36:34.650146 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:36:34.650146 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:36:34.654146 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:36:34.654146 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:36:34.675647 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:36:34.675647 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:36:34.681646 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:36:34.681646 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:36:34.687647 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:36:34.687647 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:36:34.692147 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:36:34.692147 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:36:34.763146 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:36:34.841646 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:36:34.841646 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:36:34.842146 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:36:34.842146 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:36:34.842146 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:36:34.842146 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:36:34.842146 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:36:34.843647 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.844147 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.844646 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.846646 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.847646 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.848146 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.848646 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.849646 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.850147 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.850646 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.851647 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.852147 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.853146 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.854146 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.857147 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.860146 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.861646 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.862647 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.863647 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.864146 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.871646 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.875146 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:36:34.875146 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:36:34.876649 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.908647 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.909647 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.911647 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.928647 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.933148 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.933647 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.946146 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.948646 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.964147 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.965646 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.978647 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.997646 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:36:34.998646 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:36:35.001646 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:36:35.002146 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:36:35.004646 (MainThread): 
2023-06-24 15:36:35.005146 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:36:35.005146 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:36:35.008647 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:36:35.008647 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:36:35.063646 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:36:35.064146 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:36:35.096647 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:36:35.115647 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:36:35.115647 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:36:35.116647 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:36:35.116647 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:36:35.144147 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:36:35.144647 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:36:35.144647 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:36:35.147647 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:36:35.148146 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:36:35.167147 (MainThread): Using postgres connection "master".
2023-06-24 15:36:35.167646 (MainThread): On master: BEGIN
2023-06-24 15:36:35.194646 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:36:35.194646 (MainThread): Using postgres connection "master".
2023-06-24 15:36:35.195148 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:36:35.198646 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:36:35.199147 (MainThread): On master: ROLLBACK
2023-06-24 15:36:35.199147 (MainThread): Using postgres connection "master".
2023-06-24 15:36:35.199147 (MainThread): On master: BEGIN
2023-06-24 15:36:35.199647 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:36:35.199647 (MainThread): On master: COMMIT
2023-06-24 15:36:35.199647 (MainThread): Using postgres connection "master".
2023-06-24 15:36:35.199647 (MainThread): On master: COMMIT
2023-06-24 15:36:35.200147 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:36:35.200147 (MainThread): 11:36:35 | Concurrency: 1 threads (target='dev')
2023-06-24 15:36:35.200147 (MainThread): 11:36:35 | 
2023-06-24 15:36:35.201646 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:36:35.201646 (Thread-1): 11:36:35 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:36:35.201646 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:36:35.202146 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:36:35.202146 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:36:35.211147 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:36:35.211646 (Thread-1): finished collecting timing info
2023-06-24 15:36:35.232146 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:36:35.232146 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:36:35.260646 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:36:35.262646 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:36:35.262646 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:36:35.262646 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:36:35.263647 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:36:35.264146 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:36:35.264146 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:36:35.264648 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:36:35.264648 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:36:35.264648 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql

WITH filtered_data AS (
    SELECT *
    FROM ""postgres"."myschema"."extracted_data""
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data;
  );

2023-06-24 15:36:35.264648 (Thread-1): Postgres error: zero-length delimited identifier at or near """"
LINE 8:     FROM ""postgres"."myschema"."extracted_data""
                 ^

2023-06-24 15:36:35.264648 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:36:35.265147 (Thread-1): finished collecting timing info
2023-06-24 15:36:35.265147 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  zero-length delimited identifier at or near """"
  LINE 8:     FROM ""postgres"."myschema"."extracted_data""
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: zero-length delimited identifier at or near """"
LINE 8:     FROM ""postgres"."myschema"."extracted_data""
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  zero-length delimited identifier at or near """"
  LINE 8:     FROM ""postgres"."myschema"."extracted_data""
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:36:35.267147 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22f7b5a2-9d85-4794-a781-a88fce9e9354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C85E27CC0>]}
2023-06-24 15:36:35.267147 (Thread-1): 11:36:35 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.07s]
2023-06-24 15:36:35.267147 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:36:35.305404 (MainThread): Using postgres connection "master".
2023-06-24 15:36:35.305404 (MainThread): On master: BEGIN
2023-06-24 15:36:35.305898 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:36:35.305898 (MainThread): On master: COMMIT
2023-06-24 15:36:35.305898 (MainThread): Using postgres connection "master".
2023-06-24 15:36:35.305898 (MainThread): On master: COMMIT
2023-06-24 15:36:35.306396 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:36:35.306396 (MainThread): 11:36:35 | 
2023-06-24 15:36:35.306396 (MainThread): 11:36:35 | Finished running 1 view model in 0.30s.
2023-06-24 15:36:35.306396 (MainThread): Connection 'master' was left open.
2023-06-24 15:36:35.306396 (MainThread): On master: Close
2023-06-24 15:36:35.306896 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:36:35.306896 (MainThread): On list_postgres: Close
2023-06-24 15:36:35.306896 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:36:35.306896 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:36:35.306896 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:36:35.306896 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:36:35.309397 (MainThread): 
2023-06-24 15:36:35.309397 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:36:35.309397 (MainThread): 
2023-06-24 15:36:35.309397 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:36:35.309397 (MainThread):   zero-length delimited identifier at or near """"
2023-06-24 15:36:35.309397 (MainThread):   LINE 8:     FROM ""postgres"."myschema"."extracted_data""
2023-06-24 15:36:35.309896 (MainThread):                    ^
2023-06-24 15:36:35.309896 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:36:35.309896 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:36:35.309896 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C85EFF780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C85E08828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C85EFA6A0>]}
2023-06-24 15:36:35.309896 (MainThread): Flushing usage events
2023-06-24 15:37:08.375243 (MainThread): Running with dbt=0.16.0
2023-06-24 15:37:08.412743 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:37:08.413243 (MainThread): Tracking: tracking
2023-06-24 15:37:08.413744 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA932F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA93049B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA9304EF0>]}
2023-06-24 15:37:08.425243 (MainThread): Partial parsing not enabled
2023-06-24 15:37:08.427244 (MainThread): Parsing macros\core.sql
2023-06-24 15:37:08.430743 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:37:08.462243 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:37:08.469243 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:37:08.470244 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:37:08.470743 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:37:08.472244 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:37:08.474244 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:37:08.475243 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:37:08.476244 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:37:08.482243 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:37:08.491743 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:37:08.493244 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:37:08.497743 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:37:08.513243 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:37:08.538244 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:37:08.539744 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:37:08.552243 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:37:08.557743 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:37:08.561244 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:37:08.566243 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:37:08.567743 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:37:08.568243 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:37:08.569244 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:37:08.570744 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:37:08.583744 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:37:08.585245 (MainThread): Parsing macros\relations.sql
2023-06-24 15:37:08.586744 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:37:08.599243 (MainThread): Partial parsing not enabled
2023-06-24 15:37:08.618244 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:37:08.618244 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:08.628244 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:37:08.628244 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:08.631243 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:37:08.631243 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:08.634743 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:08.635243 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:08.656743 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:37:08.656743 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:08.662743 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:37:08.662743 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:08.668244 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:37:08.668244 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:08.673245 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:37:08.673245 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:08.744743 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:37:08.824744 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:08.824744 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:08.824744 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:08.824744 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:08.825243 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:08.825243 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:08.825243 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:08.826744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.827244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.827743 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.829744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.830744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.831244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.831743 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.832744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.833244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.833744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.834744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.835243 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.836244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.837243 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.839744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.843243 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.844244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.845744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.846744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.847244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.854744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.858243 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:08.858243 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:08.859744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.891244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.891744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.893744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.911244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.915244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.916244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.928743 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.931244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.946744 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.947743 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.961244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.978244 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:08.978743 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:37:08.981744 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:37:08.982244 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:37:08.984744 (MainThread): 
2023-06-24 15:37:08.984744 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:37:08.984744 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:08.988244 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:37:08.988744 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:37:09.044244 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:37:09.044244 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:37:09.074275 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:37:09.093276 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:37:09.093276 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:37:09.094275 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:37:09.094275 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:37:09.238816 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.14 seconds
2023-06-24 15:37:09.238816 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:37:09.238816 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:37:09.241814 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:37:09.242849 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:37:09.261814 (MainThread): Using postgres connection "master".
2023-06-24 15:37:09.261814 (MainThread): On master: BEGIN
2023-06-24 15:37:09.290815 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:37:09.290815 (MainThread): Using postgres connection "master".
2023-06-24 15:37:09.290815 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:37:09.294814 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:37:09.295313 (MainThread): On master: ROLLBACK
2023-06-24 15:37:09.295313 (MainThread): Using postgres connection "master".
2023-06-24 15:37:09.295313 (MainThread): On master: BEGIN
2023-06-24 15:37:09.295814 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:37:09.295814 (MainThread): On master: COMMIT
2023-06-24 15:37:09.295814 (MainThread): Using postgres connection "master".
2023-06-24 15:37:09.295814 (MainThread): On master: COMMIT
2023-06-24 15:37:09.295814 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:37:09.296314 (MainThread): 11:37:09 | Concurrency: 1 threads (target='dev')
2023-06-24 15:37:09.296314 (MainThread): 11:37:09 | 
2023-06-24 15:37:09.297814 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:37:09.297814 (Thread-1): 11:37:09 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:37:09.298314 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:09.298314 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:37:09.298314 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:37:09.307313 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:37:09.307813 (Thread-1): finished collecting timing info
2023-06-24 15:37:09.327813 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:09.327813 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:37:09.356814 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:37:09.358314 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:09.358314 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:37:09.358814 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:37:09.359314 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:37:09.360314 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:09.360314 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:37:09.360314 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:37:09.360314 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:09.360314 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql

WITH filtered_data AS (
    SELECT *
    FROM "postgres"."myschema"."extracted_data"
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data;
  );

2023-06-24 15:37:09.360814 (Thread-1): Postgres error: syntax error at or near ";"
LINE 13: FROM filtered_data;
                           ^

2023-06-24 15:37:09.360814 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:37:09.361314 (Thread-1): finished collecting timing info
2023-06-24 15:37:09.361314 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  syntax error at or near ";"
  LINE 13: FROM filtered_data;
                             ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 13: FROM filtered_data;
                           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  syntax error at or near ";"
  LINE 13: FROM filtered_data;
                             ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:37:09.362813 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '222394a6-db18-4c85-8eaa-972ecbfc0901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DACFD6D30>]}
2023-06-24 15:37:09.363313 (Thread-1): 11:37:09 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:37:09.363313 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:37:09.404224 (MainThread): Using postgres connection "master".
2023-06-24 15:37:09.404224 (MainThread): On master: BEGIN
2023-06-24 15:37:09.404753 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:37:09.404753 (MainThread): On master: COMMIT
2023-06-24 15:37:09.404753 (MainThread): Using postgres connection "master".
2023-06-24 15:37:09.404753 (MainThread): On master: COMMIT
2023-06-24 15:37:09.405253 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:37:09.405253 (MainThread): 11:37:09 | 
2023-06-24 15:37:09.405253 (MainThread): 11:37:09 | Finished running 1 view model in 0.42s.
2023-06-24 15:37:09.405253 (MainThread): Connection 'master' was left open.
2023-06-24 15:37:09.405723 (MainThread): On master: Close
2023-06-24 15:37:09.405723 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:37:09.405723 (MainThread): On list_postgres: Close
2023-06-24 15:37:09.405723 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:37:09.405723 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:37:09.405723 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:37:09.406223 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:37:09.408224 (MainThread): 
2023-06-24 15:37:09.408224 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:37:09.408224 (MainThread): 
2023-06-24 15:37:09.408224 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:37:09.408224 (MainThread):   syntax error at or near ";"
2023-06-24 15:37:09.408724 (MainThread):   LINE 13: FROM filtered_data;
2023-06-24 15:37:09.408724 (MainThread):                              ^
2023-06-24 15:37:09.408724 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:37:09.408724 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:37:09.408724 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAC6A0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAC17BA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAD09BB70>]}
2023-06-24 15:37:09.408724 (MainThread): Flushing usage events
2023-06-24 15:37:27.634348 (MainThread): Running with dbt=0.16.0
2023-06-24 15:37:27.672849 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:37:27.672849 (MainThread): Tracking: tracking
2023-06-24 15:37:27.673349 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA524F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA52249B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA5224EF0>]}
2023-06-24 15:37:27.684848 (MainThread): Partial parsing not enabled
2023-06-24 15:37:27.687348 (MainThread): Parsing macros\core.sql
2023-06-24 15:37:27.690848 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:37:27.722349 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:37:27.729350 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:37:27.729850 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:37:27.730850 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:37:27.732350 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:37:27.733850 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:37:27.735350 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:37:27.736350 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:37:27.742350 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:37:27.751850 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:37:27.753350 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:37:27.757849 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:37:27.773851 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:37:27.798350 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:37:27.799850 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:37:27.812350 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:37:27.817350 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:37:27.821350 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:37:27.825850 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:37:27.827851 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:37:27.828351 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:37:27.829350 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:37:27.830351 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:37:27.843351 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:37:27.845350 (MainThread): Parsing macros\relations.sql
2023-06-24 15:37:27.846351 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:37:27.859351 (MainThread): Partial parsing not enabled
2023-06-24 15:37:27.878351 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:37:27.878851 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:27.888351 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:37:27.888351 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:27.891851 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:37:27.891851 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:27.895351 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:27.895351 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:27.917350 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:37:27.917350 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:27.923350 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:37:27.923350 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:27.929351 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:37:27.929351 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:27.933851 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:37:27.933851 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:28.005849 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:37:28.085849 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:28.085849 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:28.085849 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:28.085849 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:28.085849 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:28.085849 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:28.085849 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:28.087349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.088349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.088848 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.090349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.091349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.092348 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.092848 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.093349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.094349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.094849 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.095849 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.096349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.097348 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.098349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.100849 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.104849 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.105849 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.106849 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.107848 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.108349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.116348 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.119849 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:28.119849 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:37:28.121348 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.154349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.154848 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.156849 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.174348 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.178849 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.179349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.192349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.194849 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.210848 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.211849 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.225349 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.242348 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:37:28.243349 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:37:28.246348 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:37:28.246849 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:37:28.248848 (MainThread): 
2023-06-24 15:37:28.249349 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:37:28.249349 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:37:28.252849 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:37:28.253348 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:37:28.308349 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:37:28.308849 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:37:28.338349 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:37:28.357348 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:37:28.357848 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:37:28.358347 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:37:28.358849 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:37:28.386849 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:37:28.386849 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:37:28.386849 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:37:28.389348 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:37:28.390347 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:37:28.409849 (MainThread): Using postgres connection "master".
2023-06-24 15:37:28.409849 (MainThread): On master: BEGIN
2023-06-24 15:37:28.442848 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:37:28.442848 (MainThread): Using postgres connection "master".
2023-06-24 15:37:28.442848 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:37:28.446849 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:37:28.447348 (MainThread): On master: ROLLBACK
2023-06-24 15:37:28.447348 (MainThread): Using postgres connection "master".
2023-06-24 15:37:28.447348 (MainThread): On master: BEGIN
2023-06-24 15:37:28.447848 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:37:28.447848 (MainThread): On master: COMMIT
2023-06-24 15:37:28.447848 (MainThread): Using postgres connection "master".
2023-06-24 15:37:28.447848 (MainThread): On master: COMMIT
2023-06-24 15:37:28.447848 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:37:28.448349 (MainThread): 11:37:28 | Concurrency: 1 threads (target='dev')
2023-06-24 15:37:28.448349 (MainThread): 11:37:28 | 
2023-06-24 15:37:28.449848 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:37:28.449848 (Thread-1): 11:37:28 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:37:28.450348 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:28.450348 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:37:28.450348 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:37:28.459347 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:37:28.459848 (Thread-1): finished collecting timing info
2023-06-24 15:37:28.479847 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:28.479847 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:37:28.508348 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:37:28.509848 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:28.509848 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:37:28.509848 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:37:28.510847 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:37:28.511347 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:28.511347 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:37:28.511849 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:37:28.511849 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:37:28.511849 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql

WITH filtered_data AS (
    SELECT *
    FROM "postgres"."myschema"."extracted_data"
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:37:28.512348 (Thread-1): Postgres error: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^

2023-06-24 15:37:28.512348 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:37:28.512348 (Thread-1): finished collecting timing info
2023-06-24 15:37:28.512848 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:37:28.514348 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feaa8621-6250-46a4-96c4-6a813c72de7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA85BE0F0>]}
2023-06-24 15:37:28.514348 (Thread-1): 11:37:28 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:37:28.514348 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:37:28.561358 (MainThread): Using postgres connection "master".
2023-06-24 15:37:28.561858 (MainThread): On master: BEGIN
2023-06-24 15:37:28.562866 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:37:28.563359 (MainThread): On master: COMMIT
2023-06-24 15:37:28.563859 (MainThread): Using postgres connection "master".
2023-06-24 15:37:28.563859 (MainThread): On master: COMMIT
2023-06-24 15:37:28.564866 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:37:28.565860 (MainThread): 11:37:28 | 
2023-06-24 15:37:28.566860 (MainThread): 11:37:28 | Finished running 1 view model in 0.32s.
2023-06-24 15:37:28.566860 (MainThread): Connection 'master' was left open.
2023-06-24 15:37:28.567359 (MainThread): On master: Close
2023-06-24 15:37:28.568359 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:37:28.568359 (MainThread): On list_postgres: Close
2023-06-24 15:37:28.569359 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:37:28.569858 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:37:28.570357 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:37:28.570859 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:37:28.575348 (MainThread): 
2023-06-24 15:37:28.575348 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:37:28.575348 (MainThread): 
2023-06-24 15:37:28.575849 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:37:28.575849 (MainThread):   relation "myschema.extracted_data" does not exist
2023-06-24 15:37:28.575849 (MainThread):   LINE 8:     FROM "postgres"."myschema"."extracted_data"
2023-06-24 15:37:28.575849 (MainThread):                    ^
2023-06-24 15:37:28.575849 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:37:28.575849 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:37:28.576349 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA8FBF208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA91A80F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA8EC8860>]}
2023-06-24 15:37:28.576349 (MainThread): Flushing usage events
2023-06-24 15:39:05.959521 (MainThread): Running with dbt=0.16.0
2023-06-24 15:39:06.001022 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:39:06.001022 (MainThread): Tracking: tracking
2023-06-24 15:39:06.001522 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21640F630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2163E4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2163E4DA0>]}
2023-06-24 15:39:06.013522 (MainThread): Partial parsing not enabled
2023-06-24 15:39:06.016021 (MainThread): Parsing macros\core.sql
2023-06-24 15:39:06.019021 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:39:06.050521 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:39:06.057521 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:39:06.058021 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:39:06.059021 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:39:06.060521 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:39:06.062020 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:39:06.063521 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:39:06.064521 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:39:06.070021 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:39:06.079522 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:39:06.081021 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:39:06.085521 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:39:06.101521 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:39:06.126021 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:39:06.127522 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:39:06.140021 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:39:06.145021 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:39:06.148521 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:39:06.153021 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:39:06.154521 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:39:06.155521 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:39:06.156522 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:39:06.157521 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:39:06.170521 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:39:06.172521 (MainThread): Parsing macros\relations.sql
2023-06-24 15:39:06.173521 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:39:06.186521 (MainThread): Partial parsing not enabled
2023-06-24 15:39:06.205520 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:39:06.205520 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:06.215521 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:39:06.215521 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:06.218520 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:39:06.218520 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:06.222521 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:06.222521 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:06.243521 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:39:06.244021 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:06.250020 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:39:06.250020 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:06.256021 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:39:06.256021 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:06.260522 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:39:06.261022 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:06.333022 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:39:06.412521 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:06.412521 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:06.412521 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:06.412521 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:06.412521 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:06.412521 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:06.412521 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:06.414021 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.414521 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.415522 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.417021 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.418021 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.418521 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.419522 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.420021 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.420521 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.421522 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.422522 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.423022 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.424021 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.425021 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.428021 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.431522 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.432522 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.434022 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.434521 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.435521 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.443021 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.446521 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:06.446521 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:06.448021 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.481521 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.482522 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.484521 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.501521 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.506021 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.506521 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.519521 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.522021 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.537522 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.538522 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.552523 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.569520 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:06.570521 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:39:06.573521 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:39:06.574021 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:39:06.576021 (MainThread): 
2023-06-24 15:39:06.576521 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:39:06.576521 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:06.580021 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:39:06.580021 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:39:06.635521 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:39:06.635521 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:39:06.665633 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:39:06.684236 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:39:06.684736 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:39:06.685735 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:39:06.685735 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:39:06.716736 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:39:06.716736 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:39:06.716736 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:39:06.719736 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:39:06.720235 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:39:06.739736 (MainThread): Using postgres connection "master".
2023-06-24 15:39:06.739736 (MainThread): On master: BEGIN
2023-06-24 15:39:06.767736 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:39:06.768236 (MainThread): Using postgres connection "master".
2023-06-24 15:39:06.768236 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:39:06.771736 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:39:06.772238 (MainThread): On master: ROLLBACK
2023-06-24 15:39:06.772737 (MainThread): Using postgres connection "master".
2023-06-24 15:39:06.772737 (MainThread): On master: BEGIN
2023-06-24 15:39:06.772737 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:39:06.773236 (MainThread): On master: COMMIT
2023-06-24 15:39:06.773236 (MainThread): Using postgres connection "master".
2023-06-24 15:39:06.773236 (MainThread): On master: COMMIT
2023-06-24 15:39:06.773236 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:39:06.773236 (MainThread): 11:39:06 | Concurrency: 1 threads (target='dev')
2023-06-24 15:39:06.773736 (MainThread): 11:39:06 | 
2023-06-24 15:39:06.775236 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:39:06.775236 (Thread-1): 11:39:06 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:39:06.775236 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:06.775736 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:39:06.775736 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:39:06.784735 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:39:06.785236 (Thread-1): finished collecting timing info
2023-06-24 15:39:06.805235 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:06.805235 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:39:06.835236 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:39:06.836735 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:06.836735 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:39:06.837236 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:39:06.837736 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:39:06.838736 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:06.838736 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:39:06.838736 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:39:06.838736 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:06.838736 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql

WITH filtered_data AS (
    SELECT *
    FROM "postgres"."myschema"."extracted_data"
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:39:06.839236 (Thread-1): Postgres error: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^

2023-06-24 15:39:06.839236 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:39:06.839736 (Thread-1): finished collecting timing info
2023-06-24 15:39:06.839736 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:39:06.841235 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9764410f-10c5-4b38-bc8d-3d0377a9834f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21A0A8978>]}
2023-06-24 15:39:06.841735 (Thread-1): 11:39:06 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.07s]
2023-06-24 15:39:06.841735 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:39:06.880736 (MainThread): Using postgres connection "master".
2023-06-24 15:39:06.880736 (MainThread): On master: BEGIN
2023-06-24 15:39:06.880736 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:39:06.881236 (MainThread): On master: COMMIT
2023-06-24 15:39:06.881236 (MainThread): Using postgres connection "master".
2023-06-24 15:39:06.881236 (MainThread): On master: COMMIT
2023-06-24 15:39:06.881236 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:39:06.881736 (MainThread): 11:39:06 | 
2023-06-24 15:39:06.881736 (MainThread): 11:39:06 | Finished running 1 view model in 0.30s.
2023-06-24 15:39:06.881736 (MainThread): Connection 'master' was left open.
2023-06-24 15:39:06.881736 (MainThread): On master: Close
2023-06-24 15:39:06.881736 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:39:06.881736 (MainThread): On list_postgres: Close
2023-06-24 15:39:06.882236 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:39:06.882236 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:39:06.882236 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:39:06.882236 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:39:06.884736 (MainThread): 
2023-06-24 15:39:06.884736 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:39:06.884736 (MainThread): 
2023-06-24 15:39:06.884736 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:39:06.884736 (MainThread):   relation "myschema.extracted_data" does not exist
2023-06-24 15:39:06.884736 (MainThread):   LINE 8:     FROM "postgres"."myschema"."extracted_data"
2023-06-24 15:39:06.885236 (MainThread):                    ^
2023-06-24 15:39:06.885236 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:39:06.885236 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:39:06.885236 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21A08A908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21A180860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21A180898>]}
2023-06-24 15:39:06.885236 (MainThread): Flushing usage events
2023-06-24 15:39:48.972953 (MainThread): Running with dbt=0.16.0
2023-06-24 15:39:49.010954 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:39:49.011454 (MainThread): Tracking: tracking
2023-06-24 15:39:49.011953 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274FA69FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274F904DD8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274F9049E8>]}
2023-06-24 15:39:49.023454 (MainThread): Partial parsing not enabled
2023-06-24 15:39:49.025954 (MainThread): Parsing macros\core.sql
2023-06-24 15:39:49.029454 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:39:49.060953 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:39:49.067954 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:39:49.068453 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:39:49.069453 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:39:49.070954 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:39:49.072453 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:39:49.073953 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:39:49.074953 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:39:49.080954 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:39:49.090954 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:39:49.092454 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:39:49.096953 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:39:49.112454 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:39:49.137454 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:39:49.138453 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:39:49.151453 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:39:49.156454 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:39:49.159954 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:39:49.164455 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:39:49.166454 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:39:49.166954 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:39:49.167954 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:39:49.168954 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:39:49.181953 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:39:49.183954 (MainThread): Parsing macros\relations.sql
2023-06-24 15:39:49.184953 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:39:49.197954 (MainThread): Partial parsing not enabled
2023-06-24 15:39:49.216953 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:39:49.216953 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:49.227454 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:39:49.227454 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:49.230954 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:39:49.230954 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:49.233955 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:49.233955 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:49.255453 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:39:49.255453 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:49.261954 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:39:49.261954 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:49.267453 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:39:49.267453 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:49.272453 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:39:49.272453 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:49.344453 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:39:49.424453 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:49.424453 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:49.424453 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:49.424453 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:49.424453 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:49.424453 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:49.424453 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:49.425955 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.426455 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.427454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.428954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.429953 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.430454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.431454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.431954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.432453 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.433454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.434454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.434954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.435954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.436954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.439454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.442954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.443954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.445454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.446454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.446954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.454954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.457953 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:49.458453 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:39:49.459954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.492454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.493454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.495455 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.512954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.516954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.517453 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.530453 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.532954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.549454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.550454 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.563954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.580954 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:39:49.581953 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:39:49.584453 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:39:49.584953 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:39:49.587454 (MainThread): 
2023-06-24 15:39:49.587454 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:39:49.587454 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:39:49.591453 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:39:49.591453 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:39:49.648453 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:39:49.648453 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:39:49.678453 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:39:49.696955 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:39:49.696955 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:39:49.697953 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:39:49.697953 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:39:49.724955 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:39:49.725454 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:39:49.725454 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:39:49.727953 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:39:49.728954 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:39:49.747953 (MainThread): Using postgres connection "master".
2023-06-24 15:39:49.747953 (MainThread): On master: BEGIN
2023-06-24 15:39:49.775954 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:39:49.775954 (MainThread): Using postgres connection "master".
2023-06-24 15:39:49.775954 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:39:49.779454 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:39:49.779955 (MainThread): On master: ROLLBACK
2023-06-24 15:39:49.780454 (MainThread): Using postgres connection "master".
2023-06-24 15:39:49.780454 (MainThread): On master: BEGIN
2023-06-24 15:39:49.780454 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:39:49.780454 (MainThread): On master: COMMIT
2023-06-24 15:39:49.780454 (MainThread): Using postgres connection "master".
2023-06-24 15:39:49.780953 (MainThread): On master: COMMIT
2023-06-24 15:39:49.780953 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:39:49.780953 (MainThread): 11:39:49 | Concurrency: 1 threads (target='dev')
2023-06-24 15:39:49.780953 (MainThread): 11:39:49 | 
2023-06-24 15:39:49.782454 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:39:49.782454 (Thread-1): 11:39:49 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:39:49.782955 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:49.782955 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:39:49.782955 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:39:49.791955 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:39:49.792954 (Thread-1): finished collecting timing info
2023-06-24 15:39:49.812954 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:49.812954 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:39:49.844359 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:39:49.845889 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:49.846388 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:39:49.846388 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:39:49.847390 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:39:49.847887 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:49.847887 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:39:49.848392 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:39:49.848392 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:39:49.848392 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql

WITH filtered_data AS (
    SELECT *
    FROM "postgres"."myschema"."extracted_data"
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:39:49.848924 (Thread-1): Postgres error: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^

2023-06-24 15:39:49.848924 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:39:49.848924 (Thread-1): finished collecting timing info
2023-06-24 15:39:49.849399 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:39:49.850859 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f8569a-c1f4-4029-a5c6-c17ffe1dee2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227535CAB00>]}
2023-06-24 15:39:49.850859 (Thread-1): 11:39:49 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.07s]
2023-06-24 15:39:49.851388 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:39:49.885230 (MainThread): Using postgres connection "master".
2023-06-24 15:39:49.885716 (MainThread): On master: BEGIN
2023-06-24 15:39:49.886718 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:39:49.887215 (MainThread): On master: COMMIT
2023-06-24 15:39:49.887215 (MainThread): Using postgres connection "master".
2023-06-24 15:39:49.887715 (MainThread): On master: COMMIT
2023-06-24 15:39:49.888729 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:39:49.889714 (MainThread): 11:39:49 | 
2023-06-24 15:39:49.890215 (MainThread): 11:39:49 | Finished running 1 view model in 0.30s.
2023-06-24 15:39:49.890715 (MainThread): Connection 'master' was left open.
2023-06-24 15:39:49.890715 (MainThread): On master: Close
2023-06-24 15:39:49.891709 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:39:49.892210 (MainThread): On list_postgres: Close
2023-06-24 15:39:49.892709 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:39:49.893210 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:39:49.893667 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:39:49.894208 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:39:49.900657 (MainThread): 
2023-06-24 15:39:49.900657 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:39:49.900657 (MainThread): 
2023-06-24 15:39:49.900657 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:39:49.900657 (MainThread):   relation "myschema.extracted_data" does not exist
2023-06-24 15:39:49.900657 (MainThread):   LINE 8:     FROM "postgres"."myschema"."extracted_data"
2023-06-24 15:39:49.901157 (MainThread):                    ^
2023-06-24 15:39:49.901157 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:39:49.901157 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:39:49.901157 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227535AC7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002275369E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002275369E668>]}
2023-06-24 15:39:49.901157 (MainThread): Flushing usage events
2023-06-24 15:40:05.142581 (MainThread): Running with dbt=0.16.0
2023-06-24 15:40:05.180081 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:40:05.180580 (MainThread): Tracking: tracking
2023-06-24 15:40:05.181081 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B4AFD9F28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B4AE74F28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B4AE74CF8>]}
2023-06-24 15:40:05.193081 (MainThread): Partial parsing not enabled
2023-06-24 15:40:05.195582 (MainThread): Parsing macros\core.sql
2023-06-24 15:40:05.199082 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:40:05.230581 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:40:05.237581 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:40:05.238080 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:40:05.239081 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:40:05.240581 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:40:05.242081 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:40:05.243580 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:40:05.244581 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:40:05.250081 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:40:05.259581 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:40:05.261080 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:40:05.265580 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:40:05.281580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:40:05.306081 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:40:05.307581 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:40:05.320081 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:40:05.325080 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:40:05.329080 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:40:05.333580 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:40:05.335082 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:40:05.336081 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:40:05.337080 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:40:05.338081 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:40:05.351082 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:40:05.352580 (MainThread): Parsing macros\relations.sql
2023-06-24 15:40:05.354081 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:40:05.366581 (MainThread): Partial parsing not enabled
2023-06-24 15:40:05.386080 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:40:05.386080 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:05.396080 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:40:05.396580 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:05.400081 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:40:05.400081 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:05.403082 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:05.403082 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:05.425081 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:40:05.425580 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:05.431581 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:40:05.432081 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:05.438581 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:40:05.438581 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:05.443082 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:40:05.443082 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:05.515081 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:40:05.594080 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:05.594080 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:05.594080 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:05.594080 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:05.594080 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:05.594080 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:05.594080 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:05.595581 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.596080 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.597081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.598580 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.599581 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.600080 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.601082 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.601581 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.602080 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.602581 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.603581 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.604081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.605081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.606080 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.608580 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.612081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.613081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.614581 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.615581 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.616081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.623580 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.626580 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:05.627081 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:05.628080 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.661081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.662082 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.664081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.681081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.685081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.686081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.698581 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.701081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.716581 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.717580 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.731081 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.747580 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:05.748580 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:40:05.751580 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:40:05.752081 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:40:05.754080 (MainThread): 
2023-06-24 15:40:05.754580 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:40:05.754580 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:05.758082 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:40:05.758082 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:40:05.814581 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:40:05.814581 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:40:05.845111 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:40:05.863621 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:40:05.863621 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:40:05.864613 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:40:05.864613 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:40:05.892580 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:40:05.892580 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:40:05.892580 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:40:05.895581 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:40:05.896581 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:40:05.915080 (MainThread): Using postgres connection "master".
2023-06-24 15:40:05.915580 (MainThread): On master: BEGIN
2023-06-24 15:40:05.943132 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:40:05.943132 (MainThread): Using postgres connection "master".
2023-06-24 15:40:05.943132 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:40:05.947128 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:40:05.947610 (MainThread): On master: ROLLBACK
2023-06-24 15:40:05.947610 (MainThread): Using postgres connection "master".
2023-06-24 15:40:05.947610 (MainThread): On master: BEGIN
2023-06-24 15:40:05.948081 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:40:05.948081 (MainThread): On master: COMMIT
2023-06-24 15:40:05.948081 (MainThread): Using postgres connection "master".
2023-06-24 15:40:05.948081 (MainThread): On master: COMMIT
2023-06-24 15:40:05.948580 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:40:05.948580 (MainThread): 11:40:05 | Concurrency: 1 threads (target='dev')
2023-06-24 15:40:05.948580 (MainThread): 11:40:05 | 
2023-06-24 15:40:05.950110 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:40:05.950110 (Thread-1): 11:40:05 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:40:05.950611 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:05.950611 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:40:05.950611 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:40:05.959581 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:40:05.960081 (Thread-1): finished collecting timing info
2023-06-24 15:40:05.980581 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:05.980581 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:40:06.016634 (Thread-1): SQL status: DROP VIEW in 0.04 seconds
2023-06-24 15:40:06.018113 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:06.018113 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:40:06.018610 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:40:06.019582 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:40:06.020081 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:06.020081 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:40:06.020081 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:40:06.020581 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:06.020581 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql

WITH filtered_data AS (
    SELECT *
    FROM "postgres"."myschema"."extracted_data"
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:40:06.020581 (Thread-1): Postgres error: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^

2023-06-24 15:40:06.020581 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:40:06.021081 (Thread-1): finished collecting timing info
2023-06-24 15:40:06.021081 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:40:06.023080 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48463cb-e50f-47c7-aab8-02f535a5f54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B4EB423C8>]}
2023-06-24 15:40:06.023080 (Thread-1): 11:40:06 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.07s]
2023-06-24 15:40:06.023080 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:40:06.050582 (MainThread): Using postgres connection "master".
2023-06-24 15:40:06.050582 (MainThread): On master: BEGIN
2023-06-24 15:40:06.050582 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:40:06.050582 (MainThread): On master: COMMIT
2023-06-24 15:40:06.050582 (MainThread): Using postgres connection "master".
2023-06-24 15:40:06.051080 (MainThread): On master: COMMIT
2023-06-24 15:40:06.051080 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:40:06.051080 (MainThread): 11:40:06 | 
2023-06-24 15:40:06.051080 (MainThread): 11:40:06 | Finished running 1 view model in 0.30s.
2023-06-24 15:40:06.051580 (MainThread): Connection 'master' was left open.
2023-06-24 15:40:06.051580 (MainThread): On master: Close
2023-06-24 15:40:06.051580 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:40:06.051580 (MainThread): On list_postgres: Close
2023-06-24 15:40:06.051580 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:40:06.051580 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:40:06.052081 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:40:06.052081 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:40:06.054081 (MainThread): 
2023-06-24 15:40:06.054081 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:40:06.054081 (MainThread): 
2023-06-24 15:40:06.054581 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:40:06.054581 (MainThread):   relation "myschema.extracted_data" does not exist
2023-06-24 15:40:06.054581 (MainThread):   LINE 8:     FROM "postgres"."myschema"."extracted_data"
2023-06-24 15:40:06.054581 (MainThread):                    ^
2023-06-24 15:40:06.054581 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:40:06.054581 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:40:06.054581 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B4EB1D8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B4EC0C7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B4EC0C710>]}
2023-06-24 15:40:06.055082 (MainThread): Flushing usage events
2023-06-24 15:40:46.613965 (MainThread): Running with dbt=0.16.0
2023-06-24 15:40:46.651465 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:40:46.651965 (MainThread): Tracking: tracking
2023-06-24 15:40:46.652465 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C8B6AEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C8A04E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C8A040F0>]}
2023-06-24 15:40:46.665967 (MainThread): Partial parsing not enabled
2023-06-24 15:40:46.670466 (MainThread): Parsing macros\core.sql
2023-06-24 15:40:46.676495 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:40:46.708965 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:40:46.716966 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:40:46.717965 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:40:46.718966 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:40:46.720465 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:40:46.721965 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:40:46.723465 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:40:46.724466 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:40:46.730466 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:40:46.739966 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:40:46.741465 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:40:46.746466 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:40:46.762466 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:40:46.787966 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:40:46.788965 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:40:46.801966 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:40:46.807465 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:40:46.811468 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:40:46.816467 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:40:46.817965 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:40:46.818466 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:40:46.819467 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:40:46.820966 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:40:46.834467 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:40:46.836466 (MainThread): Parsing macros\relations.sql
2023-06-24 15:40:46.837495 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:40:46.849995 (MainThread): Partial parsing not enabled
2023-06-24 15:40:46.869466 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:40:46.869966 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:46.880495 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:40:46.880495 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:46.884466 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:40:46.884466 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:46.887466 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:46.887466 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:46.908966 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:40:46.908966 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:46.914966 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:40:46.915466 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:46.920966 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:40:46.920966 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:46.925966 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:40:46.925966 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:46.996966 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dev
- models.extracted_data

2023-06-24 15:40:47.078466 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:47.078466 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:47.078466 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:47.078965 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:47.078965 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:47.078965 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:47.078965 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:47.080465 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.080965 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.081466 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.083465 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.084465 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.084965 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.085466 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.086466 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.086965 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.087465 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.088466 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.088965 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.089966 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.090965 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.093465 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.096965 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.098466 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.099466 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.100465 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.100965 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.108966 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.112466 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:47.112466 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:40:47.113967 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.148966 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.149465 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.151465 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.169466 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.174466 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.174965 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.187965 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.190466 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.206466 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.207966 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.220966 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.238966 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:40:47.239965 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:40:47.242965 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:40:47.243466 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:40:47.245965 (MainThread): 
2023-06-24 15:40:47.245965 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:40:47.245965 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:40:47.249465 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:40:47.249965 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:40:47.306466 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:40:47.306466 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:40:47.336965 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:40:47.355465 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:40:47.355465 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:40:47.356466 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:40:47.356466 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:40:47.384965 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:40:47.384965 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:40:47.384965 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:40:47.387965 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:40:47.388965 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:40:47.407465 (MainThread): Using postgres connection "master".
2023-06-24 15:40:47.407965 (MainThread): On master: BEGIN
2023-06-24 15:40:47.435465 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:40:47.435465 (MainThread): Using postgres connection "master".
2023-06-24 15:40:47.435465 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:40:47.438965 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:40:47.439965 (MainThread): On master: ROLLBACK
2023-06-24 15:40:47.439965 (MainThread): Using postgres connection "master".
2023-06-24 15:40:47.439965 (MainThread): On master: BEGIN
2023-06-24 15:40:47.439965 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:40:47.440465 (MainThread): On master: COMMIT
2023-06-24 15:40:47.440465 (MainThread): Using postgres connection "master".
2023-06-24 15:40:47.440465 (MainThread): On master: COMMIT
2023-06-24 15:40:47.440465 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:40:47.440465 (MainThread): 11:40:47 | Concurrency: 1 threads (target='dev')
2023-06-24 15:40:47.440965 (MainThread): 11:40:47 | 
2023-06-24 15:40:47.442466 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:40:47.442466 (Thread-1): 11:40:47 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:40:47.442466 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:47.442466 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:40:47.442466 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:40:47.451465 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:40:47.452465 (Thread-1): finished collecting timing info
2023-06-24 15:40:47.472465 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:47.472965 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:40:47.500465 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:40:47.501966 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:47.502465 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:40:47.502465 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:40:47.503465 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:40:47.503966 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:47.503966 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:40:47.503966 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:40:47.504466 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:40:47.504466 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql

WITH filtered_data AS (
    SELECT *
    FROM "postgres"."myschema"."extracted_data"
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:40:47.504466 (Thread-1): Postgres error: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^

2023-06-24 15:40:47.504466 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:40:47.504965 (Thread-1): finished collecting timing info
2023-06-24 15:40:47.504965 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:40:47.506965 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfb593e-5dfb-4027-83b0-8383abf2fcac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CC6CBC18>]}
2023-06-24 15:40:47.506965 (Thread-1): 11:40:47 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:40:47.506965 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:40:47.547967 (MainThread): Using postgres connection "master".
2023-06-24 15:40:47.547967 (MainThread): On master: BEGIN
2023-06-24 15:40:47.547967 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:40:47.547967 (MainThread): On master: COMMIT
2023-06-24 15:40:47.548465 (MainThread): Using postgres connection "master".
2023-06-24 15:40:47.548465 (MainThread): On master: COMMIT
2023-06-24 15:40:47.548465 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:40:47.548465 (MainThread): 11:40:47 | 
2023-06-24 15:40:47.548965 (MainThread): 11:40:47 | Finished running 1 view model in 0.30s.
2023-06-24 15:40:47.548965 (MainThread): Connection 'master' was left open.
2023-06-24 15:40:47.548965 (MainThread): On master: Close
2023-06-24 15:40:47.548965 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:40:47.548965 (MainThread): On list_postgres: Close
2023-06-24 15:40:47.548965 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:40:47.548965 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:40:47.549466 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:40:47.549466 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:40:47.551966 (MainThread): 
2023-06-24 15:40:47.551966 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:40:47.551966 (MainThread): 
2023-06-24 15:40:47.551966 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:40:47.551966 (MainThread):   relation "myschema.extracted_data" does not exist
2023-06-24 15:40:47.551966 (MainThread):   LINE 8:     FROM "postgres"."myschema"."extracted_data"
2023-06-24 15:40:47.551966 (MainThread):                    ^
2023-06-24 15:40:47.552467 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:40:47.552467 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:40:47.552467 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CC79E898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CC6AC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CC79C5F8>]}
2023-06-24 15:40:47.552467 (MainThread): Flushing usage events
2023-06-24 15:41:29.547412 (MainThread): Running with dbt=0.16.0
2023-06-24 15:41:29.584412 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:41:29.584912 (MainThread): Tracking: tracking
2023-06-24 15:41:29.585412 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BAB43AF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BAB2F79E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BAB2D4DD8>]}
2023-06-24 15:41:29.596912 (MainThread): Partial parsing not enabled
2023-06-24 15:41:29.598912 (MainThread): Parsing macros\core.sql
2023-06-24 15:41:29.602412 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:41:29.633412 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:41:29.640412 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:41:29.641412 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:41:29.641912 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:41:29.643412 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:41:29.645412 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:41:29.646412 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:41:29.647412 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:41:29.653412 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:41:29.662912 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:41:29.664412 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:41:29.668912 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:41:29.684413 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:41:29.708912 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:41:29.710412 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:41:29.722412 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:41:29.727913 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:41:29.731412 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:41:29.735912 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:41:29.737412 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:41:29.738412 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:41:29.739412 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:41:29.740412 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:41:29.753412 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:41:29.754912 (MainThread): Parsing macros\relations.sql
2023-06-24 15:41:29.755912 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:41:29.768912 (MainThread): Partial parsing not enabled
2023-06-24 15:41:29.787912 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:41:29.787912 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:29.797912 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:41:29.797912 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:29.801412 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:41:29.801912 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:29.804412 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:41:29.804412 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:29.825912 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:41:29.826412 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:29.831912 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:41:29.832412 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:29.837912 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:41:29.837912 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:29.842412 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:41:29.842412 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:29.912912 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.transformation
- models.extracted_data

2023-06-24 15:41:29.992412 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:29.992412 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:29.992412 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:29.992412 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:29.992412 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:29.992412 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:29.992912 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:29.993912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:29.994912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:29.995412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:29.996912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:29.997912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:29.998912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:29.999412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:29.999912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.000412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.001412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.002412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.002912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.003912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.004912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.007412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.010912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.011912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.013412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.013912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.014912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.022414 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.025412 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:30.025912 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:30.026912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.058913 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.059412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.061412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.078412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.082912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.083412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.095912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.098412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.113912 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.115414 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.128412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.145412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:41:30.146413 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:41:30.149412 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:41:30.149412 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:41:30.151912 (MainThread): 
2023-06-24 15:41:30.152412 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:41:30.152412 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:30.155912 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:41:30.155912 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:41:30.210912 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:41:30.210912 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:41:30.241412 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:41:30.260412 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:41:30.260412 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:41:30.261412 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:41:30.261412 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:41:30.292412 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:41:30.292412 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:41:30.292912 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:41:30.295412 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:41:30.296412 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:41:30.315412 (MainThread): Using postgres connection "master".
2023-06-24 15:41:30.315412 (MainThread): On master: BEGIN
2023-06-24 15:41:30.344412 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:41:30.344412 (MainThread): Using postgres connection "master".
2023-06-24 15:41:30.344912 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:41:30.348412 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:41:30.348912 (MainThread): On master: ROLLBACK
2023-06-24 15:41:30.348912 (MainThread): Using postgres connection "master".
2023-06-24 15:41:30.349412 (MainThread): On master: BEGIN
2023-06-24 15:41:30.349412 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:41:30.349412 (MainThread): On master: COMMIT
2023-06-24 15:41:30.349412 (MainThread): Using postgres connection "master".
2023-06-24 15:41:30.349412 (MainThread): On master: COMMIT
2023-06-24 15:41:30.349912 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:41:30.349912 (MainThread): 11:41:30 | Concurrency: 1 threads (target='dev')
2023-06-24 15:41:30.349912 (MainThread): 11:41:30 | 
2023-06-24 15:41:30.351413 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:41:30.351413 (Thread-1): 11:41:30 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:41:30.351912 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:41:30.351912 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:41:30.351912 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:41:30.360912 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:41:30.361412 (Thread-1): finished collecting timing info
2023-06-24 15:41:30.381412 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:41:30.381412 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:41:30.409492 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:41:30.410957 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:41:30.410957 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:41:30.411457 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:41:30.411957 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:41:30.412457 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:41:30.412958 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:41:30.412958 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:41:30.412958 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:41:30.412958 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql

WITH filtered_data AS (
    SELECT *
    FROM "postgres"."myschema"."extracted_data"
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:41:30.413457 (Thread-1): Postgres error: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^

2023-06-24 15:41:30.413457 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:41:30.413957 (Thread-1): finished collecting timing info
2023-06-24 15:41:30.413957 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:41:30.415457 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2c84231-645f-49ac-925b-c456e1682c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BAEF9AB38>]}
2023-06-24 15:41:30.415957 (Thread-1): 11:41:30 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 15:41:30.415957 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:41:30.455329 (MainThread): Using postgres connection "master".
2023-06-24 15:41:30.455329 (MainThread): On master: BEGIN
2023-06-24 15:41:30.455830 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:41:30.455830 (MainThread): On master: COMMIT
2023-06-24 15:41:30.455830 (MainThread): Using postgres connection "master".
2023-06-24 15:41:30.455830 (MainThread): On master: COMMIT
2023-06-24 15:41:30.456358 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:41:30.456358 (MainThread): 11:41:30 | 
2023-06-24 15:41:30.456358 (MainThread): 11:41:30 | Finished running 1 view model in 0.30s.
2023-06-24 15:41:30.456358 (MainThread): Connection 'master' was left open.
2023-06-24 15:41:30.456358 (MainThread): On master: Close
2023-06-24 15:41:30.456859 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:41:30.456859 (MainThread): On list_postgres: Close
2023-06-24 15:41:30.456859 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:41:30.456859 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:41:30.456859 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:41:30.456859 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:41:30.459329 (MainThread): 
2023-06-24 15:41:30.459329 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:41:30.459329 (MainThread): 
2023-06-24 15:41:30.459329 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:41:30.459329 (MainThread):   relation "myschema.extracted_data" does not exist
2023-06-24 15:41:30.459329 (MainThread):   LINE 8:     FROM "postgres"."myschema"."extracted_data"
2023-06-24 15:41:30.459829 (MainThread):                    ^
2023-06-24 15:41:30.459829 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:41:30.459829 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:41:30.459829 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BAF06B668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BAEF7E898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BAF070CC0>]}
2023-06-24 15:41:30.459829 (MainThread): Flushing usage events
2023-06-24 15:41:41.757124 (MainThread): Running with dbt=0.16.0
2023-06-24 15:41:41.794624 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:41:41.795124 (MainThread): Tracking: tracking
2023-06-24 15:41:41.795624 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E54CB2E908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E54CA5A668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E54CA6FF28>]}
2023-06-24 15:41:41.807125 (MainThread): Partial parsing not enabled
2023-06-24 15:41:41.809624 (MainThread): Parsing macros\core.sql
2023-06-24 15:41:41.813124 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:41:41.844124 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:41:41.850624 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:41:41.851624 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:41:41.852124 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:41:41.853625 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:41:41.855124 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:41:41.856624 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:41:41.857624 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:41:41.863124 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:41:41.872624 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:41:41.874124 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:41:41.878624 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:41:41.894124 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:41:41.918624 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:41:41.920124 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:41:41.932624 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:41:41.937624 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:41:41.941124 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:41:41.945625 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:41:41.947124 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:41:41.948124 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:41:41.949124 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:41:41.950124 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:41:41.963124 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:41:41.965124 (MainThread): Parsing macros\relations.sql
2023-06-24 15:41:41.966124 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:41:41.978624 (MainThread): Partial parsing not enabled
2023-06-24 15:41:41.997124 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:41:41.997124 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:42.007124 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:41:42.007624 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:42.011124 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:41:42.011124 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:42.014124 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:41:42.014124 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:42.035124 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:41:42.035124 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:42.041124 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:41:42.041124 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:42.047624 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:41:42.047624 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:42.062124 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:41:42.062124 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:42.133124 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.transformation
- models.extracted_data

2023-06-24 15:41:42.270125 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:42.270125 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:42.270624 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:42.270624 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:42.270624 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:42.270624 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:42.270624 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:42.301624 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:42.301624 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:41:42.423125 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:41:42.425624 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:41:42.426125 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:41:42.428657 (MainThread): 
2023-06-24 15:41:42.429162 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:41:42.429162 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:41:42.439125 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:41:42.439125 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:41:42.494624 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:41:42.494624 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:41:42.525154 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:41:42.543654 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:41:42.544154 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:41:42.545154 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:41:42.545154 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:41:42.573648 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:41:42.573648 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:41:42.573648 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:41:42.576154 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:41:42.577124 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:41:42.596624 (MainThread): Using postgres connection "master".
2023-06-24 15:41:42.596624 (MainThread): On master: BEGIN
2023-06-24 15:41:42.624654 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:41:42.624654 (MainThread): Using postgres connection "master".
2023-06-24 15:41:42.624654 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:41:42.628154 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2023-06-24 15:41:42.628657 (MainThread): On master: ROLLBACK
2023-06-24 15:41:42.629160 (MainThread): Using postgres connection "master".
2023-06-24 15:41:42.629160 (MainThread): On master: BEGIN
2023-06-24 15:41:42.629659 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:41:42.629659 (MainThread): On master: COMMIT
2023-06-24 15:41:42.629659 (MainThread): Using postgres connection "master".
2023-06-24 15:41:42.629659 (MainThread): On master: COMMIT
2023-06-24 15:41:42.629659 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:41:42.630158 (MainThread): 11:41:42 | Concurrency: 1 threads (target='dev')
2023-06-24 15:41:42.630158 (MainThread): 11:41:42 | 
2023-06-24 15:41:42.631664 (Thread-1): Began running node model.my_new_project.extracted_data
2023-06-24 15:41:42.632156 (Thread-1): 11:41:42 | 1 of 4 START view model myschema.extracted_data...................... [RUN]
2023-06-24 15:41:42.632156 (Thread-1): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:41:42.632156 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:41:42.632655 (Thread-1): Compiling model.my_new_project.extracted_data
2023-06-24 15:41:42.640624 (Thread-1): Writing injected SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:41:42.641124 (Thread-1): finished collecting timing info
2023-06-24 15:41:42.661124 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:41:42.661124 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_tmp" cascade
2023-06-24 15:41:42.689160 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:41:42.691165 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:41:42.691165 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_backup" cascade
2023-06-24 15:41:42.691165 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:41:42.692154 (Thread-1): Writing runtime SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:41:42.693125 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:41:42.693125 (Thread-1): On model.my_new_project.extracted_data: BEGIN
2023-06-24 15:41:42.693125 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:41:42.693125 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:41:42.693125 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */

  create view "postgres"."myschema"."extracted_data__dbt_tmp" as (
    -- models/extract/extracted_data.sql
-- Your extraction logic goes here
-- Example:
SELECT *
FROM myschema.transformed_addresses;
  );

2023-06-24 15:41:42.693624 (Thread-1): Postgres error: syntax error at or near ";"
LINE 8: FROM myschema.transformed_addresses;
                                           ^

2023-06-24 15:41:42.693624 (Thread-1): On model.my_new_project.extracted_data: ROLLBACK
2023-06-24 15:41:42.693624 (Thread-1): finished collecting timing info
2023-06-24 15:41:42.694124 (Thread-1): Database Error in model extracted_data (models\extract\extracted_data.sql)
  syntax error at or near ";"
  LINE 8: FROM myschema.transformed_addresses;
                                             ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 8: FROM myschema.transformed_addresses;
                                           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model extracted_data (models\extract\extracted_data.sql)
  syntax error at or near ";"
  LINE 8: FROM myschema.transformed_addresses;
                                             ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:41:42.695624 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626a0298-42af-4400-8c2a-e4af97cacfc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5750A9A58>]}
2023-06-24 15:41:42.696124 (Thread-1): 11:41:42 | 1 of 4 ERROR creating view model myschema.extracted_data............. [ERROR in 0.06s]
2023-06-24 15:41:42.696624 (Thread-1): Finished running node model.my_new_project.extracted_data
2023-06-24 15:41:42.696624 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2023-06-24 15:41:42.696624 (Thread-1): 11:41:42 | 2 of 4 START table model myschema.my_first_dbt_model................. [RUN]
2023-06-24 15:41:42.697124 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:41:42.697124 (Thread-1): Re-using an available connection from the pool (formerly model.my_new_project.extracted_data).
2023-06-24 15:41:42.697124 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2023-06-24 15:41:42.702124 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2023-06-24 15:41:42.703278 (Thread-1): finished collecting timing info
2023-06-24 15:41:42.716282 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:41:42.716782 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_tmp" cascade
2023-06-24 15:41:42.717089 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:41:42.718593 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:41:42.718593 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_backup" cascade
2023-06-24 15:41:42.718593 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:41:42.719594 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2023-06-24 15:41:42.720593 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:41:42.720593 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2023-06-24 15:41:42.720593 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:41:42.720593 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:41:42.721094 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."myschema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2023-06-24 15:41:42.726592 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2023-06-24 15:41:42.728093 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:41:42.728093 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."myschema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2023-06-24 15:41:42.728593 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2023-06-24 15:41:42.729094 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2023-06-24 15:41:42.729094 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:41:42.729094 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2023-06-24 15:41:42.729593 (Thread-1): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:41:42.730094 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:41:42.730593 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_backup" cascade
2023-06-24 15:41:42.730593 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:41:42.732093 (Thread-1): finished collecting timing info
2023-06-24 15:41:42.732594 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626a0298-42af-4400-8c2a-e4af97cacfc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5750EEF98>]}
2023-06-24 15:41:42.732594 (Thread-1): 11:41:42 | 2 of 4 OK created table model myschema.my_first_dbt_model............ [SELECT 2 in 0.03s]
2023-06-24 15:41:42.733095 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2023-06-24 15:41:42.733095 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:41:42.733095 (Thread-1): 11:41:42 | 3 of 4 SKIP relation myschema.transformation......................... [SKIP]
2023-06-24 15:41:42.734096 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:41:42.734096 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2023-06-24 15:41:42.734096 (Thread-1): 11:41:42 | 4 of 4 START view model myschema.my_second_dbt_model................. [RUN]
2023-06-24 15:41:42.734593 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:41:42.734593 (Thread-1): Re-using an available connection from the pool (formerly model.my_new_project.my_first_dbt_model).
2023-06-24 15:41:42.734593 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2023-06-24 15:41:42.738593 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2023-06-24 15:41:42.739593 (Thread-1): finished collecting timing info
2023-06-24 15:41:42.743094 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:41:42.743094 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_tmp" cascade
2023-06-24 15:41:42.743814 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:41:42.744818 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:41:42.744818 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_backup" cascade
2023-06-24 15:41:42.745465 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:41:42.745969 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2023-06-24 15:41:42.746469 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:41:42.746469 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2023-06-24 15:41:42.746969 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:41:42.746969 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:41:42.746969 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."myschema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."myschema"."my_first_dbt_model"
where id = 1
  );

2023-06-24 15:41:42.749008 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2023-06-24 15:41:42.749969 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:41:42.749969 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."myschema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2023-06-24 15:41:42.750468 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2023-06-24 15:41:42.750969 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2023-06-24 15:41:42.750969 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:41:42.750969 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2023-06-24 15:41:42.751469 (Thread-1): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:41:42.752968 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:41:42.752968 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_backup" cascade
2023-06-24 15:41:42.753470 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:41:42.754469 (Thread-1): finished collecting timing info
2023-06-24 15:41:42.754969 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626a0298-42af-4400-8c2a-e4af97cacfc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5750900F0>]}
2023-06-24 15:41:42.755469 (Thread-1): 11:41:42 | 4 of 4 OK created view model myschema.my_second_dbt_model............ [CREATE VIEW in 0.02s]
2023-06-24 15:41:42.755968 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2023-06-24 15:41:42.843469 (MainThread): Using postgres connection "master".
2023-06-24 15:41:42.843971 (MainThread): On master: BEGIN
2023-06-24 15:41:42.843971 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:41:42.843971 (MainThread): On master: COMMIT
2023-06-24 15:41:42.843971 (MainThread): Using postgres connection "master".
2023-06-24 15:41:42.844481 (MainThread): On master: COMMIT
2023-06-24 15:41:42.844481 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:41:42.844481 (MainThread): 11:41:42 | 
2023-06-24 15:41:42.844977 (MainThread): 11:41:42 | Finished running 3 view models, 1 table model in 0.42s.
2023-06-24 15:41:42.844977 (MainThread): Connection 'master' was left open.
2023-06-24 15:41:42.844977 (MainThread): On master: Close
2023-06-24 15:41:42.845442 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:41:42.845442 (MainThread): On list_postgres: Close
2023-06-24 15:41:42.845442 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:41:42.845442 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:41:42.845442 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was left open.
2023-06-24 15:41:42.845942 (MainThread): On model.my_new_project.my_second_dbt_model: Close
2023-06-24 15:41:42.851940 (MainThread): 
2023-06-24 15:41:42.852441 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:41:42.852441 (MainThread): 
2023-06-24 15:41:42.852941 (MainThread): Database Error in model extracted_data (models\extract\extracted_data.sql)
2023-06-24 15:41:42.853440 (MainThread):   syntax error at or near ";"
2023-06-24 15:41:42.853619 (MainThread):   LINE 8: FROM myschema.transformed_addresses;
2023-06-24 15:41:42.853619 (MainThread):                                              ^
2023-06-24 15:41:42.853619 (MainThread):   compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:41:42.854125 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2023-06-24 15:41:42.854125 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E575029668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5750291D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5750A9D30>]}
2023-06-24 15:41:42.854125 (MainThread): Flushing usage events
2023-06-24 15:42:03.906462 (MainThread): Running with dbt=0.16.0
2023-06-24 15:42:03.944462 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:42:03.944462 (MainThread): Tracking: tracking
2023-06-24 15:42:03.945462 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FF1CF908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FF0FA6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FF110E48>]}
2023-06-24 15:42:03.956962 (MainThread): Partial parsing not enabled
2023-06-24 15:42:03.959462 (MainThread): Parsing macros\core.sql
2023-06-24 15:42:03.962962 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:42:03.993962 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:42:04.000962 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:42:04.001463 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:42:04.002462 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:42:04.003962 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:42:04.005462 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:42:04.006962 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:42:04.007962 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:42:04.013462 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:42:04.022962 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:42:04.024462 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:42:04.028963 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:42:04.044962 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:42:04.069962 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:42:04.070962 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:42:04.083962 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:42:04.089462 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:42:04.092962 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:42:04.097962 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:42:04.099462 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:42:04.099963 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:42:04.100962 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:42:04.101962 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:42:04.114962 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:42:04.116962 (MainThread): Parsing macros\relations.sql
2023-06-24 15:42:04.117963 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:42:04.130462 (MainThread): Partial parsing not enabled
2023-06-24 15:42:04.149462 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:42:04.149462 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:42:04.159464 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:42:04.159464 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:42:04.162964 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:42:04.162964 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:42:04.165964 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:42:04.165964 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:42:04.186963 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:42:04.186963 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:42:04.192964 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:42:04.193464 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:42:04.199464 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:42:04.199464 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:42:04.214507 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:42:04.214507 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:42:04.284461 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.transformation
- models.extracted_data

2023-06-24 15:42:04.421187 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:42:04.421187 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:42:04.421187 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:42:04.421187 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:42:04.421187 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:42:04.421187 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:42:04.421687 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:42:04.452687 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:42:04.453187 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:42:04.573687 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:42:04.576688 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:42:04.577188 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:42:04.579687 (MainThread): 
2023-06-24 15:42:04.579687 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:42:04.580188 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:42:04.589687 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:42:04.590187 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:42:04.645187 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:42:04.645187 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:42:04.674688 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:42:04.693687 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:42:04.693687 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:42:04.694688 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:42:04.694688 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:42:04.722187 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:42:04.722187 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:42:04.722689 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:42:04.725188 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2023-06-24 15:42:04.727189 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:42:04.746187 (MainThread): Using postgres connection "master".
2023-06-24 15:42:04.746187 (MainThread): On master: BEGIN
2023-06-24 15:42:04.773687 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:42:04.773687 (MainThread): Using postgres connection "master".
2023-06-24 15:42:04.773687 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:42:04.777187 (MainThread): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:42:04.778687 (MainThread): On master: ROLLBACK
2023-06-24 15:42:04.778687 (MainThread): Using postgres connection "master".
2023-06-24 15:42:04.778687 (MainThread): On master: BEGIN
2023-06-24 15:42:04.779188 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:42:04.779188 (MainThread): On master: COMMIT
2023-06-24 15:42:04.779188 (MainThread): Using postgres connection "master".
2023-06-24 15:42:04.779188 (MainThread): On master: COMMIT
2023-06-24 15:42:04.779188 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:42:04.779687 (MainThread): 11:42:04 | Concurrency: 1 threads (target='dev')
2023-06-24 15:42:04.779687 (MainThread): 11:42:04 | 
2023-06-24 15:42:04.781187 (Thread-1): Began running node model.my_new_project.extracted_data
2023-06-24 15:42:04.781688 (Thread-1): 11:42:04 | 1 of 4 START view model myschema.extracted_data...................... [RUN]
2023-06-24 15:42:04.781688 (Thread-1): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:42:04.781688 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:42:04.781688 (Thread-1): Compiling model.my_new_project.extracted_data
2023-06-24 15:42:04.789687 (Thread-1): Writing injected SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:42:04.790187 (Thread-1): finished collecting timing info
2023-06-24 15:42:04.810187 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:42:04.810187 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_tmp" cascade
2023-06-24 15:42:04.839046 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:42:04.840576 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:42:04.840576 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_backup" cascade
2023-06-24 15:42:04.841017 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:42:04.841521 (Thread-1): Writing runtime SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:42:04.842021 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:42:04.842521 (Thread-1): On model.my_new_project.extracted_data: BEGIN
2023-06-24 15:42:04.842521 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:42:04.842521 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:42:04.842521 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */

  create view "postgres"."myschema"."extracted_data__dbt_tmp" as (
    -- models/extract/extracted_data.sql
-- Your extraction logic goes here
-- Example:
SELECT *
FROM myschema.transformed_addresses
  );

2023-06-24 15:42:04.843021 (Thread-1): Postgres error: relation "myschema.transformed_addresses" does not exist
LINE 8: FROM myschema.transformed_addresses
             ^

2023-06-24 15:42:04.843021 (Thread-1): On model.my_new_project.extracted_data: ROLLBACK
2023-06-24 15:42:04.843521 (Thread-1): finished collecting timing info
2023-06-24 15:42:04.843521 (Thread-1): Database Error in model extracted_data (models\extract\extracted_data.sql)
  relation "myschema.transformed_addresses" does not exist
  LINE 8: FROM myschema.transformed_addresses
               ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.transformed_addresses" does not exist
LINE 8: FROM myschema.transformed_addresses
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model extracted_data (models\extract\extracted_data.sql)
  relation "myschema.transformed_addresses" does not exist
  LINE 8: FROM myschema.transformed_addresses
               ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:42:04.845021 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39ddb09-69f9-4692-93d8-3ab74ed4fba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FE92A390>]}
2023-06-24 15:42:04.845521 (Thread-1): 11:42:04 | 1 of 4 ERROR creating view model myschema.extracted_data............. [ERROR in 0.06s]
2023-06-24 15:42:04.846235 (Thread-1): Finished running node model.my_new_project.extracted_data
2023-06-24 15:42:04.846235 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2023-06-24 15:42:04.846235 (Thread-1): 11:42:04 | 2 of 4 START table model myschema.my_first_dbt_model................. [RUN]
2023-06-24 15:42:04.846735 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:42:04.846735 (Thread-1): Re-using an available connection from the pool (formerly model.my_new_project.extracted_data).
2023-06-24 15:42:04.846735 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2023-06-24 15:42:04.851763 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2023-06-24 15:42:04.852267 (Thread-1): finished collecting timing info
2023-06-24 15:42:04.864233 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:42:04.864233 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_tmp" cascade
2023-06-24 15:42:04.864735 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:42:04.866233 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:42:04.866233 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_backup" cascade
2023-06-24 15:42:04.866661 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:42:04.867165 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2023-06-24 15:42:04.867665 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:42:04.868164 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2023-06-24 15:42:04.868164 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:42:04.868164 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:42:04.868164 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."myschema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2023-06-24 15:42:04.870144 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2023-06-24 15:42:04.872183 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:42:04.872183 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."myschema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2023-06-24 15:42:04.872956 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2023-06-24 15:42:04.873960 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:42:04.873960 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."myschema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2023-06-24 15:42:04.874459 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2023-06-24 15:42:04.874960 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2023-06-24 15:42:04.874960 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:42:04.874960 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2023-06-24 15:42:04.877094 (Thread-1): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:42:04.877960 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:42:04.877960 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_backup" cascade
2023-06-24 15:42:04.880960 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:42:04.882460 (Thread-1): finished collecting timing info
2023-06-24 15:42:04.882960 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39ddb09-69f9-4692-93d8-3ab74ed4fba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200A77B5F28>]}
2023-06-24 15:42:04.882960 (Thread-1): 11:42:04 | 2 of 4 OK created table model myschema.my_first_dbt_model............ [SELECT 2 in 0.04s]
2023-06-24 15:42:04.883460 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2023-06-24 15:42:04.883460 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:42:04.883460 (Thread-1): 11:42:04 | 3 of 4 SKIP relation myschema.transformation......................... [SKIP]
2023-06-24 15:42:04.883959 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:42:04.883959 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2023-06-24 15:42:04.883959 (Thread-1): 11:42:04 | 4 of 4 START view model myschema.my_second_dbt_model................. [RUN]
2023-06-24 15:42:04.884459 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:42:04.884459 (Thread-1): Re-using an available connection from the pool (formerly model.my_new_project.my_first_dbt_model).
2023-06-24 15:42:04.884459 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2023-06-24 15:42:04.888959 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2023-06-24 15:42:04.889460 (Thread-1): finished collecting timing info
2023-06-24 15:42:04.893459 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:42:04.893459 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_tmp" cascade
2023-06-24 15:42:04.893459 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:42:04.894959 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:42:04.894959 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_backup" cascade
2023-06-24 15:42:04.895460 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:42:04.896460 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2023-06-24 15:42:04.896961 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:42:04.896961 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2023-06-24 15:42:04.897346 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:42:04.897346 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:42:04.897346 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."myschema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."myschema"."my_first_dbt_model"
where id = 1
  );

2023-06-24 15:42:04.898419 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2023-06-24 15:42:04.900456 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:42:04.900456 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."myschema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2023-06-24 15:42:04.900923 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2023-06-24 15:42:04.901460 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2023-06-24 15:42:04.901460 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:42:04.901460 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2023-06-24 15:42:04.901923 (Thread-1): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:42:04.902453 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:42:04.902950 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_backup" cascade
2023-06-24 15:42:04.902950 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:42:04.904452 (Thread-1): finished collecting timing info
2023-06-24 15:42:04.904954 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39ddb09-69f9-4692-93d8-3ab74ed4fba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200A77FC3C8>]}
2023-06-24 15:42:04.904954 (Thread-1): 11:42:04 | 4 of 4 OK created view model myschema.my_second_dbt_model............ [CREATE VIEW in 0.02s]
2023-06-24 15:42:04.905423 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2023-06-24 15:42:05.003285 (MainThread): Using postgres connection "master".
2023-06-24 15:42:05.003285 (MainThread): On master: BEGIN
2023-06-24 15:42:05.003285 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:42:05.003784 (MainThread): On master: COMMIT
2023-06-24 15:42:05.003784 (MainThread): Using postgres connection "master".
2023-06-24 15:42:05.003784 (MainThread): On master: COMMIT
2023-06-24 15:42:05.003784 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:42:05.003784 (MainThread): 11:42:05 | 
2023-06-24 15:42:05.004284 (MainThread): 11:42:05 | Finished running 3 view models, 1 table model in 0.42s.
2023-06-24 15:42:05.004284 (MainThread): Connection 'master' was left open.
2023-06-24 15:42:05.004284 (MainThread): On master: Close
2023-06-24 15:42:05.004784 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:42:05.004784 (MainThread): On list_postgres: Close
2023-06-24 15:42:05.004784 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:42:05.004784 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:42:05.004784 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was left open.
2023-06-24 15:42:05.005284 (MainThread): On model.my_new_project.my_second_dbt_model: Close
2023-06-24 15:42:05.011284 (MainThread): 
2023-06-24 15:42:05.011784 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:42:05.011784 (MainThread): 
2023-06-24 15:42:05.012284 (MainThread): Database Error in model extracted_data (models\extract\extracted_data.sql)
2023-06-24 15:42:05.012284 (MainThread):   relation "myschema.transformed_addresses" does not exist
2023-06-24 15:42:05.012284 (MainThread):   LINE 8: FROM myschema.transformed_addresses
2023-06-24 15:42:05.012784 (MainThread):                ^
2023-06-24 15:42:05.012784 (MainThread):   compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:42:05.012784 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2023-06-24 15:42:05.013284 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FF37E5F8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FF338BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200A7835C88>]}
2023-06-24 15:42:05.013284 (MainThread): Flushing usage events
2023-06-24 15:44:14.364401 (MainThread): Running with dbt=0.16.0
2023-06-24 15:44:14.402401 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:44:14.402901 (MainThread): Tracking: tracking
2023-06-24 15:44:14.403401 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5DC9FB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5DBDEEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5DBDEB38>]}
2023-06-24 15:44:14.414901 (MainThread): Partial parsing not enabled
2023-06-24 15:44:14.417401 (MainThread): Parsing macros\core.sql
2023-06-24 15:44:14.420901 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:44:14.452401 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:44:14.458901 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:44:14.459901 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:44:14.460901 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:44:14.462401 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:44:14.463901 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:44:14.464901 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:44:14.465901 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:44:14.471901 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:44:14.481401 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:44:14.482901 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:44:14.487401 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:44:14.503401 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:44:14.527901 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:44:14.529401 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:44:14.541901 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:44:14.547401 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:44:14.550901 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:44:14.555401 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:44:14.557401 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:44:14.557901 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:44:14.558901 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:44:14.559901 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:44:14.573401 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:44:14.574901 (MainThread): Parsing macros\relations.sql
2023-06-24 15:44:14.575901 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:44:14.588901 (MainThread): Partial parsing not enabled
2023-06-24 15:44:14.607401 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:14.607401 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:14.617901 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:14.617901 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:14.621401 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:14.621401 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:14.624402 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:44:14.624402 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:14.645401 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:44:14.645901 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:14.651901 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:44:14.651901 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:14.657901 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:44:14.657901 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:14.672401 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:44:14.672901 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:14.743901 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:44:14.881401 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:14.881401 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:14.881401 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:14.881401 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:14.881401 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:14.881901 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:14.881901 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:14.913402 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:14.913402 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:15.030902 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:44:15.033401 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:44:15.033902 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:44:15.036901 (MainThread): 
2023-06-24 15:44:15.036901 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:44:15.037401 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:15.046902 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:44:15.046902 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:44:15.103901 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:44:15.103901 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:44:15.133901 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:44:15.152401 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:44:15.152401 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:44:15.153401 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:44:15.153401 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:44:15.182427 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:44:15.182427 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:44:15.182427 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:44:15.185441 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2023-06-24 15:44:15.187439 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:44:15.206401 (MainThread): Using postgres connection "master".
2023-06-24 15:44:15.206901 (MainThread): On master: BEGIN
2023-06-24 15:44:15.372531 (MainThread): SQL status: BEGIN in 0.17 seconds
2023-06-24 15:44:15.372531 (MainThread): Using postgres connection "master".
2023-06-24 15:44:15.372531 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:44:15.376030 (MainThread): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:44:15.377563 (MainThread): On master: ROLLBACK
2023-06-24 15:44:15.377563 (MainThread): Using postgres connection "master".
2023-06-24 15:44:15.377563 (MainThread): On master: BEGIN
2023-06-24 15:44:15.378049 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:15.378049 (MainThread): On master: COMMIT
2023-06-24 15:44:15.378049 (MainThread): Using postgres connection "master".
2023-06-24 15:44:15.378049 (MainThread): On master: COMMIT
2023-06-24 15:44:15.378560 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:44:15.378560 (MainThread): 11:44:15 | Concurrency: 1 threads (target='dev')
2023-06-24 15:44:15.379052 (MainThread): 11:44:15 | 
2023-06-24 15:44:15.381031 (Thread-1): Began running node model.my_new_project.extracted_data
2023-06-24 15:44:15.381031 (Thread-1): 11:44:15 | 1 of 4 START view model myschema.extracted_data...................... [RUN]
2023-06-24 15:44:15.381031 (Thread-1): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:15.381532 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:44:15.381532 (Thread-1): Compiling model.my_new_project.extracted_data
2023-06-24 15:44:15.389529 (Thread-1): Writing injected SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:44:15.390030 (Thread-1): finished collecting timing info
2023-06-24 15:44:15.410029 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:15.410029 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_tmp" cascade
2023-06-24 15:44:15.438190 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:44:15.440190 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:15.440190 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_backup" cascade
2023-06-24 15:44:15.440190 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:44:15.441190 (Thread-1): Writing runtime SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:44:15.441690 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:15.441690 (Thread-1): On model.my_new_project.extracted_data: BEGIN
2023-06-24 15:44:15.442185 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:15.442185 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:15.442185 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */

  create view "postgres"."myschema"."extracted_data__dbt_tmp" as (
    -- models/extract/extracted_data.sql
-- Your extraction logic goes here
-- Example:
SELECT *
FROM myschema.transformed_addresses;
  );

2023-06-24 15:44:15.442688 (Thread-1): Postgres error: syntax error at or near ";"
LINE 8: FROM myschema.transformed_addresses;
                                           ^

2023-06-24 15:44:15.442688 (Thread-1): On model.my_new_project.extracted_data: ROLLBACK
2023-06-24 15:44:15.442982 (Thread-1): finished collecting timing info
2023-06-24 15:44:15.442982 (Thread-1): Database Error in model extracted_data (models\extract\extracted_data.sql)
  syntax error at or near ";"
  LINE 8: FROM myschema.transformed_addresses;
                                             ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 8: FROM myschema.transformed_addresses;
                                           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model extracted_data (models\extract\extracted_data.sql)
  syntax error at or near ";"
  LINE 8: FROM myschema.transformed_addresses;
                                             ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:44:15.444986 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1abda31c-043f-432a-8c46-f8b45a2a7f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E061AA7F0>]}
2023-06-24 15:44:15.444986 (Thread-1): 11:44:15 | 1 of 4 ERROR creating view model myschema.extracted_data............. [ERROR in 0.06s]
2023-06-24 15:44:15.445608 (Thread-1): Finished running node model.my_new_project.extracted_data
2023-06-24 15:44:15.445608 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2023-06-24 15:44:15.445608 (Thread-1): 11:44:15 | 2 of 4 START table model myschema.my_first_dbt_model................. [RUN]
2023-06-24 15:44:15.446118 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:15.446118 (Thread-1): Re-using an available connection from the pool (formerly model.my_new_project.extracted_data).
2023-06-24 15:44:15.446118 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2023-06-24 15:44:15.451112 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2023-06-24 15:44:15.451611 (Thread-1): finished collecting timing info
2023-06-24 15:44:15.464111 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:15.464111 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_tmp" cascade
2023-06-24 15:44:15.464612 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:44:15.465611 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:15.465611 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_backup" cascade
2023-06-24 15:44:15.466111 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:44:15.467112 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2023-06-24 15:44:15.467611 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:15.467611 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2023-06-24 15:44:15.467611 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:15.467611 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:15.467611 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."myschema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2023-06-24 15:44:15.469611 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2023-06-24 15:44:15.472111 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:15.472111 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."myschema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2023-06-24 15:44:15.472111 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2023-06-24 15:44:15.473612 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:15.473612 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."myschema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2023-06-24 15:44:15.474111 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2023-06-24 15:44:15.474612 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2023-06-24 15:44:15.474612 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:15.474612 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2023-06-24 15:44:15.475114 (Thread-1): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:44:15.476113 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:15.476113 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_backup" cascade
2023-06-24 15:44:15.478612 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:44:15.479611 (Thread-1): finished collecting timing info
2023-06-24 15:44:15.480111 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1abda31c-043f-432a-8c46-f8b45a2a7f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E062C6E48>]}
2023-06-24 15:44:15.480111 (Thread-1): 11:44:15 | 2 of 4 OK created table model myschema.my_first_dbt_model............ [SELECT 2 in 0.03s]
2023-06-24 15:44:15.480611 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2023-06-24 15:44:15.480611 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:44:15.481112 (Thread-1): 11:44:15 | 3 of 4 SKIP relation myschema.transformation......................... [SKIP]
2023-06-24 15:44:15.481612 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:44:15.481612 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2023-06-24 15:44:15.481612 (Thread-1): 11:44:15 | 4 of 4 START view model myschema.my_second_dbt_model................. [RUN]
2023-06-24 15:44:15.481612 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:15.482112 (Thread-1): Re-using an available connection from the pool (formerly model.my_new_project.my_first_dbt_model).
2023-06-24 15:44:15.482112 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2023-06-24 15:44:15.486111 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2023-06-24 15:44:15.486611 (Thread-1): finished collecting timing info
2023-06-24 15:44:15.490613 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:15.490613 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_tmp" cascade
2023-06-24 15:44:15.491112 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:44:15.492112 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:15.492611 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_backup" cascade
2023-06-24 15:44:15.492611 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:44:15.493611 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2023-06-24 15:44:15.494112 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:15.494112 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2023-06-24 15:44:15.494112 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:15.494112 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:15.494612 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."myschema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."myschema"."my_first_dbt_model"
where id = 1
  );

2023-06-24 15:44:15.495112 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2023-06-24 15:44:15.497111 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:15.497111 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."myschema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2023-06-24 15:44:15.497611 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2023-06-24 15:44:15.498111 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2023-06-24 15:44:15.498111 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:15.498111 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2023-06-24 15:44:15.498612 (Thread-1): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:44:15.499611 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:15.499611 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_backup" cascade
2023-06-24 15:44:15.499611 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:44:15.501111 (Thread-1): finished collecting timing info
2023-06-24 15:44:15.501612 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1abda31c-043f-432a-8c46-f8b45a2a7f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E062AE9B0>]}
2023-06-24 15:44:15.501612 (Thread-1): 11:44:15 | 4 of 4 OK created view model myschema.my_second_dbt_model............ [CREATE VIEW in 0.02s]
2023-06-24 15:44:15.502111 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2023-06-24 15:44:15.598752 (MainThread): Using postgres connection "master".
2023-06-24 15:44:15.598752 (MainThread): On master: BEGIN
2023-06-24 15:44:15.599286 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:15.599286 (MainThread): On master: COMMIT
2023-06-24 15:44:15.599286 (MainThread): Using postgres connection "master".
2023-06-24 15:44:15.599286 (MainThread): On master: COMMIT
2023-06-24 15:44:15.599787 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:44:15.599787 (MainThread): 11:44:15 | 
2023-06-24 15:44:15.600257 (MainThread): 11:44:15 | Finished running 3 view models, 1 table model in 0.56s.
2023-06-24 15:44:15.600257 (MainThread): Connection 'master' was left open.
2023-06-24 15:44:15.600257 (MainThread): On master: Close
2023-06-24 15:44:15.600257 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:44:15.600257 (MainThread): On list_postgres: Close
2023-06-24 15:44:15.600785 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:44:15.600785 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:44:15.600785 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was left open.
2023-06-24 15:44:15.600785 (MainThread): On model.my_new_project.my_second_dbt_model: Close
2023-06-24 15:44:15.607256 (MainThread): 
2023-06-24 15:44:15.607256 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:44:15.607875 (MainThread): 
2023-06-24 15:44:15.607875 (MainThread): Database Error in model extracted_data (models\extract\extracted_data.sql)
2023-06-24 15:44:15.608380 (MainThread):   syntax error at or near ";"
2023-06-24 15:44:15.608881 (MainThread):   LINE 8: FROM myschema.transformed_addresses;
2023-06-24 15:44:15.608881 (MainThread):                                              ^
2023-06-24 15:44:15.608881 (MainThread):   compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:44:15.609381 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2023-06-24 15:44:15.609381 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E061AC2E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E7F8A1668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5DE07B38>]}
2023-06-24 15:44:15.609381 (MainThread): Flushing usage events
2023-06-24 15:44:21.195029 (MainThread): Running with dbt=0.16.0
2023-06-24 15:44:21.233529 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:44:21.234029 (MainThread): Tracking: tracking
2023-06-24 15:44:21.234529 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EFDBF940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EFCE9438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EFCFEF28>]}
2023-06-24 15:44:21.246529 (MainThread): Partial parsing not enabled
2023-06-24 15:44:21.249029 (MainThread): Parsing macros\core.sql
2023-06-24 15:44:21.252529 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:44:21.284029 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:44:21.290529 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:44:21.291529 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:44:21.292529 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:44:21.294029 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:44:21.295529 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:44:21.297029 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:44:21.297529 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:44:21.303529 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:44:21.313028 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:44:21.314529 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:44:21.319029 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:44:21.335029 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:44:21.360028 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:44:21.361529 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:44:21.374028 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:44:21.379029 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:44:21.383029 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:44:21.387529 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:44:21.389029 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:44:21.390029 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:44:21.391029 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:44:21.392029 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:44:21.405529 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:44:21.407029 (MainThread): Parsing macros\relations.sql
2023-06-24 15:44:21.408029 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:44:21.421029 (MainThread): Partial parsing not enabled
2023-06-24 15:44:21.440029 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:21.440029 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:21.450029 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:21.450029 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:21.454029 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:21.454029 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:21.457029 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:44:21.457029 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:21.478528 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_first_dbt_model_id".
2023-06-24 15:44:21.478528 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:21.484529 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_first_dbt_model_id".
2023-06-24 15:44:21.484529 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:21.491029 (MainThread): Acquiring new postgres connection "test.my_new_project.unique_my_second_dbt_model_id".
2023-06-24 15:44:21.491029 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:21.506029 (MainThread): Acquiring new postgres connection "test.my_new_project.not_null_my_second_dbt_model_id".
2023-06-24 15:44:21.506029 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:21.577029 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:44:21.715529 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:21.715529 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:21.715529 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:21.715529 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:21.715529 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:21.716029 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:21.716029 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:21.747029 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:21.747029 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:21.873529 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:44:21.876529 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:44:21.877028 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:44:21.879526 (MainThread): 
2023-06-24 15:44:21.880028 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:44:21.880028 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:21.890027 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:44:21.890530 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:44:21.946026 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:44:21.946026 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:44:21.976529 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:44:21.995528 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:44:21.995528 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:44:21.996558 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:44:21.996558 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:44:22.025027 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:44:22.025529 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:44:22.025529 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:44:22.028029 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2023-06-24 15:44:22.030027 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:44:22.049529 (MainThread): Using postgres connection "master".
2023-06-24 15:44:22.049529 (MainThread): On master: BEGIN
2023-06-24 15:44:22.078028 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:44:22.078028 (MainThread): Using postgres connection "master".
2023-06-24 15:44:22.078028 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:44:22.081529 (MainThread): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:44:22.083027 (MainThread): On master: ROLLBACK
2023-06-24 15:44:22.083027 (MainThread): Using postgres connection "master".
2023-06-24 15:44:22.083027 (MainThread): On master: BEGIN
2023-06-24 15:44:22.083528 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:22.083528 (MainThread): On master: COMMIT
2023-06-24 15:44:22.083528 (MainThread): Using postgres connection "master".
2023-06-24 15:44:22.083528 (MainThread): On master: COMMIT
2023-06-24 15:44:22.083528 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:44:22.084028 (MainThread): 11:44:22 | Concurrency: 1 threads (target='dev')
2023-06-24 15:44:22.084028 (MainThread): 11:44:22 | 
2023-06-24 15:44:22.086028 (Thread-1): Began running node model.my_new_project.extracted_data
2023-06-24 15:44:22.086028 (Thread-1): 11:44:22 | 1 of 4 START view model myschema.extracted_data...................... [RUN]
2023-06-24 15:44:22.086528 (Thread-1): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:22.086528 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:44:22.086528 (Thread-1): Compiling model.my_new_project.extracted_data
2023-06-24 15:44:22.094527 (Thread-1): Writing injected SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:44:22.095026 (Thread-1): finished collecting timing info
2023-06-24 15:44:22.115027 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:22.115527 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_tmp" cascade
2023-06-24 15:44:22.144493 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:44:22.146029 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:22.146029 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_backup" cascade
2023-06-24 15:44:22.146493 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:44:22.147022 (Thread-1): Writing runtime SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:44:22.147993 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:22.147993 (Thread-1): On model.my_new_project.extracted_data: BEGIN
2023-06-24 15:44:22.147993 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:22.147993 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:22.147993 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */

  create view "postgres"."myschema"."extracted_data__dbt_tmp" as (
    -- models/extract/extracted_data.sql
-- Your extraction logic goes here
-- Example:
SELECT *
FROM myschema.transformed_addresses
  );

2023-06-24 15:44:22.148525 (Thread-1): Postgres error: relation "myschema.transformed_addresses" does not exist
LINE 8: FROM myschema.transformed_addresses
             ^

2023-06-24 15:44:22.148525 (Thread-1): On model.my_new_project.extracted_data: ROLLBACK
2023-06-24 15:44:22.148993 (Thread-1): finished collecting timing info
2023-06-24 15:44:22.148993 (Thread-1): Database Error in model extracted_data (models\extract\extracted_data.sql)
  relation "myschema.transformed_addresses" does not exist
  LINE 8: FROM myschema.transformed_addresses
               ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.transformed_addresses" does not exist
LINE 8: FROM myschema.transformed_addresses
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model extracted_data (models\extract\extracted_data.sql)
  relation "myschema.transformed_addresses" does not exist
  LINE 8: FROM myschema.transformed_addresses
               ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:44:22.150493 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc1b192-2edd-4263-a1d3-3148cb9e7f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174983C50B8>]}
2023-06-24 15:44:22.150994 (Thread-1): 11:44:22 | 1 of 4 ERROR creating view model myschema.extracted_data............. [ERROR in 0.06s]
2023-06-24 15:44:22.151493 (Thread-1): Finished running node model.my_new_project.extracted_data
2023-06-24 15:44:22.151493 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2023-06-24 15:44:22.151994 (Thread-1): 11:44:22 | 2 of 4 START table model myschema.my_first_dbt_model................. [RUN]
2023-06-24 15:44:22.151994 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:22.151994 (Thread-1): Re-using an available connection from the pool (formerly model.my_new_project.extracted_data).
2023-06-24 15:44:22.152493 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2023-06-24 15:44:22.156992 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2023-06-24 15:44:22.157921 (Thread-1): finished collecting timing info
2023-06-24 15:44:22.169924 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:22.169924 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_tmp" cascade
2023-06-24 15:44:22.170425 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:44:22.171425 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:22.171425 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_backup" cascade
2023-06-24 15:44:22.172113 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:44:22.172617 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2023-06-24 15:44:22.173117 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:22.173617 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2023-06-24 15:44:22.173617 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:22.173617 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:22.173617 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."myschema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2023-06-24 15:44:22.175654 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2023-06-24 15:44:22.178116 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:22.178116 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."myschema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2023-06-24 15:44:22.178116 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2023-06-24 15:44:22.179617 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:22.179617 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."myschema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2023-06-24 15:44:22.180117 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2023-06-24 15:44:22.180617 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2023-06-24 15:44:22.180617 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:22.180617 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2023-06-24 15:44:22.182118 (Thread-1): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:44:22.183116 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2023-06-24 15:44:22.183116 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."myschema"."my_first_dbt_model__dbt_backup" cascade
2023-06-24 15:44:22.185155 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2023-06-24 15:44:22.186616 (Thread-1): finished collecting timing info
2023-06-24 15:44:22.187117 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc1b192-2edd-4263-a1d3-3148cb9e7f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498398F28>]}
2023-06-24 15:44:22.187117 (Thread-1): 11:44:22 | 2 of 4 OK created table model myschema.my_first_dbt_model............ [SELECT 2 in 0.03s]
2023-06-24 15:44:22.187618 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2023-06-24 15:44:22.187618 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:44:22.188117 (Thread-1): 11:44:22 | 3 of 4 SKIP relation myschema.transformation......................... [SKIP]
2023-06-24 15:44:22.188616 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:44:22.188616 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2023-06-24 15:44:22.188616 (Thread-1): 11:44:22 | 4 of 4 START view model myschema.my_second_dbt_model................. [RUN]
2023-06-24 15:44:22.189116 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:22.189116 (Thread-1): Re-using an available connection from the pool (formerly model.my_new_project.my_first_dbt_model).
2023-06-24 15:44:22.189116 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2023-06-24 15:44:22.193617 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2023-06-24 15:44:22.194116 (Thread-1): finished collecting timing info
2023-06-24 15:44:22.197616 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:22.197616 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_tmp" cascade
2023-06-24 15:44:22.198116 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:44:22.199616 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:22.199616 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_backup" cascade
2023-06-24 15:44:22.199616 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:44:22.200617 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2023-06-24 15:44:22.201116 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:22.201116 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2023-06-24 15:44:22.201608 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:22.201608 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:22.201608 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."myschema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."myschema"."my_first_dbt_model"
where id = 1
  );

2023-06-24 15:44:22.202545 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2023-06-24 15:44:22.204049 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:22.204549 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."myschema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2023-06-24 15:44:22.204549 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2023-06-24 15:44:22.205050 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2023-06-24 15:44:22.205050 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:22.205050 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2023-06-24 15:44:22.205549 (Thread-1): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:44:22.206549 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2023-06-24 15:44:22.206549 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."myschema"."my_second_dbt_model__dbt_backup" cascade
2023-06-24 15:44:22.207050 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:44:22.208049 (Thread-1): finished collecting timing info
2023-06-24 15:44:22.208549 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc1b192-2edd-4263-a1d3-3148cb9e7f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498417EB8>]}
2023-06-24 15:44:22.208549 (Thread-1): 11:44:22 | 4 of 4 OK created view model myschema.my_second_dbt_model............ [CREATE VIEW in 0.02s]
2023-06-24 15:44:22.209550 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2023-06-24 15:44:22.302754 (MainThread): Using postgres connection "master".
2023-06-24 15:44:22.302754 (MainThread): On master: BEGIN
2023-06-24 15:44:22.302754 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:22.302754 (MainThread): On master: COMMIT
2023-06-24 15:44:22.303253 (MainThread): Using postgres connection "master".
2023-06-24 15:44:22.303253 (MainThread): On master: COMMIT
2023-06-24 15:44:22.303253 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:44:22.303253 (MainThread): 11:44:22 | 
2023-06-24 15:44:22.303735 (MainThread): 11:44:22 | Finished running 3 view models, 1 table model in 0.42s.
2023-06-24 15:44:22.303735 (MainThread): Connection 'master' was left open.
2023-06-24 15:44:22.303735 (MainThread): On master: Close
2023-06-24 15:44:22.303735 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:44:22.304268 (MainThread): On list_postgres: Close
2023-06-24 15:44:22.304268 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:44:22.304268 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:44:22.304268 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was left open.
2023-06-24 15:44:22.304268 (MainThread): On model.my_new_project.my_second_dbt_model: Close
2023-06-24 15:44:22.310772 (MainThread): 
2023-06-24 15:44:22.310772 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:44:22.311240 (MainThread): 
2023-06-24 15:44:22.311739 (MainThread): Database Error in model extracted_data (models\extract\extracted_data.sql)
2023-06-24 15:44:22.311739 (MainThread):   relation "myschema.transformed_addresses" does not exist
2023-06-24 15:44:22.312239 (MainThread):   LINE 8: FROM myschema.transformed_addresses
2023-06-24 15:44:22.312239 (MainThread):                ^
2023-06-24 15:44:22.312239 (MainThread):   compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:44:22.312740 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2023-06-24 15:44:22.312740 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498284D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001749829B5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017498436B70>]}
2023-06-24 15:44:22.312740 (MainThread): Flushing usage events
2023-06-24 15:44:50.693887 (MainThread): Running with dbt=0.16.0
2023-06-24 15:44:50.731386 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:44:50.731886 (MainThread): Tracking: tracking
2023-06-24 15:44:50.732386 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C1ADE240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C1ADEF28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C1ADEB70>]}
2023-06-24 15:44:50.743886 (MainThread): Partial parsing not enabled
2023-06-24 15:44:50.746386 (MainThread): Parsing macros\core.sql
2023-06-24 15:44:50.749886 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:44:50.780886 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:44:50.787386 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:44:50.788386 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:44:50.788887 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:44:50.790886 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:44:50.792386 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:44:50.793386 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:44:50.794386 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:44:50.800386 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:44:50.809886 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:44:50.811386 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:44:50.815886 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:44:50.831386 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:44:50.855886 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:44:50.857386 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:44:50.869886 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:44:50.874886 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:44:50.878386 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:44:50.883386 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:44:50.884886 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:44:50.885386 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:44:50.886386 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:44:50.887386 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:44:50.900386 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:44:50.902386 (MainThread): Parsing macros\relations.sql
2023-06-24 15:44:50.903386 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:44:50.915887 (MainThread): Partial parsing not enabled
2023-06-24 15:44:50.934886 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:50.934886 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:50.944386 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:44:50.944886 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:51.024886 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:44:51.152886 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:51.153387 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:51.153387 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:51.153387 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:51.153387 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:51.153387 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:51.153387 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:51.184886 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:51.184886 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:44:51.303388 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:44:51.304886 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:44:51.304886 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:44:51.305886 (MainThread): 
2023-06-24 15:44:51.306386 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:44:51.306386 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:44:51.312387 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:44:51.312387 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:44:51.366886 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:44:51.367386 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:44:51.397386 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:44:51.404886 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:44:51.404886 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:44:51.405886 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:44:51.405886 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:44:51.433886 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:44:51.434386 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:44:51.434386 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:44:51.436886 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2023-06-24 15:44:51.438886 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:44:51.446386 (MainThread): Using postgres connection "master".
2023-06-24 15:44:51.446386 (MainThread): On master: BEGIN
2023-06-24 15:44:51.475386 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:44:51.475386 (MainThread): Using postgres connection "master".
2023-06-24 15:44:51.475386 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:44:51.479386 (MainThread): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:44:51.480386 (MainThread): On master: ROLLBACK
2023-06-24 15:44:51.480386 (MainThread): Using postgres connection "master".
2023-06-24 15:44:51.480386 (MainThread): On master: BEGIN
2023-06-24 15:44:51.480886 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:51.480886 (MainThread): On master: COMMIT
2023-06-24 15:44:51.480886 (MainThread): Using postgres connection "master".
2023-06-24 15:44:51.480886 (MainThread): On master: COMMIT
2023-06-24 15:44:51.481386 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:44:51.481386 (MainThread): 11:44:51 | Concurrency: 1 threads (target='dev')
2023-06-24 15:44:51.481386 (MainThread): 11:44:51 | 
2023-06-24 15:44:51.483387 (Thread-1): Began running node model.my_new_project.extracted_data
2023-06-24 15:44:51.483887 (Thread-1): 11:44:51 | 1 of 2 START view model myschema.extracted_data...................... [RUN]
2023-06-24 15:44:51.483887 (Thread-1): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:51.483887 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:44:51.484386 (Thread-1): Compiling model.my_new_project.extracted_data
2023-06-24 15:44:51.492386 (Thread-1): Writing injected SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:44:51.492886 (Thread-1): finished collecting timing info
2023-06-24 15:44:51.512386 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:51.512886 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_tmp" cascade
2023-06-24 15:44:51.542079 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:44:51.543612 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:51.543612 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_backup" cascade
2023-06-24 15:44:51.544112 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:44:51.545119 (Thread-1): Writing runtime SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:44:51.545585 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:51.545585 (Thread-1): On model.my_new_project.extracted_data: BEGIN
2023-06-24 15:44:51.545585 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:51.546084 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:44:51.546084 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */

  create view "postgres"."myschema"."extracted_data__dbt_tmp" as (
    -- models/extract/extracted_data.sql
-- Your extraction logic goes here
-- Example:
SELECT *
FROM myschema.postgres
  );

2023-06-24 15:44:51.546084 (Thread-1): Postgres error: relation "myschema.postgres" does not exist
LINE 8: FROM myschema.postgres
             ^

2023-06-24 15:44:51.546084 (Thread-1): On model.my_new_project.extracted_data: ROLLBACK
2023-06-24 15:44:51.546584 (Thread-1): finished collecting timing info
2023-06-24 15:44:51.546584 (Thread-1): Database Error in model extracted_data (models\extract\extracted_data.sql)
  relation "myschema.postgres" does not exist
  LINE 8: FROM myschema.postgres
               ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.postgres" does not exist
LINE 8: FROM myschema.postgres
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model extracted_data (models\extract\extracted_data.sql)
  relation "myschema.postgres" does not exist
  LINE 8: FROM myschema.postgres
               ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:44:51.548582 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c313ad6-432f-43f2-b599-041875ffcfc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6EA0F0E48>]}
2023-06-24 15:44:51.548582 (Thread-1): 11:44:51 | 1 of 2 ERROR creating view model myschema.extracted_data............. [ERROR in 0.06s]
2023-06-24 15:44:51.549084 (Thread-1): Finished running node model.my_new_project.extracted_data
2023-06-24 15:44:51.549583 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:44:51.549583 (Thread-1): 11:44:51 | 2 of 2 SKIP relation myschema.transformation......................... [SKIP]
2023-06-24 15:44:51.550082 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:44:51.596606 (MainThread): Using postgres connection "master".
2023-06-24 15:44:51.596606 (MainThread): On master: BEGIN
2023-06-24 15:44:51.597104 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:44:51.597104 (MainThread): On master: COMMIT
2023-06-24 15:44:51.597104 (MainThread): Using postgres connection "master".
2023-06-24 15:44:51.597104 (MainThread): On master: COMMIT
2023-06-24 15:44:51.597104 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:44:51.597603 (MainThread): 11:44:51 | 
2023-06-24 15:44:51.597603 (MainThread): 11:44:51 | Finished running 2 view models in 0.29s.
2023-06-24 15:44:51.598103 (MainThread): Connection 'master' was left open.
2023-06-24 15:44:51.598103 (MainThread): On master: Close
2023-06-24 15:44:51.598103 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:44:51.598103 (MainThread): On list_postgres: Close
2023-06-24 15:44:51.598603 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:44:51.598603 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:44:51.598603 (MainThread): Connection 'model.my_new_project.extracted_data' was left open.
2023-06-24 15:44:51.598603 (MainThread): On model.my_new_project.extracted_data: Close
2023-06-24 15:44:51.602103 (MainThread): 
2023-06-24 15:44:51.602405 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:44:51.602405 (MainThread): 
2023-06-24 15:44:51.602910 (MainThread): Database Error in model extracted_data (models\extract\extracted_data.sql)
2023-06-24 15:44:51.602910 (MainThread):   relation "myschema.postgres" does not exist
2023-06-24 15:44:51.603409 (MainThread):   LINE 8: FROM myschema.postgres
2023-06-24 15:44:51.603409 (MainThread):                ^
2023-06-24 15:44:51.603409 (MainThread):   compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:44:51.603909 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2023-06-24 15:44:51.603909 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6EA0F97B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6EA1116D8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6EA111748>]}
2023-06-24 15:44:51.603909 (MainThread): Flushing usage events
2023-06-24 15:47:58.025411 (MainThread): Running with dbt=0.16.0
2023-06-24 15:47:58.063909 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:47:58.064412 (MainThread): Tracking: tracking
2023-06-24 15:47:58.064910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4ECED9E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4ECD979B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4ECD749E8>]}
2023-06-24 15:47:58.077911 (MainThread): Partial parsing not enabled
2023-06-24 15:47:58.080910 (MainThread): Parsing macros\core.sql
2023-06-24 15:47:58.084410 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:47:58.117409 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:47:58.124409 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:47:58.125409 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:47:58.126410 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:47:58.127909 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:47:58.129409 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:47:58.130909 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:47:58.131909 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:47:58.137909 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:47:58.147909 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:47:58.149410 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:47:58.154409 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:47:58.170409 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:47:58.195910 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:47:58.197409 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:47:58.210909 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:47:58.216409 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:47:58.220410 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:47:58.225409 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:47:58.226909 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:47:58.227909 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:47:58.228409 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:47:58.229909 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:47:58.243410 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:47:58.244909 (MainThread): Parsing macros\relations.sql
2023-06-24 15:47:58.246409 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:47:58.259909 (MainThread): Partial parsing not enabled
2023-06-24 15:47:58.279909 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:47:58.279909 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:47:58.290410 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:47:58.290410 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:47:58.366410 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:47:58.437910 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:47:58.437910 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:47:58.437910 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:47:58.438410 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:47:58.438410 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:47:58.438410 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:47:58.438410 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:47:58.439910 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.440410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.441410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.443410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.444410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.444910 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.445910 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.446410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.446910 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.447910 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.448910 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.449410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.450439 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.451411 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.454410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.457910 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.458909 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.460410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.460909 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.461910 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.470412 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.474409 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:47:58.474409 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:47:58.476410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.492410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.493410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.495913 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.532409 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.536909 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.537409 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.551410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.554410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.573410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.574410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.589910 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.607410 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 15:47:58.608910 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:47:58.609910 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:47:58.610410 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:47:58.611410 (MainThread): 
2023-06-24 15:47:58.611910 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:47:58.611910 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:47:58.615440 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:47:58.615440 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:47:58.672910 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:47:58.673410 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:47:58.707909 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:47:58.714911 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:47:58.715410 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:47:58.716410 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:47:58.716410 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:47:58.745409 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:47:58.745409 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:47:58.745409 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:47:58.748410 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2023-06-24 15:47:58.749909 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:47:58.757909 (MainThread): Using postgres connection "master".
2023-06-24 15:47:58.757909 (MainThread): On master: BEGIN
2023-06-24 15:47:58.785910 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:47:58.786411 (MainThread): Using postgres connection "master".
2023-06-24 15:47:58.786411 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:47:58.790410 (MainThread): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:47:58.791410 (MainThread): On master: ROLLBACK
2023-06-24 15:47:58.791910 (MainThread): Using postgres connection "master".
2023-06-24 15:47:58.791910 (MainThread): On master: BEGIN
2023-06-24 15:47:58.791910 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:47:58.792410 (MainThread): On master: COMMIT
2023-06-24 15:47:58.792410 (MainThread): Using postgres connection "master".
2023-06-24 15:47:58.792410 (MainThread): On master: COMMIT
2023-06-24 15:47:58.792410 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:47:58.792410 (MainThread): 11:47:58 | Concurrency: 1 threads (target='dev')
2023-06-24 15:47:58.792910 (MainThread): 11:47:58 | 
2023-06-24 15:47:58.794410 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:47:58.794410 (Thread-1): 11:47:58 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 15:47:58.794910 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:47:58.794910 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:47:58.794910 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 15:47:58.803911 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 15:47:58.804966 (Thread-1): finished collecting timing info
2023-06-24 15:47:58.826910 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:47:58.826910 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 15:47:58.855909 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:47:58.857409 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:47:58.857409 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 15:47:58.857409 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:47:58.858410 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 15:47:58.858909 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:47:58.859411 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 15:47:58.859411 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:47:58.859411 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 15:47:58.859411 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    -- models/transform/transformation.sql

WITH filtered_data AS (
    SELECT *
    FROM "postgres"."myschema"."extracted_data"
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 15:47:58.859909 (Thread-1): Postgres error: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^

2023-06-24 15:47:58.859909 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 15:47:58.859909 (Thread-1): finished collecting timing info
2023-06-24 15:47:58.860410 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.extracted_data" does not exist
LINE 8:     FROM "postgres"."myschema"."extracted_data"
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.extracted_data" does not exist
  LINE 8:     FROM "postgres"."myschema"."extracted_data"
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:47:58.861910 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3cd8b16-aa68-4f7f-81c0-f4e311c93953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F09D6BE0>]}
2023-06-24 15:47:58.862412 (Thread-1): 11:47:58 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.07s]
2023-06-24 15:47:58.862412 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:47:58.900910 (MainThread): Using postgres connection "master".
2023-06-24 15:47:58.901411 (MainThread): On master: BEGIN
2023-06-24 15:47:58.901411 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:47:58.901411 (MainThread): On master: COMMIT
2023-06-24 15:47:58.901411 (MainThread): Using postgres connection "master".
2023-06-24 15:47:58.901910 (MainThread): On master: COMMIT
2023-06-24 15:47:58.901910 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:47:58.901910 (MainThread): 11:47:58 | 
2023-06-24 15:47:58.901910 (MainThread): 11:47:58 | Finished running 1 view model in 0.29s.
2023-06-24 15:47:58.902410 (MainThread): Connection 'master' was left open.
2023-06-24 15:47:58.902410 (MainThread): On master: Close
2023-06-24 15:47:58.902410 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:47:58.902410 (MainThread): On list_postgres: Close
2023-06-24 15:47:58.902410 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:47:58.902911 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:47:58.902911 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 15:47:58.902911 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 15:47:58.906410 (MainThread): 
2023-06-24 15:47:58.906410 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:47:58.906410 (MainThread): 
2023-06-24 15:47:58.906410 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 15:47:58.906410 (MainThread):   relation "myschema.extracted_data" does not exist
2023-06-24 15:47:58.906910 (MainThread):   LINE 8:     FROM "postgres"."myschema"."extracted_data"
2023-06-24 15:47:58.906910 (MainThread):                    ^
2023-06-24 15:47:58.906910 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 15:47:58.906910 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 15:47:58.906910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F0A27F28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4EFBEC978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F0A5F7F0>]}
2023-06-24 15:47:58.906910 (MainThread): Flushing usage events
2023-06-24 15:48:21.125408 (MainThread): Running with dbt=0.16.0
2023-06-24 15:48:21.163908 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:48:21.163908 (MainThread): Tracking: tracking
2023-06-24 15:48:21.164908 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224BB960EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224BB960B38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224BB94A6A0>]}
2023-06-24 15:48:21.176409 (MainThread): Partial parsing not enabled
2023-06-24 15:48:21.178408 (MainThread): Parsing macros\core.sql
2023-06-24 15:48:21.181908 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:48:21.212908 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:48:21.219908 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:48:21.220409 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:48:21.221408 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:48:21.222908 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:48:21.224408 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:48:21.225909 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:48:21.226908 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:48:21.232408 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:48:21.241908 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:48:21.243408 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:48:21.247908 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:48:21.263908 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:48:21.288408 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:48:21.289408 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:48:21.301908 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:48:21.306908 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:48:21.310908 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:48:21.315408 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:48:21.316908 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:48:21.317908 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:48:21.318408 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:48:21.319908 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:48:21.332908 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:48:21.334408 (MainThread): Parsing macros\relations.sql
2023-06-24 15:48:21.335408 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:48:21.347908 (MainThread): Partial parsing not enabled
2023-06-24 15:48:21.366908 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:48:21.366908 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:48:21.376408 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:48:21.376908 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:48:21.417908 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224BBB324E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224BBB323C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224BBACEA20>]}
2023-06-24 15:48:21.417908 (MainThread): Flushing usage events
2023-06-24 15:48:21.622571 (MainThread): Connection 'model.my_new_project.transformation' was properly closed.
2023-06-24 15:48:21.623071 (MainThread): Encountered an error:
2023-06-24 15:48:21.623249 (MainThread): Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled
2023-06-24 15:48:21.624783 (MainThread): Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 338, in load_all
    manifest = loader.create_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 323, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 302, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 553, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 534, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\utils.py", line 338, in invalid_ref_fail_unless_test
    target_model_package)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 488, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled

2023-06-24 15:49:12.664361 (MainThread): Running with dbt=0.16.0
2023-06-24 15:49:12.701860 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:49:12.702360 (MainThread): Tracking: tracking
2023-06-24 15:49:12.703361 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012576FBEB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012576EEA6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012576F00F60>]}
2023-06-24 15:49:12.714861 (MainThread): Partial parsing not enabled
2023-06-24 15:49:12.716860 (MainThread): Parsing macros\core.sql
2023-06-24 15:49:12.720360 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:49:12.751360 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:49:12.758360 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:49:12.759361 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:49:12.759861 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:49:12.761360 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:49:12.763361 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:49:12.764360 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:49:12.765360 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:49:12.771360 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:49:12.780860 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:49:12.782360 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:49:12.786860 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:49:12.802360 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:49:12.827360 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:49:12.828360 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:49:12.840860 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:49:12.845860 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:49:12.849860 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:49:12.854360 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:49:12.855860 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:49:12.856860 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:49:12.857361 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:49:12.858861 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:49:12.871860 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:49:12.873861 (MainThread): Parsing macros\relations.sql
2023-06-24 15:49:12.874860 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:49:12.887361 (MainThread): Partial parsing not enabled
2023-06-24 15:49:12.906360 (MainThread): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:49:12.906360 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:49:12.916360 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:49:12.916360 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:49:12.997361 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.extracted_data

2023-06-24 15:49:13.125361 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:49:13.125361 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:49:13.125361 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:49:13.125361 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:49:13.125361 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:49:13.125361 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:49:13.125361 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:49:13.156861 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:49:13.156861 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 15:49:13.276861 (MainThread): scipy not found, skipping conversion test.
2023-06-24 15:49:13.278361 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 15:49:13.278361 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 15:49:13.279359 (MainThread): 
2023-06-24 15:49:13.279858 (MainThread): Acquiring new postgres connection "master".
2023-06-24 15:49:13.279858 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:49:13.285859 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 15:49:13.285859 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 15:49:13.340396 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 15:49:13.340396 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 15:49:13.370361 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 15:49:13.377859 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 15:49:13.377859 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 15:49:13.378860 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:49:13.378860 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 15:49:13.407348 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:49:13.407348 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 15:49:13.407348 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 15:49:13.410348 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2023-06-24 15:49:13.412376 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 15:49:13.420348 (MainThread): Using postgres connection "master".
2023-06-24 15:49:13.420348 (MainThread): On master: BEGIN
2023-06-24 15:49:13.448848 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 15:49:13.448848 (MainThread): Using postgres connection "master".
2023-06-24 15:49:13.448848 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 15:49:13.452848 (MainThread): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 15:49:13.453847 (MainThread): On master: ROLLBACK
2023-06-24 15:49:13.454347 (MainThread): Using postgres connection "master".
2023-06-24 15:49:13.454347 (MainThread): On master: BEGIN
2023-06-24 15:49:13.454347 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:49:13.454847 (MainThread): On master: COMMIT
2023-06-24 15:49:13.454847 (MainThread): Using postgres connection "master".
2023-06-24 15:49:13.454847 (MainThread): On master: COMMIT
2023-06-24 15:49:13.454847 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:49:13.455347 (MainThread): 11:49:13 | Concurrency: 1 threads (target='dev')
2023-06-24 15:49:13.455347 (MainThread): 11:49:13 | 
2023-06-24 15:49:13.456848 (Thread-1): Began running node model.my_new_project.extracted_data
2023-06-24 15:49:13.456848 (Thread-1): 11:49:13 | 1 of 2 START view model myschema.extracted_data...................... [RUN]
2023-06-24 15:49:13.457349 (Thread-1): Acquiring new postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:49:13.457349 (Thread-1): Opening a new connection, currently in state init
2023-06-24 15:49:13.457349 (Thread-1): Compiling model.my_new_project.extracted_data
2023-06-24 15:49:13.465347 (Thread-1): Writing injected SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:49:13.465848 (Thread-1): finished collecting timing info
2023-06-24 15:49:13.486847 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:49:13.486847 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_tmp" cascade
2023-06-24 15:49:13.514849 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 15:49:13.516377 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:49:13.516377 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */
drop view if exists "postgres"."myschema"."extracted_data__dbt_backup" cascade
2023-06-24 15:49:13.516877 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 15:49:13.517877 (Thread-1): Writing runtime SQL for node "model.my_new_project.extracted_data"
2023-06-24 15:49:13.518349 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:49:13.518349 (Thread-1): On model.my_new_project.extracted_data: BEGIN
2023-06-24 15:49:13.518349 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:49:13.518849 (Thread-1): Using postgres connection "model.my_new_project.extracted_data".
2023-06-24 15:49:13.518849 (Thread-1): On model.my_new_project.extracted_data: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.extracted_data"} */

  create view "postgres"."myschema"."extracted_data__dbt_tmp" as (
    -- models/extract/extracted_data.sql
SELECT *
FROM myschema.transformed_addresses
  );

2023-06-24 15:49:13.518849 (Thread-1): Postgres error: relation "myschema.transformed_addresses" does not exist
LINE 6: FROM myschema.transformed_addresses
             ^

2023-06-24 15:49:13.519350 (Thread-1): On model.my_new_project.extracted_data: ROLLBACK
2023-06-24 15:49:13.519350 (Thread-1): finished collecting timing info
2023-06-24 15:49:13.519848 (Thread-1): Database Error in model extracted_data (models\extract\extracted_data.sql)
  relation "myschema.transformed_addresses" does not exist
  LINE 6: FROM myschema.transformed_addresses
               ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.transformed_addresses" does not exist
LINE 6: FROM myschema.transformed_addresses
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model extracted_data (models\extract\extracted_data.sql)
  relation "myschema.transformed_addresses" does not exist
  LINE 6: FROM myschema.transformed_addresses
               ^
  compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:49:13.521347 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2dee71d-b4bc-4c5e-8c6a-f9047b0a7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001257F570BA8>]}
2023-06-24 15:49:13.521347 (Thread-1): 11:49:13 | 1 of 2 ERROR creating view model myschema.extracted_data............. [ERROR in 0.06s]
2023-06-24 15:49:13.522369 (Thread-1): Finished running node model.my_new_project.extracted_data
2023-06-24 15:49:13.522369 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 15:49:13.522848 (Thread-1): 11:49:13 | 2 of 2 SKIP relation myschema.transformation......................... [SKIP]
2023-06-24 15:49:13.523347 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 15:49:13.560229 (MainThread): Using postgres connection "master".
2023-06-24 15:49:13.560732 (MainThread): On master: BEGIN
2023-06-24 15:49:13.561027 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 15:49:13.561027 (MainThread): On master: COMMIT
2023-06-24 15:49:13.561027 (MainThread): Using postgres connection "master".
2023-06-24 15:49:13.561027 (MainThread): On master: COMMIT
2023-06-24 15:49:13.561027 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 15:49:13.561531 (MainThread): 11:49:13 | 
2023-06-24 15:49:13.561531 (MainThread): 11:49:13 | Finished running 2 view models in 0.28s.
2023-06-24 15:49:13.562033 (MainThread): Connection 'master' was left open.
2023-06-24 15:49:13.562033 (MainThread): On master: Close
2023-06-24 15:49:13.562033 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 15:49:13.562033 (MainThread): On list_postgres: Close
2023-06-24 15:49:13.562033 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 15:49:13.562033 (MainThread): On list_postgres_myschema: Close
2023-06-24 15:49:13.562532 (MainThread): Connection 'model.my_new_project.extracted_data' was left open.
2023-06-24 15:49:13.562532 (MainThread): On model.my_new_project.extracted_data: Close
2023-06-24 15:49:13.565562 (MainThread): 
2023-06-24 15:49:13.566033 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 15:49:13.566533 (MainThread): 
2023-06-24 15:49:13.566533 (MainThread): Database Error in model extracted_data (models\extract\extracted_data.sql)
2023-06-24 15:49:13.567033 (MainThread):   relation "myschema.transformed_addresses" does not exist
2023-06-24 15:49:13.567033 (MainThread):   LINE 6: FROM myschema.transformed_addresses
2023-06-24 15:49:13.567033 (MainThread):                ^
2023-06-24 15:49:13.567532 (MainThread):   compiled SQL at target\run\my_new_project\extract\extracted_data.sql
2023-06-24 15:49:13.567532 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2023-06-24 15:49:13.568031 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001257F4A5470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001257F4A5B38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001257F53B6A0>]}
2023-06-24 15:49:13.568031 (MainThread): Flushing usage events
2023-06-24 15:56:01.431972 (MainThread): Running with dbt=0.16.0
2023-06-24 15:56:01.469972 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:56:01.470472 (MainThread): Tracking: tracking
2023-06-24 15:56:01.470472 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC9368F98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC92279E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC9204A20>]}
2023-06-24 15:56:01.482972 (MainThread): Partial parsing not enabled
2023-06-24 15:56:01.484973 (MainThread): Parsing macros\core.sql
2023-06-24 15:56:01.488972 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:56:01.520472 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:56:01.527473 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:56:01.528472 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:56:01.528972 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:56:01.530972 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:56:01.532472 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:56:01.533473 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:56:01.534472 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:56:01.540472 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:56:01.549972 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:56:01.551973 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:56:01.556472 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:56:01.571972 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:56:01.599971 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:56:01.601472 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:56:01.614471 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:56:01.619472 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:56:01.622971 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:56:01.627972 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:56:01.629471 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:56:01.629971 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:56:01.630971 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:56:01.632471 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:56:01.645502 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:56:01.647002 (MainThread): Parsing macros\relations.sql
2023-06-24 15:56:01.648471 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:56:01.660974 (MainThread): Partial parsing not enabled
2023-06-24 15:56:01.679972 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:56:01.679972 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:56:01.719472 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DCC10D3C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DCC10D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DCC0D7048>]}
2023-06-24 15:56:01.719472 (MainThread): Flushing usage events
2023-06-24 15:56:01.942700 (MainThread): Connection 'model.my_new_project.transformation' was properly closed.
2023-06-24 15:56:01.943200 (MainThread): Encountered an error:
2023-06-24 15:56:01.943200 (MainThread): Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled
2023-06-24 15:56:01.944200 (MainThread): Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 338, in load_all
    manifest = loader.create_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 323, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 302, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 553, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 534, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\utils.py", line 338, in invalid_ref_fail_unless_test
    target_model_package)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 488, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled

2023-06-24 15:56:20.375995 (MainThread): Running with dbt=0.16.0
2023-06-24 15:56:20.413495 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:56:20.413995 (MainThread): Tracking: tracking
2023-06-24 15:56:20.414995 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FAAFA2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FAAFA080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FAB01390>]}
2023-06-24 15:56:20.426496 (MainThread): Partial parsing not enabled
2023-06-24 15:56:20.428495 (MainThread): Parsing macros\core.sql
2023-06-24 15:56:20.431995 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:56:20.463495 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:56:20.470495 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:56:20.470995 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:56:20.471995 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:56:20.473495 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:56:20.474995 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:56:20.476495 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:56:20.477495 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:56:20.482995 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:56:20.492995 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:56:20.494495 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:56:20.498995 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:56:20.514495 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:56:20.539495 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:56:20.540995 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:56:20.553495 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:56:20.558495 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:56:20.562496 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:56:20.566995 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:56:20.568495 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:56:20.569495 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:56:20.569995 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:56:20.571496 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:56:20.584495 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:56:20.585995 (MainThread): Parsing macros\relations.sql
2023-06-24 15:56:20.587496 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:56:20.599995 (MainThread): Partial parsing not enabled
2023-06-24 15:56:20.618995 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:56:20.618995 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:56:20.666995 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FACACEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FACACDD8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FAC5E780>]}
2023-06-24 15:56:20.666995 (MainThread): Flushing usage events
2023-06-24 15:56:20.883369 (MainThread): Connection 'model.my_new_project.transformation' was properly closed.
2023-06-24 15:56:20.883369 (MainThread): Encountered an error:
2023-06-24 15:56:20.883870 (MainThread): Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled
2023-06-24 15:56:20.884871 (MainThread): Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 338, in load_all
    manifest = loader.create_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 323, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 302, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 553, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 534, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\utils.py", line 338, in invalid_ref_fail_unless_test
    target_model_package)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 488, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled

2023-06-24 15:57:58.358168 (MainThread): Running with dbt=0.16.0
2023-06-24 15:57:58.394668 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:57:58.395168 (MainThread): Tracking: tracking
2023-06-24 15:57:58.395668 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E90084400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E900A79B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E9006B2B0>]}
2023-06-24 15:57:58.406668 (MainThread): Partial parsing not enabled
2023-06-24 15:57:58.409168 (MainThread): Parsing macros\core.sql
2023-06-24 15:57:58.412668 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:57:58.443669 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:57:58.450668 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:57:58.451168 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:57:58.452168 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:57:58.453668 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:57:58.455668 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:57:58.456668 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:57:58.457668 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:57:58.463168 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:57:58.473168 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:57:58.474668 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:57:58.479168 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:57:58.494668 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:57:58.519168 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:57:58.520668 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:57:58.533168 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:57:58.538169 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:57:58.542168 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:57:58.546668 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:57:58.548169 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:57:58.549168 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:57:58.549668 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:57:58.551168 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:57:58.564170 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:57:58.565668 (MainThread): Parsing macros\relations.sql
2023-06-24 15:57:58.566668 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:57:58.579668 (MainThread): Partial parsing not enabled
2023-06-24 15:57:58.598168 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:57:58.598168 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:57:58.635169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E92EFD320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E92EFD208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E92EC90B8>]}
2023-06-24 15:57:58.635668 (MainThread): Flushing usage events
2023-06-24 15:57:58.802946 (MainThread): Connection 'model.my_new_project.transformation' was properly closed.
2023-06-24 15:57:58.803435 (MainThread): Encountered an error:
2023-06-24 15:57:58.803935 (MainThread): Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled
2023-06-24 15:57:58.810935 (MainThread): Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 338, in load_all
    manifest = loader.create_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 323, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 302, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 553, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 534, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\utils.py", line 338, in invalid_ref_fail_unless_test
    target_model_package)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 488, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled

2023-06-24 15:58:04.694974 (MainThread): Running with dbt=0.16.0
2023-06-24 15:58:04.731974 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:58:04.732474 (MainThread): Tracking: tracking
2023-06-24 15:58:04.733474 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDB149470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDB149048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDB1506A0>]}
2023-06-24 15:58:04.744473 (MainThread): Partial parsing not enabled
2023-06-24 15:58:04.746974 (MainThread): Parsing macros\core.sql
2023-06-24 15:58:04.750474 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:58:04.781474 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:58:04.787974 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:58:04.788975 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:58:04.789974 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:58:04.791473 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:58:04.792974 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:58:04.794474 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:58:04.794974 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:58:04.800974 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:58:04.810474 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:58:04.811974 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:58:04.816474 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:58:04.831974 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:58:04.856473 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:58:04.857974 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:58:04.870474 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:58:04.875475 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:58:04.879474 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:58:04.883974 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:58:04.885474 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:58:04.885974 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:58:04.886974 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:58:04.888474 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:58:04.901474 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:58:04.902974 (MainThread): Parsing macros\relations.sql
2023-06-24 15:58:04.903974 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:58:04.916974 (MainThread): Partial parsing not enabled
2023-06-24 15:58:04.934973 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:58:04.935474 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:58:04.982974 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDB2D0E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDB2D0D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDB36CB00>]}
2023-06-24 15:58:04.982974 (MainThread): Flushing usage events
2023-06-24 15:58:05.153387 (MainThread): Connection 'model.my_new_project.transformation' was properly closed.
2023-06-24 15:58:05.153387 (MainThread): Encountered an error:
2023-06-24 15:58:05.153888 (MainThread): Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled
2023-06-24 15:58:05.154885 (MainThread): Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 338, in load_all
    manifest = loader.create_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 323, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 302, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 553, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 534, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\utils.py", line 338, in invalid_ref_fail_unless_test
    target_model_package)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 488, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled

2023-06-24 15:59:01.776516 (MainThread): Running with dbt=0.16.0
2023-06-24 15:59:01.814015 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 15:59:01.814516 (MainThread): Tracking: tracking
2023-06-24 15:59:01.815015 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001688005F240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001688005FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016880050F60>]}
2023-06-24 15:59:01.826515 (MainThread): Partial parsing not enabled
2023-06-24 15:59:01.829015 (MainThread): Parsing macros\core.sql
2023-06-24 15:59:01.832515 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 15:59:01.864016 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 15:59:01.870516 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 15:59:01.871516 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 15:59:01.872016 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 15:59:01.874015 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 15:59:01.875516 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 15:59:01.876515 (MainThread): Parsing macros\etc\query.sql
2023-06-24 15:59:01.877515 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 15:59:01.883516 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 15:59:01.893015 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 15:59:01.894515 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 15:59:01.899515 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 15:59:01.916015 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 15:59:01.941015 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 15:59:01.942515 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 15:59:01.955015 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 15:59:01.960015 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 15:59:01.964015 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 15:59:01.968515 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 15:59:01.970515 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 15:59:01.971016 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 15:59:01.972015 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 15:59:01.973516 (MainThread): Parsing macros\adapters.sql
2023-06-24 15:59:01.986515 (MainThread): Parsing macros\catalog.sql
2023-06-24 15:59:01.988015 (MainThread): Parsing macros\relations.sql
2023-06-24 15:59:01.989015 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 15:59:02.002516 (MainThread): Partial parsing not enabled
2023-06-24 15:59:02.021015 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 15:59:02.021015 (MainThread): Opening a new connection, currently in state init
2023-06-24 15:59:02.069515 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168801FCE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168801FCD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001688028E0B8>]}
2023-06-24 15:59:02.069515 (MainThread): Flushing usage events
2023-06-24 15:59:02.274626 (MainThread): Connection 'model.my_new_project.transformation' was properly closed.
2023-06-24 15:59:02.275125 (MainThread): Encountered an error:
2023-06-24 15:59:02.275125 (MainThread): Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled
2023-06-24 15:59:02.276654 (MainThread): Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 338, in load_all
    manifest = loader.create_manifest()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 323, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 302, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 553, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 534, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\utils.py", line 338, in invalid_ref_fail_unless_test
    target_model_package)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 488, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model transformation (models\transform\transformation.sql)
  Model 'model.my_new_project.transformation' depends on a node named 'my_new_project' which was not found or is disabled

2023-06-24 16:00:15.837808 (MainThread): Running with dbt=0.16.0
2023-06-24 16:00:15.875308 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 16:00:15.875808 (MainThread): Tracking: tracking
2023-06-24 16:00:15.876308 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3B6FE49E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3B6FCB2E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3B6FCB518>]}
2023-06-24 16:00:15.887809 (MainThread): Partial parsing not enabled
2023-06-24 16:00:15.890307 (MainThread): Parsing macros\core.sql
2023-06-24 16:00:15.893807 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 16:00:15.924808 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 16:00:15.931808 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 16:00:15.932807 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 16:00:15.933808 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 16:00:15.935307 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 16:00:15.936808 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 16:00:15.938308 (MainThread): Parsing macros\etc\query.sql
2023-06-24 16:00:15.938808 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 16:00:15.944808 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 16:00:15.954307 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 16:00:15.955807 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 16:00:15.960809 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 16:00:15.976307 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 16:00:16.001308 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 16:00:16.002808 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 16:00:16.015307 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 16:00:16.020307 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 16:00:16.024307 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 16:00:16.028809 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 16:00:16.030307 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 16:00:16.031308 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 16:00:16.032307 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 16:00:16.033308 (MainThread): Parsing macros\adapters.sql
2023-06-24 16:00:16.046308 (MainThread): Parsing macros\catalog.sql
2023-06-24 16:00:16.048307 (MainThread): Parsing macros\relations.sql
2023-06-24 16:00:16.049308 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 16:00:16.061808 (MainThread): Partial parsing not enabled
2023-06-24 16:00:16.080308 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:16.080808 (MainThread): Opening a new connection, currently in state init
2023-06-24 16:00:16.223808 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:16.224308 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:16.224308 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:16.224308 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:16.224308 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:16.224308 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:16.224308 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:16.225808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.226308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.226807 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.228808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.230309 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.230808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.231307 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.232308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.232808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.233308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.234308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.234808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.235808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.236808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.239308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.242808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.243308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.244808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.245809 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.246308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.253808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.257308 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:16.257308 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:16.259308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.274308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.275310 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.277309 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.310838 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.314844 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.315338 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.328308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.331307 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.346308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.347808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.360808 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.377308 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:16.378307 (MainThread): scipy not found, skipping conversion test.
2023-06-24 16:00:16.379308 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 16:00:16.379808 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 16:00:16.380308 (MainThread): 
2023-06-24 16:00:16.380308 (MainThread): Acquiring new postgres connection "master".
2023-06-24 16:00:16.380308 (MainThread): Opening a new connection, currently in state init
2023-06-24 16:00:16.384308 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 16:00:16.384308 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 16:00:16.440307 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 16:00:16.440307 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 16:00:16.470901 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 16:00:16.476402 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 16:00:16.476402 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 16:00:16.477432 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 16:00:16.477432 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 16:00:16.505402 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 16:00:16.505402 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 16:00:16.505402 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 16:00:16.508401 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2023-06-24 16:00:16.510430 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 16:00:16.515901 (MainThread): Using postgres connection "master".
2023-06-24 16:00:16.516401 (MainThread): On master: BEGIN
2023-06-24 16:00:16.546901 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 16:00:16.546901 (MainThread): Using postgres connection "master".
2023-06-24 16:00:16.546901 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 16:00:16.550901 (MainThread): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 16:00:16.551900 (MainThread): On master: ROLLBACK
2023-06-24 16:00:16.551900 (MainThread): Using postgres connection "master".
2023-06-24 16:00:16.551900 (MainThread): On master: BEGIN
2023-06-24 16:00:16.552401 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 16:00:16.552401 (MainThread): On master: COMMIT
2023-06-24 16:00:16.552401 (MainThread): Using postgres connection "master".
2023-06-24 16:00:16.552401 (MainThread): On master: COMMIT
2023-06-24 16:00:16.552900 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 16:00:16.552900 (MainThread): 12:00:16 | Concurrency: 1 threads (target='dev')
2023-06-24 16:00:16.552900 (MainThread): 12:00:16 | 
2023-06-24 16:00:16.554401 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 16:00:16.554901 (Thread-1): 12:00:16 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 16:00:16.554901 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:16.554901 (Thread-1): Opening a new connection, currently in state init
2023-06-24 16:00:16.554901 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 16:00:16.562900 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 16:00:16.563400 (Thread-1): finished collecting timing info
2023-06-24 16:00:16.583437 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:16.583437 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 16:00:16.612421 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 16:00:16.613953 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:16.613953 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 16:00:16.614421 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 16:00:16.614957 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 16:00:16.615852 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:16.615852 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 16:00:16.616119 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 16:00:16.616119 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:16.616119 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    WITH filtered_data AS (
    SELECT *
    FROM myschema.postgres
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data;
  );

2023-06-24 16:00:16.616623 (Thread-1): Postgres error: syntax error at or near ";"
LINE 11: FROM filtered_data;
                           ^

2023-06-24 16:00:16.616623 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 16:00:16.616623 (Thread-1): finished collecting timing info
2023-06-24 16:00:16.617153 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  syntax error at or near ";"
  LINE 11: FROM filtered_data;
                             ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 11: FROM filtered_data;
                           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  syntax error at or near ";"
  LINE 11: FROM filtered_data;
                             ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 16:00:16.618654 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24c024c6-3d52-4098-a1e7-7db15e120c56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3BAC6DC88>]}
2023-06-24 16:00:16.618654 (Thread-1): 12:00:16 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.06s]
2023-06-24 16:00:16.618654 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 16:00:16.665177 (MainThread): Using postgres connection "master".
2023-06-24 16:00:16.665686 (MainThread): On master: BEGIN
2023-06-24 16:00:16.666677 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 16:00:16.667177 (MainThread): On master: COMMIT
2023-06-24 16:00:16.667177 (MainThread): Using postgres connection "master".
2023-06-24 16:00:16.667678 (MainThread): On master: COMMIT
2023-06-24 16:00:16.668677 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 16:00:16.669677 (MainThread): 12:00:16 | 
2023-06-24 16:00:16.670178 (MainThread): 12:00:16 | Finished running 1 view model in 0.29s.
2023-06-24 16:00:16.670677 (MainThread): Connection 'master' was left open.
2023-06-24 16:00:16.670677 (MainThread): On master: Close
2023-06-24 16:00:16.671677 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 16:00:16.671677 (MainThread): On list_postgres: Close
2023-06-24 16:00:16.672689 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 16:00:16.672689 (MainThread): On list_postgres_myschema: Close
2023-06-24 16:00:16.673646 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 16:00:16.674177 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 16:00:16.679126 (MainThread): 
2023-06-24 16:00:16.679301 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 16:00:16.679301 (MainThread): 
2023-06-24 16:00:16.679301 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 16:00:16.679301 (MainThread):   syntax error at or near ";"
2023-06-24 16:00:16.679301 (MainThread):   LINE 11: FROM filtered_data;
2023-06-24 16:00:16.679625 (MainThread):                              ^
2023-06-24 16:00:16.679625 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 16:00:16.679625 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 16:00:16.679625 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3BAC2D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3B9E63898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3BAC92358>]}
2023-06-24 16:00:16.679625 (MainThread): Flushing usage events
2023-06-24 16:00:34.201816 (MainThread): Running with dbt=0.16.0
2023-06-24 16:00:34.239813 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['transform'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Me\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2023-06-24 16:00:34.240312 (MainThread): Tracking: tracking
2023-06-24 16:00:34.240812 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AB72A080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AB5D7978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AB5B49E8>]}
2023-06-24 16:00:34.252812 (MainThread): Partial parsing not enabled
2023-06-24 16:00:34.255313 (MainThread): Parsing macros\core.sql
2023-06-24 16:00:34.258813 (MainThread): Parsing macros\adapters\common.sql
2023-06-24 16:00:34.290813 (MainThread): Parsing macros\etc\datetime.sql
2023-06-24 16:00:34.297813 (MainThread): Parsing macros\etc\get_custom_alias.sql
2023-06-24 16:00:34.298812 (MainThread): Parsing macros\etc\get_custom_database.sql
2023-06-24 16:00:34.299812 (MainThread): Parsing macros\etc\get_custom_schema.sql
2023-06-24 16:00:34.301312 (MainThread): Parsing macros\etc\get_relation_comment.sql
2023-06-24 16:00:34.302813 (MainThread): Parsing macros\etc\is_incremental.sql
2023-06-24 16:00:34.304312 (MainThread): Parsing macros\etc\query.sql
2023-06-24 16:00:34.305312 (MainThread): Parsing macros\materializations\helpers.sql
2023-06-24 16:00:34.310814 (MainThread): Parsing macros\materializations\common\merge.sql
2023-06-24 16:00:34.320814 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2023-06-24 16:00:34.322314 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2023-06-24 16:00:34.326815 (MainThread): Parsing macros\materializations\seed\seed.sql
2023-06-24 16:00:34.342815 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2023-06-24 16:00:34.367815 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2023-06-24 16:00:34.369315 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2023-06-24 16:00:34.381815 (MainThread): Parsing macros\materializations\table\table.sql
2023-06-24 16:00:34.387316 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2023-06-24 16:00:34.391316 (MainThread): Parsing macros\materializations\view\view.sql
2023-06-24 16:00:34.395815 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2023-06-24 16:00:34.397315 (MainThread): Parsing macros\schema_tests\not_null.sql
2023-06-24 16:00:34.398315 (MainThread): Parsing macros\schema_tests\relationships.sql
2023-06-24 16:00:34.399315 (MainThread): Parsing macros\schema_tests\unique.sql
2023-06-24 16:00:34.400314 (MainThread): Parsing macros\adapters.sql
2023-06-24 16:00:34.414815 (MainThread): Parsing macros\catalog.sql
2023-06-24 16:00:34.417315 (MainThread): Parsing macros\relations.sql
2023-06-24 16:00:34.419313 (MainThread): Parsing macros\materializations\snapshot_merge.sql
2023-06-24 16:00:34.432812 (MainThread): Partial parsing not enabled
2023-06-24 16:00:34.452312 (MainThread): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:34.452312 (MainThread): Opening a new connection, currently in state init
2023-06-24 16:00:34.602812 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:34.602812 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:34.602812 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:34.602812 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:34.603314 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:34.603314 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:34.603314 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:34.604812 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.605312 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.605812 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.607312 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.608812 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.609312 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.610313 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.610813 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.611314 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.612313 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.612813 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.613312 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.614313 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.615312 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.617813 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.621812 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.622312 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.623813 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.624314 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.625314 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.632812 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.636312 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:34.636312 (MainThread): distutils Version classes are deprecated. Use packaging.version instead.
2023-06-24 16:00:34.637812 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.653314 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.654313 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.656313 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.691312 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.695312 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.695812 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.708814 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.711815 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.727322 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.728324 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.741813 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.758812 (MainThread): numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
2023-06-24 16:00:34.759812 (MainThread): scipy not found, skipping conversion test.
2023-06-24 16:00:34.760813 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2023-06-24 16:00:34.760813 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2023-06-24 16:00:34.761315 (MainThread): 
2023-06-24 16:00:34.761815 (MainThread): Acquiring new postgres connection "master".
2023-06-24 16:00:34.761815 (MainThread): Opening a new connection, currently in state init
2023-06-24 16:00:34.765813 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2023-06-24 16:00:34.765813 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2023-06-24 16:00:34.821812 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2023-06-24 16:00:34.821812 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2023-06-24 16:00:34.853316 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2023-06-24 16:00:34.858813 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_myschema".
2023-06-24 16:00:34.858813 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2023-06-24 16:00:34.859842 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 16:00:34.859842 (ThreadPoolExecutor-1_0): On list_postgres_myschema: BEGIN
2023-06-24 16:00:34.889814 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2023-06-24 16:00:34.889814 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_myschema".
2023-06-24 16:00:34.889814 (ThreadPoolExecutor-1_0): On list_postgres_myschema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_myschema"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'myschema'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'myschema'
  
2023-06-24 16:00:34.892815 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2023-06-24 16:00:34.894813 (ThreadPoolExecutor-1_0): On list_postgres_myschema: ROLLBACK
2023-06-24 16:00:34.900315 (MainThread): Using postgres connection "master".
2023-06-24 16:00:34.900315 (MainThread): On master: BEGIN
2023-06-24 16:00:34.928914 (MainThread): SQL status: BEGIN in 0.03 seconds
2023-06-24 16:00:34.928914 (MainThread): Using postgres connection "master".
2023-06-24 16:00:34.928914 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2023-06-24 16:00:34.932938 (MainThread): SQL status: SELECT 1 in 0.00 seconds
2023-06-24 16:00:34.933939 (MainThread): On master: ROLLBACK
2023-06-24 16:00:34.934589 (MainThread): Using postgres connection "master".
2023-06-24 16:00:34.934589 (MainThread): On master: BEGIN
2023-06-24 16:00:34.934864 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 16:00:34.934864 (MainThread): On master: COMMIT
2023-06-24 16:00:34.934864 (MainThread): Using postgres connection "master".
2023-06-24 16:00:34.934864 (MainThread): On master: COMMIT
2023-06-24 16:00:34.935370 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 16:00:34.935370 (MainThread): 12:00:34 | Concurrency: 1 threads (target='dev')
2023-06-24 16:00:34.935370 (MainThread): 12:00:34 | 
2023-06-24 16:00:34.936869 (Thread-1): Began running node model.my_new_project.transformation
2023-06-24 16:00:34.937369 (Thread-1): 12:00:34 | 1 of 1 START view model myschema.transformation...................... [RUN]
2023-06-24 16:00:34.937369 (Thread-1): Acquiring new postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:34.937369 (Thread-1): Opening a new connection, currently in state init
2023-06-24 16:00:34.937369 (Thread-1): Compiling model.my_new_project.transformation
2023-06-24 16:00:34.945367 (Thread-1): Writing injected SQL for node "model.my_new_project.transformation"
2023-06-24 16:00:34.945867 (Thread-1): finished collecting timing info
2023-06-24 16:00:34.966367 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:34.966367 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_tmp" cascade
2023-06-24 16:00:34.996418 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2023-06-24 16:00:34.997867 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:34.997867 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */
drop view if exists "postgres"."myschema"."transformation__dbt_backup" cascade
2023-06-24 16:00:34.997867 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2023-06-24 16:00:34.998868 (Thread-1): Writing runtime SQL for node "model.my_new_project.transformation"
2023-06-24 16:00:34.999868 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:34.999868 (Thread-1): On model.my_new_project.transformation: BEGIN
2023-06-24 16:00:34.999868 (Thread-1): SQL status: BEGIN in 0.00 seconds
2023-06-24 16:00:34.999868 (Thread-1): Using postgres connection "model.my_new_project.transformation".
2023-06-24 16:00:34.999868 (Thread-1): On model.my_new_project.transformation: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.transformation"} */

  create view "postgres"."myschema"."transformation__dbt_tmp" as (
    WITH filtered_data AS (
    SELECT *
    FROM myschema.postgres
    WHERE contract_type = 'Magic Eden'
        AND timestamp >= (CURRENT_TIMESTAMP - INTERVAL '2 years')
)
SELECT *
FROM filtered_data
  );

2023-06-24 16:00:35.000368 (Thread-1): Postgres error: relation "myschema.postgres" does not exist
LINE 6:     FROM myschema.postgres
                 ^

2023-06-24 16:00:35.000368 (Thread-1): On model.my_new_project.transformation: ROLLBACK
2023-06-24 16:00:35.000911 (Thread-1): finished collecting timing info
2023-06-24 16:00:35.000911 (Thread-1): Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 6:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 46, in exception_handler
    yield
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "myschema.postgres" does not exist
LINE 6:     FROM myschema.postgres
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 220, in execute
    fetch=fetch
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\users\me\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\me\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\postgres\connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model transformation (models\transform\transformation.sql)
  relation "myschema.postgres" does not exist
  LINE 6:     FROM myschema.postgres
                   ^
  compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 16:00:35.002415 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a0bfc6-be36-4657-af2e-5a8684a78da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AF284160>]}
2023-06-24 16:00:35.002916 (Thread-1): 12:00:35 | 1 of 1 ERROR creating view model myschema.transformation............. [ERROR in 0.07s]
2023-06-24 16:00:35.002916 (Thread-1): Finished running node model.my_new_project.transformation
2023-06-24 16:00:35.045102 (MainThread): Using postgres connection "master".
2023-06-24 16:00:35.045102 (MainThread): On master: BEGIN
2023-06-24 16:00:35.045102 (MainThread): SQL status: BEGIN in 0.00 seconds
2023-06-24 16:00:35.045601 (MainThread): On master: COMMIT
2023-06-24 16:00:35.045601 (MainThread): Using postgres connection "master".
2023-06-24 16:00:35.045601 (MainThread): On master: COMMIT
2023-06-24 16:00:35.045601 (MainThread): SQL status: COMMIT in 0.00 seconds
2023-06-24 16:00:35.046101 (MainThread): 12:00:35 | 
2023-06-24 16:00:35.046101 (MainThread): 12:00:35 | Finished running 1 view model in 0.28s.
2023-06-24 16:00:35.046101 (MainThread): Connection 'master' was left open.
2023-06-24 16:00:35.046101 (MainThread): On master: Close
2023-06-24 16:00:35.046101 (MainThread): Connection 'list_postgres' was left open.
2023-06-24 16:00:35.046101 (MainThread): On list_postgres: Close
2023-06-24 16:00:35.046630 (MainThread): Connection 'list_postgres_myschema' was left open.
2023-06-24 16:00:35.046630 (MainThread): On list_postgres_myschema: Close
2023-06-24 16:00:35.046630 (MainThread): Connection 'model.my_new_project.transformation' was left open.
2023-06-24 16:00:35.046630 (MainThread): On model.my_new_project.transformation: Close
2023-06-24 16:00:35.049101 (MainThread): 
2023-06-24 16:00:35.049101 (MainThread): Completed with 1 error and 0 warnings:
2023-06-24 16:00:35.049101 (MainThread): 
2023-06-24 16:00:35.049101 (MainThread): Database Error in model transformation (models\transform\transformation.sql)
2023-06-24 16:00:35.049101 (MainThread):   relation "myschema.postgres" does not exist
2023-06-24 16:00:35.049601 (MainThread):   LINE 6:     FROM myschema.postgres
2023-06-24 16:00:35.049601 (MainThread):                    ^
2023-06-24 16:00:35.049601 (MainThread):   compiled SQL at target\run\my_new_project\transform\transformation.sql
2023-06-24 16:00:35.049601 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2023-06-24 16:00:35.049601 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AF093DD8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AE436898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AF276400>]}
2023-06-24 16:00:35.049601 (MainThread): Flushing usage events
